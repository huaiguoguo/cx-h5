/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{1140:function(t,e,n){"use strict";var r=n(21),o=n(66),h=n(77),l=n(569),c=n(173),f=n(38),d=n(119).f,v=n(174).f,y=n(32).f,m=n(1141).trim,w=r.Number,S=w,T=w.prototype,x="Number"==h(n(257)(T)),M="trim"in String.prototype,C=function(t){var e=c(t,!1);if("string"==typeof e&&e.length>2){var n,r,o,h=(e=M?e.trim():m(e,3)).charCodeAt(0);if(43===h||45===h){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===h){switch(e.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+e}for(var code,l=e.slice(2),i=0,f=l.length;i<f;i++)if((code=l.charCodeAt(i))<48||code>o)return NaN;return parseInt(l,r)}}return+e};if(!w(" 0o1")||!w("0b1")||w("+0x1")){w=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof w&&(x?f((function(){T.valueOf.call(n)})):"Number"!=h(n))?l(new S(C(e)),n,w):C(e)};for(var L,P=n(29)?d(S):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;P.length>k;k++)o(S,L=P[k])&&!o(w,L)&&y(w,L,v(S,L));w.prototype=T,T.constructor=w,n(39)(r,"Number",w)}},1141:function(t,e,n){var r=n(28),o=n(76),h=n(38),l=n(1142),c="["+l+"]",f=RegExp("^"+c+c+"*"),d=RegExp(c+c+"*$"),v=function(t,e,n){var o={},c=h((function(){return!!l[t]()||"​"!="​"[t]()})),f=o[t]=c?e(y):l[t];n&&(o[n]=f),r(r.P+r.F*c,"String",o)},y=v.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(f,"")),2&e&&(t=t.replace(d,"")),t};t.exports=v},1142:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},1230:function(t,e,n){"use strict";var r,i;function o(t,i,e,n,r,u){isFinite(i)&&isFinite(n)&&isFinite(e)&&isFinite(r)&&(t.save(),s(t,u),t.beginPath(),t.moveTo(i,e),t.lineTo(n,r),t.stroke(),t.restore())}function s(t,i){var e,s=((e={})[0]=[],e[1]=[t.lineWidth,2*t.lineWidth],e[2]=[5*t.lineWidth,6*t.lineWidth],e[3]=[6*t.lineWidth,6*t.lineWidth],e[4]=[t.lineWidth,4*t.lineWidth],e)[i];t.setLineDash(s)}n.d(e,"a",(function(){return yn})),function(t){t[t.Simple=0]="Simple",t[t.WithSteps=1]="WithSteps"}(r||(r={})),function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted"}(i||(i={}));var h=function(t,i){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};function l(t,i){function e(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}var u=function(){return(u=Object.assign||function(t){for(var i,e=1,s=arguments.length;e<s;e++)for(var n in i=arguments[e])Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);return t}).apply(this,arguments)};function c(t,i){if(!t)throw new Error("Assertion failed"+(i?": "+i:""))}function f(t){if(void 0===t)throw new Error("Value is undefined");return t}function d(t){if(null===t)throw new Error("Value is null");return t}function a(t){return d(f(t))}function v(t){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];for(var s=0,n=i;s<n.length;s++){var r=n[s];for(var u in r)void 0!==r[u]&&("object"!=typeof r[u]||void 0===t[u]?t[u]=r[u]:v(t[u],r[u]))}return t}function y(t){return"number"==typeof t&&isFinite(t)}function m(t){return"number"==typeof t&&t%1==0}function w(t){return"string"==typeof t}function S(t){return!(t<=0||t>0)}function b(t){var i,e,s,n=t;if(!n||"object"!=typeof n)return n;for(e in i=Array.isArray(n)?[]:{},n)n.hasOwnProperty(e)&&(s=n[e],i[e]=s&&"object"==typeof s?b(s):s);return i}function T(t){return null!==t}function g(t){return null===t?void 0:t}var x,M,C,L,P=function(){function t(){this.t=[]}return t.prototype.setRenderers=function(t){this.t=t},t.prototype.draw=function(t,i){this.t.forEach((function(e){t.save(),e.draw(t,i),t.restore()}))},t}(),p=function(){function t(){this._data=null}return t.prototype.setData=function(t){this._data=t},t.prototype.draw=function(t){if(null!==this._data&&null!==this._data.visibleRange){var i=this._data.visibleRange,e=this._data,s=function(s){t.beginPath();for(var n=i.to-1;n>=i.from;--n){var r=e.items[n];t.moveTo(r.x,r.y),t.arc(r.x,r.y,s,0,2*Math.PI)}t.fill()};t.fillStyle=e.backColor,s(e.radius+2),t.fillStyle=e.lineColor,s(e.radius)}},t}(),k={from:0,to:1},E=function(){function t(t,i){this.i=new P,this.s=[],this.u=[],this.o=!0,this.l=t,this.v=i,this.i.setRenderers(this.s)}return t.prototype.update=function(t){var i=this,e=this.l.serieses();e.length!==this.s.length&&(this.u=e.map((function(){return{items:[{x:0,y:0,time:0,price:0}],lineColor:"",backColor:i.l.options().layout.backgroundColor,radius:0,visibleRange:null}})),this.s=this.u.map((function(t){var i=new p;return i.setData(t),i})),this.i.setRenderers(this.s)),this.o=!0},t.prototype.renderer=function(t,i,e){return this.o&&(this.m(),this.o=!1),this.i},t.prototype.m=function(){var t=this,i=this.l.serieses(),e=this.v.appliedIndex(),s=this.l.timeScale();i.forEach((function(i,n){var r=t.u[n],u=i.markerDataAtIndex(e);if(null!==u){var o=d(i.firstValue());r.lineColor=i.barColorer().barStyle(e).barColor,r.backColor=t.l.options().layout.backgroundColor,r.radius=u.radius,r.items[0].price=u.price,r.items[0].y=i.priceScale().priceToCoordinate(u.price,o.value),r.items[0].time=e,r.items[0].x=s.indexToCoordinate(e),r.visibleRange=k}else r.visibleRange=null}))},t}(),V=function(){function t(t){this.g=t}return t.prototype.draw=function(t){if(null!==this.g){var i=this.g.vertLine.visible,s=this.g.horzLine.visible;if(i||s){var e=this.g.vertLine.lineWidth%2==0?.5:0,n=this.g.horzLine.lineWidth%2==0?.5:0,u=this.g.x+1+n,r=this.g.y+e,h=this.g.w,l=this.g.h;i&&u>=0&&(t.lineWidth=this.g.vertLine.lineWidth,t.strokeStyle=this.g.vertLine.color,t.fillStyle=this.g.vertLine.color,o(t,u,0,u,l,this.g.vertLine.lineStyle)),s&&r>=0&&(t.lineWidth=this.g.horzLine.lineWidth,t.strokeStyle=this.g.horzLine.color,t.fillStyle=this.g.horzLine.color,o(t,0,r,h,r,this.g.horzLine.lineStyle))}}},t}(),R=function(){function t(t){this.o=!0,this.M={vertLine:{lineWidth:1,lineStyle:0,color:"",visible:!1},horzLine:{lineWidth:1,lineStyle:0,color:"",visible:!1},w:0,h:0,x:0,y:0},this.p=new V(this.M),this.k=t}return t.prototype.update=function(){this.o=!0},t.prototype.renderer=function(t,i){return this.o&&this.m(),this.p},t.prototype.m=function(){var t=this.k.visible(),i=d(this.k.pane()),e=i.model().options().crosshair,s=this.M;s.horzLine.visible=t&&this.k.horzLineVisible(i),s.vertLine.visible=t&&this.k.vertLineVisible(),s.horzLine.lineWidth=e.horzLine.width,s.horzLine.lineStyle=e.horzLine.style,s.horzLine.color=e.horzLine.color,s.vertLine.lineWidth=e.vertLine.width,s.vertLine.lineStyle=e.vertLine.style,s.vertLine.color=e.vertLine.color,s.w=i.width(),s.h=i.height(),s.x=this.k.appliedX(),s.y=this.k.appliedY()},t}(),D={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function _(t){return function(t,i,e){return S(i)?0:i<0?0:i>255?255:Math.round(i)}(0,t)}function A(t){return function(t,i,e){return S(i)?0:i<0?0:i>1?1:Math.round(1e4*i)/1e4}(0,t)}function z(t){var i=function(t){(t=t.toLowerCase())in D&&(t=D[t]);var i,e,s=(i=t,null!==(e=C.re.exec(i))?C.parse(e):null);if(null!==s)return s;var n=function(t){var i=M.re.exec(t);return null!==i?M.parse(i):null}(t);if(null!==n)return n;var r=function(t){var i=x.re.exec(t);return null!==i?x.parse(i):null}(t);if(null!==r)return r;var u=function(t){var i=L.re.exec(t);return null!==i?L.parse(i):null}(t);return null!==u?[u[0],u[1],u[2]]:null}(t);if(null!==i)return i;throw new Error("Passed color string "+t+" does not match any of the known color representations")}function I(t,i){if(i<0||i>255)throw new Error("invalid threshold value, valid values are [0, 255]");return function(t){return.199*t[0]+.687*t[1]+.114*t[2]}(t)>=i?"white":"black"}function O(t){return"black"===I(z(t),160)?"white":"black"}!function(t){t.re=/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/,t.parse=function(t){return[_(parseInt(t[1]+t[1],16)),_(parseInt(t[2]+t[2],16)),_(parseInt(t[3]+t[3],16))]}}(x||(x={})),function(t){t.re=/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,t.parse=function(t){return[_(parseInt(t[1],16)),_(parseInt(t[2],16)),_(parseInt(t[3],16))]}}(M||(M={})),function(t){t.re=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,t.parse=function(t){return[_(parseInt(t[1],10)),_(parseInt(t[2],10)),_(parseInt(t[3],10))]}}(C||(C={})),function(t){t.re=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/,t.parse=function(t){return[_(parseInt(t[1],10)),_(parseInt(t[2],10)),_(parseInt(t[3],10)),A(parseFloat(t[4]))]}}(L||(L={}));var q,N=function(){function t(t,i){this.setData(t,i)}return t.prototype.setData=function(t,i){this.g=t,this.N=i},t.prototype.draw=function(t,i,e,s,n){if(this.g.visible){var r=i.fontSize;t.font=i.font;var u=this.g.tickVisible?i.tickLength:0,o=this.g.borderVisible?i.borderSize:0,h=i.paddingTop,l=i.paddingBottom,a=i.paddingInner,c=i.paddingOuter,f=this.g.text,d=Math.ceil(e.measureText(t,f)),v=i.baselineOffset,y=i.fontSize+h+l,b=o+d+a+c+u,m=this.N.coordinate;this.N.fixedCoordinate&&(m=this.N.fixedCoordinate);var g,w,p=m-Math.floor(r/2)-h-.5,S=p+y,T="right"===n,x=T?s-o-.5:.5,M=x;t.fillStyle=function(t){return function(t){return 0===t.indexOf("#")}(t)?t:(1,"rgba("+(i=[(e=z(t))[0],e[1],e[2],A(1)])[0]+", "+i[1]+", "+i[2]+", "+i[3]+")");var i,e}(this.N.background),t.lineWidth=1,t.lineCap="butt",f&&(T?(g=x-u,w=(M=x-b)+c):(M=x+b,g=x+u,w=x+o+u+a),t.beginPath(),t.moveTo(x,p),t.lineTo(M,p),t.lineTo(M,S),t.lineTo(x,S),t.fill(),this.g.tickVisible&&(t.beginPath(),t.strokeStyle=this.N.color,t.moveTo(x,m),t.lineTo(g,m),t.stroke()),t.textAlign="left",t.fillStyle=this.N.color,t.fillText(f,w,S-l-v))}},t.prototype.height=function(t,i){return this.g.visible?t.fontSize+t.paddingTop+t.paddingBottom:0},t}(),F=function(){function t(t){this.S={coordinate:0,color:"#FFF",background:"#000"},this.C={text:"",visible:!1,tickVisible:!0,borderVisible:!0,lineStyle:1},this.D={text:"",visible:!1,tickVisible:!1,borderVisible:!1,lineStyle:1},this.o=!0,this.O=new(t||N)(this.C,this.S),this.A=new(t||N)(this.D,this.S)}return t.prototype.text=function(){return this.C.text},t.prototype.background=function(){return this.S.background},t.prototype.color=function(){return O(this.background())},t.prototype.coordinate=function(){return this.T(),this.S.coordinate},t.prototype.floatCoordinate=function(){return this.T(),this.S.floatCoordinate||this.S.coordinate},t.prototype.update=function(){this.o=!0},t.prototype.height=function(t,i){return void 0===i&&(i=!1),Math.max(this.O.height(t,i),this.A.height(t,i))},t.prototype.getFixedCoordinate=function(){return this.S.fixedCoordinate||0},t.prototype.setFixedCoordinate=function(t){this.S.fixedCoordinate=t},t.prototype.isVisible=function(){return this.T(),this.C.visible||this.D.visible},t.prototype.isAxisLabelVisible=function(){return this.T(),this.C.visible},t.prototype.isPaneLabelVisible=function(){return this.T(),this.D.visible},t.prototype.renderer=function(){return this.T(),this.O.setData(this.C,this.S),this.A.setData(this.D,this.S),this.O},t.prototype.paneRenderer=function(){return this.T(),this.O.setData(this.C,this.S),this.A.setData(this.D,this.S),this.A},t.prototype.T=function(){this.o&&(this._updateRendererData(this.C,this.D,this.S),this.o=!1)},t}(),B=function(t){function i(i,e,s){var n=t.call(this)||this;return n.k=i,n.L=e,n.B=s,n}return l(i,t),i.prototype._updateRendererData=function(t,i,e){t.visible=!1;var s=this.k.options().horzLine;if(s.labelVisible){var n=this.L.firstValue();if(this.k.visible()&&!this.L.isEmpty()&&null!==n){e.background=s.labelBackgroundColor,e.color=O(s.labelBackgroundColor);var r=this.B(this.L);e.coordinate=r.coordinate,t.text=this.L.formatPrice(r.price,n),t.visible=!0}}},i}(F),j=/[1-9]/g,$=function(){function t(){this.g=null}return t.prototype.setData=function(t){this.g=t},t.prototype.draw=function(t,i){if(null!==this.g&&!1!==this.g.visible&&0!==this.g.text.length){t.font=i.font;var e=Math.round(i.widthCache.measureText(t,this.g.text,j));if(!(e<=0)){var s=i.paddingHorizontal,n=e+2*s,r=n/2,u=this.g.width,o=this.g.coordinate,h=Math.floor(o-r)+.5;h<0?(o+=Math.abs(0-h),h=Math.floor(o-r)+.5):h+n>u&&(o-=Math.abs(u-(h+n)),h=Math.floor(o-r)+.5);var l=h+n,a=-.5+i.borderSize+i.paddingTop+i.fontSize+i.paddingBottom;t.fillStyle=this.g.background,t.lineWidth=1,function(t,i,e,s,n,r){t.beginPath(),t.moveTo(i+1,e),t.lineTo(i+s-1,e),t.arcTo(i+s,e,i+s,.5,1),t.lineTo(i+s,e+n-1),t.arcTo(i+s,e+n,i+s-1,e+n,1),t.lineTo(i+1,e+n),t.arcTo(i,e+n,i,e+n-1,1),t.lineTo(i,.5),t.arcTo(i,e,i+1,e,1)}(t,h,-.5,l-h,a- -.5),t.fill();var c=Math.round(this.g.coordinate+1),f=-.5+i.borderSize+i.tickLength;t.strokeStyle=this.g.color,t.beginPath(),t.moveTo(c,-.5),t.lineTo(c,f),t.stroke();var d=a-i.baselineOffset-i.paddingBottom;t.textAlign="left",t.fillStyle=this.g.color,t.fillText(this.g.text,h+s,d)}}},t}(),U=function(t){function i(i,e,s){var n=t.call(this)||this;return n.o=!0,n.p=new $,n.M={visible:!1,background:"#4c525e",color:"white",text:"",width:0,coordinate:NaN},n.v=i,n.V=e,n.B=s,n}return l(i,t),i.prototype.update=function(){this.o=!0},i.prototype.renderer=function(){return this.o&&(this.m(),this.o=!1),this.p.setData(this.M),this.p},i.prototype.m=function(){var t=this.M;t.visible=!1;var i=this.v.options().vertLine;if(i.labelVisible){var e=this.V.timeScale();if(!e.isEmpty()){var s=e.indexToUserTime(this.v.appliedIndex());t.width=e.width();var n=this.B();n.time&&(t.coordinate=n.coordinate,t.text=e.formatDateTime(d(s)),t.visible=!0,t.background=i.labelBackgroundColor,t.color=O(i.labelBackgroundColor))}}},i}(function(){function t(){this._text="",this._background="#585858",this._coordinate=0}return t.prototype.text=function(){return this._text},t.prototype.background=function(){return this._background},t.prototype.color=function(){return"black"===I(z(this._background),150)?"white":"black"},t.prototype.coordinate=function(){return this._coordinate},t}()),W=function(){function t(){this._priceScale=null,this.F=0}return t.prototype.zorder=function(){return this.F},t.prototype.setZorder=function(t){this.F=t},t.prototype.priceScale=function(){return this._priceScale},t.prototype.setPriceScale=function(t){this._priceScale=t},t.prototype.priceAxisViews=function(t,i){return[]},t.prototype.paneViews=function(t){return[]},t.prototype.timeAxisViews=function(){return[]},t}();!function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet"}(q||(q={}));var X=function(t){function i(i,e){var n,r,s=t.call(this)||this;s.j=null,s.I=NaN,s.P=0,s.W=!0,s.R=new Map,s.q=!1,s.U=NaN,s.H=NaN,s.Y=NaN,s.K=NaN,s.V=i,s.$=e,s.X=new E(i,s),s._=(n=function(){return s.I},r=function(){return s.H},function(t){var i=r(),e=n();if(t===d(s.j).defaultPriceScale())return{price:e,coordinate:i};var u=d(t.firstValue());return{price:t.coordinateToPrice(i,u),coordinate:i}});var u=function(){return{time:s.V.timeScale().indexToUserTime(s.P),coordinate:s.appliedX()}};return s.J=new U(s,i,u),s.Z=new R(s),s}return l(i,t),i.prototype.index=function(){return this.P},i.prototype.options=function(){return this.$},i.prototype.saveOriginCoord=function(t,i){this.Y=t,this.K=i},i.prototype.clearOriginCoord=function(){this.Y=NaN,this.K=NaN},i.prototype.originCoordX=function(){return this.Y},i.prototype.originCoordY=function(){return this.K},i.prototype.setPosition=function(t,i,e){this.q||(this.q=!0),this.W=!0,this.G(t,i,e)},i.prototype.appliedIndex=function(){return this.P},i.prototype.appliedX=function(){return this.U},i.prototype.appliedY=function(){return this.H},i.prototype.visible=function(){return this.W},i.prototype.clearPosition=function(){this.W=!1,this.tt(),this.I=NaN,this.U=NaN,this.H=NaN,this.j=null,this.clearOriginCoord()},i.prototype.paneViews=function(t){return null!==this.j?[this.Z,this.X]:[]},i.prototype.horzLineVisible=function(t){return t===this.j&&this.$.horzLine.visible},i.prototype.vertLineVisible=function(){return this.$.vertLine.visible},i.prototype.priceAxisViews=function(t,i){this.W&&this.j===t||this.R.clear();var e=[];return this.j===t&&e.push(this.it(this.R,i,this._)),e},i.prototype.timeAxisViews=function(){return this.W?[this.J]:[]},i.prototype.pane=function(){return this.j},i.prototype.updateAllViews=function(){this.R.forEach((function(t){return t.update()})),this.J.update(),this.X.update()},i.prototype.nt=function(t){return t&&!t.defaultPriceScale().isEmpty()?t.defaultPriceScale():null},i.prototype.G=function(t,i,e){this.st(t,i,e)&&this.updateAllViews()},i.prototype.st=function(t,i,e){var s=this.U,n=this.H,r=this.I,u=this.P,o=this.j,h=this.nt(e);this.P=t,this.U=isNaN(t)?NaN:this.V.timeScale().indexToCoordinate(t);var l=null!==h?h.firstValue():null;return null!==h&&null!==l?(this.j=e,this.I=i,this.H=h.priceToCoordinate(i,l)):(this.j=null,this.I=NaN,this.H=NaN),s!==this.U||n!==this.H||u!==this.P||r!==this.I||o!==this.j},i.prototype.tt=function(){var t=this.V.serieses().map((function(t){return t.bars().lastIndex()})).filter(T),i=0===t.length?null:Math.max.apply(Math,t);this.P=null!==i?i:NaN},i.prototype.it=function(t,i,e){var s=t.get(i);return void 0===s&&(s=new B(this,i,e),t.set(i,s)),s},i}(W);function H(t,i){if(!y(t))return"n/a";if(!m(i))throw new TypeError("invalid length");if(i<0||i>16)throw new TypeError("invalid length");return 0===i?t.toString():("0000000000000000"+t.toString()).slice(-i)}var Y,K=function(){function t(t,i,e,s){if(i||(i=1),y(t)&&m(t)||(t=100),t<0)throw new TypeError("invalid base");this.L=t,this.ht=i,this.rt=s,e&&void 0!==s&&s>0&&2!==s&&4!==s&&8!==s||(this.ut=e,this.et())}return t.prototype.format=function(t){var i=t<0?"−":"";return t=Math.abs(t),this.ut?i+this.ot(t):i+this.ft(t)},t.prototype.et=function(){if(this._fractionalLength=0,this.L>0&&this.ht>0){var t=this.L;for(this.ut&&this.rt&&(t/=this.rt);t>1;)t/=10,this._fractionalLength++}},t.prototype.ft=function(t){var i;i=this.ut?Math.pow(10,this._fractionalLength||0):this.L/this.ht;var e=Math.floor(t),s="",n=void 0!==this._fractionalLength?this._fractionalLength:NaN;if(i>1){var r=+(Math.round(t*i)-e*i).toFixed(this._fractionalLength);r>=i&&(r-=i,e+=1),s="."+H(+r.toFixed(this._fractionalLength)*this.ht,n)}else e=Math.round(e*i)/i,n>0&&(s="."+H(0,n));return e.toFixed(0)+s},t.prototype.ot=function(t){var i=this.L/this.ht,e=Math.floor(t),s=Math.round(t*i)-e*i;if(s===i&&(s=0,e+=1),!this._fractionalLength)throw new Error("_fractionalLength is not calculated");var n="";if(this.rt){var r=s%this.rt;n=H(s=(s-r)/this.rt,this._fractionalLength)+"'"+(2===this.rt?["0","5"][r]:8===this.rt?["0","1","2","3","4","5","6","7"][r]:["0","2","5","7"][r])}else n=H(s*this.ht,this._fractionalLength);return e.toString()+"'"+n},t}(),J=function(t){function i(i){return void 0===i&&(i=100),t.call(this,i)||this}return l(i,t),i.prototype.format=function(i){return t.prototype.format.call(this,i)+"%"},i}(K),Q=function(){function t(){this.at=[]}return t.prototype.subscribe=function(t,i,e){var s={callback:t,linkedObject:i,singleshot:!0===e};this.at.push(s)},t.prototype.unsubscribe=function(t){var i=this.at.findIndex((function(i){return t===i.callback}));i>-1&&this.at.splice(i,1)},t.prototype.unsubscribeAll=function(t){this.at=this.at.filter((function(i){return i.linkedObject===t}))},t.prototype.fire=function(t,i){var e=this.at.slice();this.at=this.at.filter((function(t){return!t.singleshot})),e.forEach((function(e){return e.callback(t,i)}))},t.prototype.hasListeners=function(){return this.at.length>0},t.prototype.destroy=function(){this.at=[]},t}(),G=function(t){function i(i){var e=t.call(this)||this;return e.V=i,e}return l(i,t),i.prototype.model=function(){return this.V},i.prototype.minMove=function(){return 0},i.prototype.autoscaleInfo=function(t,i){return null},i}(W),Z=function(){function t(t,i){this.ct=t,this.lt=i}return t.prototype.equals=function(t){return null!==t&&this.ct===t.ct&&this.lt===t.lt},t.prototype.clone=function(){return new t(this.ct,this.lt)},t.prototype.minValue=function(){return this.ct},t.prototype.setMinValue=function(t){this.ct=t},t.prototype.maxValue=function(){return this.lt},t.prototype.setMaxValue=function(t){this.lt=t},t.prototype.length=function(){return this.lt-this.ct},t.prototype.isEmpty=function(){return this.lt===this.ct||Number.isNaN(this.lt)||Number.isNaN(this.ct)},t.prototype.merge=function(i){return null===i?this:new t(Math.min(this.minValue(),i.minValue()),Math.max(this.maxValue(),i.maxValue()))},t.prototype.apply=function(t,i){this.ct=Math.min(this.ct,t),this.lt=Math.max(this.lt,i)},t.prototype.set=function(t,i){this.ct=t,this.lt=i},t.prototype.scaleAroundCenter=function(t){if(y(t)&&0!=this.lt-this.ct){var i=.5*(this.lt+this.ct),e=this.lt-i,s=this.ct-i;e*=t,s*=t,this.lt=i+e,this.ct=i+s}},t.prototype.shift=function(t){y(t)&&(this.lt+=t,this.ct+=t)},t.prototype.containsStrictly=function(t){return t.minValue()>this.ct&&t.maxValue()<this.lt},t}();function tt(t,i,e){return Math.min(Math.max(t,i),e)}function it(t,i,e){return i-t<=e}function et(t){return t<=0?NaN:Math.log(t)/Math.log(10)}function nt(t,i){var e=100*(t-i)/i;return i<0?-e:e}function rt(t,i){var e=nt(t.minValue(),i),s=nt(t.maxValue(),i);return new Z(e,s)}function st(t,i){var e=100*(t-i)/i+100;return i<0?-e:e}function ot(t,i){var e=st(t.minValue(),i),s=st(t.maxValue(),i);return new Z(e,s)}function ht(t){var i=Math.abs(t);if(i<1e-8)return 0;var e=et(i+1e-4)+4;return t<0?-e:e}function at(t){var i=Math.abs(t);if(i<1e-8)return 0;var e=Math.pow(10,i-4)-1e-4;return t<0?-e:e}function lt(t){if(null===t)return null;var i=ht(t.minValue()),e=ht(t.maxValue());return new Z(i,e)}!function(t){t[t.LogicalOffset=4]="LogicalOffset",t[t.CoordOffset=1e-4]="CoordOffset"}(Y||(Y={}));var ut=function(){function t(t,i){if(this.vt=t,this.dt=i,function(t){if(t<0)return!1;for(var i=t;i>1;i/=10)if(i%10!=0)return!1;return!0}(this.vt))this.wt=[2,2.5,2];else{this.wt=[];for(var e=this.vt;1!==e;){if(e%2==0)this.wt.push(2),e/=2;else{if(e%5!=0)throw new Error("unexpected base");this.wt.push(2),this.wt.push(2.5),e/=5}if(this.wt.length>100)throw new Error("something wrong with base")}}}return t.prototype.tickSpan=function(t,i,e){for(var s,u=0===this.vt?0:1/this.vt,n=Math.pow(10,Math.max(0,Math.ceil(et(t-i)))),r=0,o=this.dt[0];;){var a=it(n,u,1e-9)&&n>u+1e-9,h=it(n,e*o,1e-9),l=it(n,1,1e-9);if(!(a&&h&&l))break;n/=o,o=this.dt[++r%this.dt.length]}if(n<=u+1e-9&&(n=u),n=Math.max(1,n),this.wt.length>0&&(s=n,1,1e-9,Math.abs(s-1)<1e-9))for(r=0,o=this.wt[0];it(n,e*o,1e-9)&&n>u+1e-9;)n/=o,o=this.wt[++r%this.wt.length];return n},t}(),ct=function(){function t(t,i,e,s){this.bt=[],this.L=t,this.vt=i,this.gt=e,this.Mt=s}return t.prototype.setBase=function(t){if(t<0)throw new Error("base < 0");this.vt=t},t.prototype.tickSpan=function(t,i){if(t<i)throw new Error("high < low");var e=this.L.height(),s=(t-i)*this.pt()/e,n=new ut(this.vt,[2,2.5,2]),r=new ut(this.vt,[2,2,2.5]),u=new ut(this.vt,[2.5,2,2]),o=[];return o.push(n.tickSpan(t,i,s)),o.push(r.tickSpan(t,i,s)),o.push(u.tickSpan(t,i,s)),function(t){if(t.length<1)throw Error("array is empty");for(var i=t[0],e=1;e<t.length;++e)t[e]<i&&(i=t[e]);return i}(o)},t.prototype.rebuildTickMarks=function(){var t=this.L,i=t.firstValue();if(null!==i){var e=t.height(),s=this.gt(e-1,i),n=this.gt(0,i),r=this.L.options().entireTextOnly?this.yt()/2:0,u=r,o=e-1-r,h=Math.max(s,n),l=Math.min(s,n);if(h!==l){for(var a=this.tickSpan(h,l),c=h%a,f=h>=l?1:-1,d=null,v=0,y=h-(c+=c<0?a:0);y>l;y-=a){var b=this.Mt(y,i,!0);null!==d&&Math.abs(b-d)<this.pt()||b<u||b>o||(v<this.bt.length?(this.bt[v].coord=Math.round(b),this.bt[v].label=t.formatLogical(y)):this.bt.push({coord:Math.round(b),label:t.formatLogical(y)}),v++,d=b,t.isLog()&&(a=this.tickSpan(y*f,l)))}this.bt.length=v}else this.bt=[]}else this.bt=[]},t.prototype.marks=function(){return this.bt},t.prototype.yt=function(){return this.L.fontSize()},t.prototype.pt=function(){return Math.ceil(2.5*this.yt())},t}(),pt=function(){function t(t){this.kt=t}return t.prototype.format=function(t){var i="";return t<0&&(i="-",t=-t),t<995?i+this.Nt(t):t<999995?i+this.Nt(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),i+this.Nt(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),i+this.Nt(t/1e9)+"B")},t.prototype.Nt=function(t){var i=Math.pow(10,this.kt);return((t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.kt).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,(function(t,i){return i}))},t}();function dt(t,i,e,s){if(0!==i.length){var n=i[s.from].x,r=i[s.from].y;t.moveTo(n,r);for(var u=s.from+1;u<s.to;++u){var o=i[u];if(1===e){var h=i[u-1].x,l=o.x;t.lineTo(h,l)}t.lineTo(o.x,o.y)}}}var ft=function(){function t(){this._data=null}return t.prototype.setData=function(t){this._data=t},t.prototype.draw=function(t){if(null!==this._data&&0!==this._data.items.length&&null!==this._data.visibleRange){t.save(),t.lineCap="square",t.strokeStyle=this._data.lineColor,t.lineWidth=this._data.lineWidth,s(t,this._data.lineStyle),t.lineWidth=1,t.beginPath(),t.moveTo(this._data.items[this._data.visibleRange.from].x,this._data.bottom),t.lineTo(this._data.items[this._data.visibleRange.from].x,this._data.items[this._data.visibleRange.from].y),dt(t,this._data.items,this._data.lineType,this._data.visibleRange),t.lineTo(this._data.items[this._data.visibleRange.to-1].x,this._data.bottom),t.lineTo(this._data.items[this._data.visibleRange.from].x,this._data.bottom),t.closePath();var i=t.createLinearGradient(0,0,0,this._data.bottom);i.addColorStop(0,this._data.topColor),i.addColorStop(1,this._data.bottomColor),t.fillStyle=i,t.fill(),t.restore()}},t}(),vt=function(){function t(){this._data=null}return t.prototype.setData=function(t){this._data=t},t.prototype.draw=function(t){null!==this._data&&0!==this._data.items.length&&null!==this._data.visibleRange&&(t.lineCap="square",t.lineWidth=this._data.lineWidth,s(t,this._data.lineStyle),t.strokeStyle=this._data.lineColor,t.lineJoin="miter",t.beginPath(),dt(t,this._data.items,this._data.lineType,this._data.visibleRange),t.stroke())},t}();function yt(t,i,e,s,n){void 0===s&&(s=0),void 0===n&&(n=t.length);for(var r=n-s;0<r;){var u=r>>1,o=s+u;e(t[o],i)?(s=o+1,r-=u+1):r=u}return s}function mt(t,i,e,s,n){void 0===s&&(s=0),void 0===n&&(n=t.length);for(var r=n-s;0<r;){var u=r>>1,o=s+u;e(i,t[o])?r=u:(s=o+1,r-=u+1)}return s}function gt(t,i){return t.time<i}function bt(t,i){return t<i.time}function wt(t,i,e){var s=i.firstBar(),n=i.lastBar(),r=yt(t,s,gt),u=mt(t,n,bt);if(!e)return{from:r,to:u};var o=r,h=u;return r>0&&r<t.length&&t[r].time>=s&&(o=r-1),u>0&&u<t.length&&t[u-1].time<=n&&(h=u+1),{from:o,to:h}}var St=function(){function t(t,i,e){this._invalidated=!0,this._dataInvalidated=!0,this._items=[],this._itemsVisibleRange=null,this._series=t,this._model=i,this.St=e}return t.prototype.update=function(t){this._invalidated=!0,"data"===t&&(this._dataInvalidated=!0)},t.prototype._makeValid=function(){this._dataInvalidated&&(this._fillRawPoints(),this._dataInvalidated=!1),this._invalidated&&(this._updatePoints(),this._invalidated=!1)},t.prototype._clearVisibleRange=function(){this._itemsVisibleRange=null},t.prototype._updatePoints=function(){var t=this._series.priceScale(),i=this._model.timeScale();if(this._clearVisibleRange(),!i.isEmpty()&&!t.isEmpty()){var e=i.visibleBars();if(null!==e&&0!==this._series.data().bars().size()){var s=this._series.firstValue();null!==s&&(this._itemsVisibleRange=wt(this._items,e,this.St),this._convertToCoordinates(t,i,s.value))}}},t}(),Tt=function(t){function i(i,e){return t.call(this,i,e,!0)||this}return l(i,t),i.prototype._convertToCoordinates=function(t,i,e){i.indexesToCoordinates(this._items,g(this._itemsVisibleRange)),t.pointsArrayToCoordinates(this._items,e,g(this._itemsVisibleRange))},i.prototype._createRawItemBase=function(t,i){return{time:t,price:i,x:NaN,y:NaN}},i.prototype._fillRawPoints=function(){var t=this,i=this._series.barFunction(),e=[],s=this._series.barColorer();this._series.bars().each((function(n,r){var u=i(r.value),o=t._createRawItem(n,u,s);return e.push(o),!1})),this._items=e},i}(St),xt=function(t){function i(i,e){var s=t.call(this,i,e)||this;return s.p=new P,s.xt=new ft,s.Ct=new vt,s.p.setRenderers([s.xt,s.Ct]),s}return l(i,t),i.prototype.renderer=function(t,i){this._makeValid();var e=this._series.options(),s={lineType:0,items:this._items,lineColor:e.lineColor,lineStyle:e.lineStyle,lineWidth:e.lineWidth,topColor:e.topColor,bottomColor:e.bottomColor,bottom:t,visibleRange:this._itemsVisibleRange};return this.xt.setData(s),this.Ct.setData(s),this.p},i.prototype._createRawItem=function(t,i){return this._createRawItemBase(t,i)},i}(Tt);function Mt(t){return.3*t}var Ct,Lt=function(){function t(){this.g=null,this.Dt=0,this.Et=0}return t.prototype.setData=function(t){this.g=t,this.Dt=Mt(t.barSpacing),this.Et=t.thinBars?1:Math.max(1,Math.round(this.Dt))},t.prototype.draw=function(t){if(null!==this.g&&0!==this.g.bars.length&&null!==this.g.visibleRange){t.save(),t.translate(.5,.5);for(var i=this.g.thinBars?1:Math.round(this.Dt),e=this.g.thinBars?1:i/2,s=null,n=this.g.visibleRange.from;n<this.g.visibleRange.to;++n){var r=this.g.bars[n];s!==r.color&&(t.fillStyle=r.color,s=r.color),t.fillRect(Math.round(r.x-this.Et/2),Math.round(r.highY-e),Math.round(this.Et),Math.round(r.lowY-r.highY+i)),this.Et<this.g.barSpacing-1&&(this.g.openVisible&&t.fillRect(Math.round(r.x-1.5*this.Dt),Math.floor(r.openY-e),Math.round(1.5*this.Dt),i),t.fillRect(Math.round(r.x),Math.floor(r.closeY-e),Math.round(1.5*this.Dt),i))}t.restore()}},t}(),Pt=function(t){function i(i,e){return t.call(this,i,e,!1)||this}return l(i,t),i.prototype._convertToCoordinates=function(t,i,e){i.indexesToCoordinates(this._items,g(this._itemsVisibleRange)),t.barPricesToCoordinates(this._items,e,g(this._itemsVisibleRange))},i.prototype._createDefaultItem=function(t,i,e){return{time:t,open:i.value[0],high:i.value[1],low:i.value[2],close:i.value[3],x:NaN,openY:NaN,highY:NaN,lowY:NaN,closeY:NaN}},i.prototype._fillRawPoints=function(){var t=this,i=[],e=this._series.barColorer();this._series.bars().each((function(s,n){var r=t._createRawItem(s,n,e);return i.push(r),!1})),this._items=i},i}(St),kt=function(t){function i(i,e){var s=t.call(this,i,e)||this;return s.p=new Lt,s}return l(i,t),i.prototype.renderer=function(t,i){this._makeValid();var e=this._series.options(),s={bars:this._items,barSpacing:this._model.timeScale().barSpacing(),openVisible:e.openVisible,thinBars:e.thinBars,visibleRange:this._itemsVisibleRange};return this.p.setData(s),this.p},i.prototype._createRawItem=function(t,i,e){return u({},this._createDefaultItem(t,i,e),{color:e.barStyle(t).barColor})},i}(Pt);!function(t){t[t.BarBorderWidth=1]="BarBorderWidth"}(Ct||(Ct={}));var Et,Vt=function(){function t(){this.g=null,this.Dt=0}return t.prototype.setData=function(t){this.g=t,this.Dt=Mt(t.barSpacing)},t.prototype.draw=function(t){if(null!==this.g&&0!==this.g.bars.length&&null!==this.g.visibleRange)if(t.lineCap="square",this.g.barSpacing<1)this.Ot(t);else{var i=this.g.bars;t.translate(-.5,-.5),t.lineWidth=1,this.g.wickVisible&&this.At(t,i,this.g.visibleRange),this.g.borderVisible&&this.Tt(t,i,this.g.visibleRange),this.Lt(t,i,this.g.visibleRange)}},t.prototype.At=function(t,i,e){for(var s="",n=e.from;n<e.to;n++){var r=i[n];r.wickColor!==s&&(t.fillStyle=r.wickColor,s=r.wickColor),t.fillRect(r.x,r.highY,1,r.lowY-r.highY)}},t.prototype.Tt=function(t,i,e){for(var s="",n=e.from;n<e.to;n++){var r=i[n];r.borderColor!==s&&(t.fillStyle=r.borderColor,s=r.borderColor);var u=Math.round(r.x-this.Dt),o=Math.round(r.x+this.Dt),h=Math.min(r.openY,r.closeY),l=Math.max(r.openY,r.closeY);t.fillRect(u,h,o-u+1,l-h+1)}},t.prototype.Lt=function(t,i,e){if(null!==this.g)for(var s="",n=e.from;n<e.to;n++){var r=i[n],u=Math.min(r.openY,r.closeY),o=Math.max(r.openY,r.closeY),h=Math.round(r.x-this.Dt),l=Math.round(r.x+this.Dt);if(this.g.borderVisible&&(h+=1,u+=1,l-=1,o-=1),!(u>o)){if(r.color!==s){var a=r.color;t.fillStyle=a,s=a}t.fillRect(h,u,l-h+1,o-u+1)}}},t.prototype.Ot=function(t){if(null!==this.g&&null!==this.g.visibleRange){if(t.lineWidth=1,this.g.wickVisible){t.strokeStyle=this.g.wickColor,t.beginPath();for(var i=this.g.visibleRange.from;i<this.g.visibleRange.to;i++){var e=this.g.bars[i];t.moveTo(e.x,e.lowY),t.lineTo(e.x,e.highY)}t.stroke()}var s="",n=!1;for(t.beginPath(),i=this.g.visibleRange.from;i<this.g.visibleRange.to;i++)s!==(e=this.g.bars[i]).color&&(n&&(t.stroke(),t.beginPath(),n=!1),t.strokeStyle=e.color,s=e.color),t.moveTo(e.x,e.openY),t.lineTo(e.x,e.closeY),n=!0;n&&t.stroke()}},t}(),Rt=function(t){function i(i,e){var s=t.call(this,i,e)||this;return s.p=new Vt,s}return l(i,t),i.prototype.renderer=function(t,i){this._makeValid();var e=this._series.options(),s={bars:this._items,barSpacing:this._model.timeScale().barSpacing(),wickColor:e.wickColor,wickVisible:e.wickVisible,borderVisible:e.borderVisible,visibleRange:this._itemsVisibleRange};return this.p.setData(s),this.p},i.prototype._createRawItem=function(t,i,e){var s=e.barStyle(t);return u({},this._createDefaultItem(t,i,e),{color:s.barColor,wickColor:s.barWickColor,borderColor:s.barBorderColor})},i}(Pt),Dt=function(){function t(){this.g=null}return t.prototype.setData=function(t){this.g=t},t.prototype.draw=function(t){if(null!==this.g&&0!==this.g.items.length&&null!==this.g.visibleRange){var i=this.g.histogramBase;t.translate(.5,.5),t.fillStyle=this.g.color,t.lineWidth=1,t.beginPath();for(var e=this.g.visibleRange.from;e<this.g.visibleRange.to;e++){var s=this.g.items[e],n=s.y,r=s.left,u=s.right;t.rect(r,n,u-r,i-n)}t.fill()}},t}(),_t=function(t){function i(i,e){var s=t.call(this,i,e,!1)||this;return s.i=new P,s.Bt=[],s.zt=[],s.Vt=new Int32Array(0),s.Ft=new Int32Array(0),s}return l(i,t),i.prototype.renderer=function(t,i){return this._makeValid(),this.i},i.prototype._fillRawPoints=function(){var t=this,i=this._model.timeScale().barSpacing(),e=this._series.palette();this.zt.length=e.size(),this.Bt.length=e.size();var s=new Int32Array(e.size()+1),n=this._series.options(),r=this._series.barFunction();this.Vt=new Int32Array(this._series.bars().size());var u=0;this._items.length=this._series.bars().size();var o=0,h=this._series.options().color;this._series.bars().each((function(l,a){var c=r(a.value),f=a.value[4],d={time:l,price:c,x:NaN,y:NaN},v=null!=f?e.colorByIndex(f):h,y=null==f?0:f+1,b=t.Bt[y]||function(t,i,e){return{items:[],barSpacing:t,lineWidth:i,histogramBase:NaN,color:e,visibleRange:null}}(i,n.lineWidth,v),m=s[y]++;return m<b.items.length?b.items[m]=d:b.items.push(d),t._items[o++]={time:l,x:0},t.Bt[y]=b,t.Vt[u++]=y,!1})),this.zt.length=this.Bt.length,this.Ft.length!==this.Bt.length&&(this.Ft=new Int32Array(this.Bt.length)),this.Bt.forEach((function(i,e){i.items.length=s[e];var n=t.zt[e]||new Dt;n.setData(i),t.zt[e]=n})),this.i.setRenderers(this.zt)},i.prototype._clearVisibleRange=function(){t.prototype._clearVisibleRange.call(this),this.Bt.forEach((function(t,i){t.visibleRange=null}))},i.prototype._convertToCoordinates=function(t,i,e){var s=this;if(null!==this._itemsVisibleRange){var n=i.barSpacing(),r=d(i.visibleBars()),u=t.priceToCoordinate(this._series.options().base,e);this.Bt.forEach((function(n,o){i.indexesToCoordinates(n.items),t.pointsArrayToCoordinates(n.items,e),n.histogramBase=u,n.visibleRange=wt(n.items,r,!1),s.Ft[o]=n.visibleRange.from}));for(var o=null,h=this._itemsVisibleRange.from;h<this._itemsVisibleRange.to;++h){var a=this.Vt[h],l=this.Bt[a],c=this.Ft[a]++,f=l.items[c];if(f.left=Math.floor(f.x-.5*n),f.right=Math.ceil(f.left+n),null!==o){var v=f.right-f.left>5?1:0;o.right=f.left-v}o=f}}},i}(St),At=function(t){function i(i,e){var s=t.call(this,i,e)||this;return s.Ct=new vt,s}return l(i,t),i.prototype.renderer=function(t,i){this._makeValid();var e=this._series.options(),s={items:this._items,lineColor:e.color,lineStyle:e.lineStyle,lineType:0,lineWidth:e.lineWidth,visibleRange:this._itemsVisibleRange};return this.Ct.setData(s),this.Ct},i.prototype._createRawItem=function(t,i){return this._createRawItemBase(t,i)},i}(Tt),zt=/[2-9]/g,It=function(){function t(t){void 0===t&&(t=50),this.jt=0,this.It=1,this.Pt=1,this.Wt={},this.Rt={},this.qt=t}return t.prototype.reset=function(){this.jt=0,this.Rt={},this.It=1,this.Pt=1,this.Wt={}},t.prototype.measureText=function(t,i,e){var s=e||zt,n=String(i).replace(s,"0");if(this.Rt[n])return this.Rt[n].width;if(this.jt===this.qt){var r=this.Wt[this.Pt];delete this.Wt[this.Pt],delete this.Rt[r],this.Pt++,this.jt--}var u=t.measureText(n).width;return 0===u&&i.length?0:(this.Rt[n]={width:u,tick:this.It},this.Wt[this.It]=n,this.jt++,this.It++,u)},t}(),Ot=function(){function t(t){this.Ut=null,this.Ht=null,this.Yt="right",this.Kt=0,this.$t=t}return t.prototype.setParams=function(t,i,e,s){this.Ut=t,this.Ht=i,this.Kt=e,this.Yt=s},t.prototype.draw=function(t){null!==this.Ht&&null!==this.Ut&&this.Ut.draw(t,this.Ht,this.$t,this.Kt,this.Yt)},t}(),Nt=function(){function t(t,i,e){this.Xt=t,this.$t=new It(50),this._t=i,this.l=e,this.Jt=-1,this.p=new Ot(this.$t)}return t.prototype.update=function(){this.Xt.update()},t.prototype.renderer=function(t,i){var e=this.l.paneForSource(this._t);if(null===e)return null;if(null===this._t.priceScale())return null;var s=e.priceScalePosition();if("overlay"===s)return null;var n=this.l.priceAxisRendererOptions();return n.fontSize!==this.Jt&&(this.Jt=n.fontSize,this.$t.reset()),this.p.setParams(this.Xt.paneRenderer(),n,i,s),this.p},t}(),Ft=function(){function t(){this.g=null}return t.prototype.setData=function(t){this.g=t},t.prototype.draw=function(t){if(null!==this.g&&!1!==this.g.visible){var i=this.g.y;if(!(i<0||i>this.g.height)){var s=this.g.width;t.lineCap="square",t.strokeStyle=this.g.color,t.lineWidth=this.g.lineWidth,o(t,0,i,s,i,this.g.lineStyle)}}},t}(),Bt=function(){function t(t){this._lineRendererData={width:0,height:0,y:0,color:"rgba(0, 0, 0, 0)",lineWidth:1,lineStyle:0,visible:!1},this._lineRenderer=new Ft,this.o=!0,this._series=t,this._model=t.model(),this._lineRenderer.setData(this._lineRendererData)}return t.prototype.update=function(){this.o=!0},t.prototype.renderer=function(){return this.o&&(this._updateImpl(),this.o=!1),this._lineRenderer},t}(),jt=function(t){function i(i){return t.call(this,i)||this}return l(i,t),i.prototype._updateImpl=function(){this._lineRendererData.visible=!1;var t=this._series.priceScale(),i=t.mode().mode;if(2===i||3===i){var e=this._series.options();if(e.baseLineVisible){var s=this._series.firstValue();null!==s&&(this._lineRendererData.visible=!0,this._lineRendererData.y=t.priceToCoordinate(s.value,s.value),this._lineRendererData.width=this._model.timeScale().width(),this._lineRendererData.height=t.height(),this._lineRendererData.color=e.baseLineColor,this._lineRendererData.lineWidth=e.baseLineWidth,this._lineRendererData.lineStyle=e.baseLineStyle)}}},i}(Bt);function $t(t,i){return Wt(Math.min(Math.max(t,12),30)*i)}function Ut(t,i){switch(t){case"arrowDown":case"arrowUp":return $t(i,1);case"circle":return $t(i,.8);case"square":return $t(i,.7)}}function Wt(t){var i=Math.ceil(t);return i%2==0?i-1:i}function Xt(t){return i=$t(t,1),(e=Math.ceil(i))%2!=0?e-1:e;var i,e}function Ht(t,i,e,s,n){var r=Ut("square",e),u=(r-1)/2,o=t-u,h=i-u;return s>=o&&s<=o+r&&n>=h&&n<=h+r}function Yt(t,i,e,s,n,r){var u=(Ut("arrowUp",r)-1)/2,o=(Wt(r/2)-1)/2;i.fillStyle=n,i.beginPath(),t?(i.moveTo(e-u,s),i.lineTo(e,s-u),i.lineTo(e+u,s),i.lineTo(e+o,s),i.lineTo(e+o,s+u),i.lineTo(e-o,s+u),i.lineTo(e-o,s)):(i.moveTo(e-u,s),i.lineTo(e,s+u),i.lineTo(e+u,s),i.lineTo(e+o,s),i.lineTo(e+o,s-u),i.lineTo(e-o,s-u),i.lineTo(e-o,s)),i.fill()}!function(t){t[t.MinShapeSize=12]="MinShapeSize",t[t.MaxShapeSize=30]="MaxShapeSize",t[t.MinShapeMargin=3]="MinShapeMargin"}(Et||(Et={}));var Kt=function(){function t(){this.g=null}return t.prototype.setData=function(t){this.g=t},t.prototype.draw=function(t,i,e){if(null!==this.g&&null!==this.g.visibleRange){t.save(),t.translate(.5,.5);for(var s=this.g.visibleRange.from;s<this.g.visibleRange.to;s++)qt(this.g.items[s],t);t.restore()}},t.prototype.hitTest=function(t,i){if(null===this.g||null===this.g.visibleRange)return null;for(var e=this.g.visibleRange.from;e<this.g.visibleRange.to;e++){var s=this.g.items[e];if(Jt(s,t,i))return{hitTestData:s.internalId,externalId:s.externalId}}return null},t}();function qt(t,i){switch(t.shape){case"arrowDown":return void Yt(!1,i,t.x,t.y,t.color,t.size);case"arrowUp":return void Yt(!0,i,t.x,t.y,t.color,t.size);case"circle":return void function(t,i,e,s,n){var r=(Ut("circle",n)-1)/2;t.fillStyle=s,t.beginPath(),t.arc(i,e,r,0,2*Math.PI,!1),t.fill()}(i,t.x,t.y,t.color,t.size);case"square":return void function(t,i,e,s,n){var r=Ut("square",n),u=(r-1)/2,o=i-u,h=e-u;t.fillStyle=s,t.fillRect(o,h,r,r)}(i,t.x,t.y,t.color,t.size)}t.shape}function Jt(t,i,e){switch(t.shape){case"arrowDown":case"arrowUp":return function(t,i,e,s,n,r){return Ht(i,e,s,n,r)}(0,t.x,t.y,t.size,i,e);case"circle":return function(t,i,e,s,n){var r=2+Ut("circle",e)/2,u=t-s,o=i-n;return Math.sqrt(u*u+o*o)<=r}(t.x,t.y,t.size,i,e);case"square":return Ht(t.x,t.y,t.size,i,e)}t.shape}function Qt(t,i,e,s,n,r,u,o){var h=y(e)?e:e.close,l=y(e)?e:e.high,a=y(e)?e:e.low,c=Xt(u.barSpacing());switch(t.size=c,i.position){case"inBar":return void(t.y=r.priceToCoordinate(h,o));case"aboveBar":return t.y=r.priceToCoordinate(l,o)-c/2-s.aboveBar,void(s.aboveBar+=c+n);case"belowBar":return t.y=r.priceToCoordinate(a,o)+c/2+s.belowBar,void(s.belowBar+=c+n)}i.position}var Gt,Zt=function(){function t(t,i){this.o=!0,this.Zt=!0,this.Qt=null,this.p=new Kt,this.Gt=t,this.V=i,this.g={items:[],visibleRange:null}}return t.prototype.update=function(t){this.o=!0,"data"===t&&(this.Zt=!0)},t.prototype.renderer=function(t,i,e){return this.o&&this._makeValid(),this.p.setData(this.g),this.p},t.prototype.autoScaleMargins=function(){return this.o&&this._makeValid(),this.Qt},t.prototype._makeValid=function(){var t=this.Gt.priceScale(),i=this.V.timeScale(),e=this.Gt.indexedMarkers();this.Zt&&(this.g.items=e.map((function(t){return{time:t.time,x:0,y:0,size:0,shape:t.shape,color:t.color,internalId:t.internalId,externalId:t.id}})),this.Zt=!1);var s,n=(s=i.barSpacing(),Math.max($t(s,.1),3));if(e.length>0){var r=1.5*Xt(i.barSpacing())+2*n;this.Qt={above:r,below:r}}else this.Qt=null;this.g.visibleRange=null;var u=i.visibleBars();if(null!==u){var o=this.Gt.firstValue();if(null!==o){var h=NaN,l={aboveBar:n,belowBar:n};this.g.visibleRange=wt(this.g.items,u,!0);for(var a=this.g.visibleRange.from;a<this.g.visibleRange.to;a++){var c=e[a];c.time!==h&&(l.aboveBar=n,l.belowBar=n,h=c.time);var f=this.g.items[a];f.x=i.indexToCoordinate(c.time);var d=this.Gt.dataAt(c.time);null!==d&&Qt(f,c,d,l,n,t,i,o.value)}this.o=!1}}},t}(),ti=function(t){function i(i){return t.call(this,i)||this}return l(i,t),i.prototype._updateImpl=function(){this._lineRendererData.visible=!1;var t=this._series.options();if(t.priceLineVisible){var i=this._series.lastValueData(void 0,!0);i.noData||(this._lineRendererData.visible=!0,this._lineRendererData.y=i.coordinate,this._lineRendererData.color=this._series.priceLineColor(i.color),this._lineRendererData.width=this._model.timeScale().width(),this._lineRendererData.height=this._series.priceScale().height(),this._lineRendererData.lineWidth=t.priceLineWidth,this._lineRendererData.lineStyle=t.priceLineStyle)}},i}(Bt),ii=function(t){function i(i,e){var s=t.call(this)||this;return s.k=i,s.g=e,s}return l(i,t),i.prototype._getSource=function(){return this.k},i.prototype._getData=function(){return this.g},i.prototype._updateRendererData=function(t,i,e){t.visible=!1,i.visible=!1;var s=this.k.options(),n=s.lastValueVisible,r=""!==this.k.title(),u=0===s.seriesLastValueMode,o=this.k.lastValueData(void 0,!1);o.noData||(n&&(t.text=this._axisText(o,n,u),t.visible=0!==t.text.length),(r||u)&&(i.text=this._paneText(o,n,r,u),i.visible=i.text.length>0),e.background=this.k.priceLineColor(o.color),e.color=O(e.background),e.coordinate=o.coordinate,e.floatCoordinate=o.floatCoordinate)},i.prototype._paneText=function(t,i,e,s){var n="",r=this.k.title();return e&&0!==r.length&&(n+=r+" "),i&&s&&(n+=this.k.priceScale().isPercentage()?t.formattedPriceAbsolute:t.formattedPricePercentage),n.trim()},i.prototype._axisText=function(t,i,e){return i?e?this.k.priceScale().isPercentage()?t.formattedPricePercentage:t.formattedPriceAbsolute:t.text:""},i}(F),ei=function(){function t(){this.ti=0,this.ii=new Map,this.ni=new Map}return t.prototype.colorByIndex=function(t){return f(this.ni.get(t))},t.prototype.addColor=function(t){var i=this.ii.get(t);return void 0===i&&(i=this.ti++,this.ii.set(t,i),this.ni.set(i,t)),i},t.prototype.clear=function(){this.ti=0,this.ii.clear(),this.ni.clear()},t.prototype.size=function(){return this.ni.size},t}(),ni={barColor:"",barBorderColor:"",barWickColor:""},ri=function(){function t(t){this.Gt=t}return t.prototype.barStyle=function(t,i){var e=this.Gt.seriesType(),s=this.Gt.options();switch(e){case"Line":return this.si(s);case"Area":return this.hi(s);case"Bar":return this.ri(s,t,i);case"Candlestick":return this.ui(s,t,i);case"Histogram":return this.ei(s,t,i)}throw new Error("Unknown chart style")},t.prototype.ri=function(t,i,e){var s=u({},ni),n=t.upColor,r=t.downColor,o=n,h=r,l=d(this.oi(i,e)),c=a(l.value[0])<=a(l.value[3]);return s.barColor=c?n:r,s.barBorderColor=c?o:h,s},t.prototype.ui=function(t,i,e){var s=u({},ni),n=t.upColor,r=t.downColor,o=t.borderUpColor,h=t.borderDownColor,l=t.wickUpColor,c=t.wickDownColor,f=d(this.oi(i,e)),v=a(f.value[0])<=a(f.value[3]);return s.barColor=v?n:r,s.barBorderColor=v?o:h,s.barWickColor=v?l:c,s},t.prototype.hi=function(t){return u({},ni,{barColor:t.lineColor})},t.prototype.si=function(t){return u({},ni,{barColor:t.color})},t.prototype.ei=function(t,i,e){var s=u({},ni),n=d(this.oi(i,e)).value[4];if(null!=n){var r=d(this.Gt.palette());s.barColor=r.colorByIndex(n)}else s.barColor=t.color;return s},t.prototype.fi=function(){return this.Gt.bars()},t.prototype.oi=function(t,i){return void 0!==i?i.value:this.fi().valueAt(t)},t}();!function(t){t[t.NearestLeft=-1]="NearestLeft",t[t.Exact=0]="Exact",t[t.NearestRight=1]="NearestRight"}(Gt||(Gt={}));var si,oi=function(){function t(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.ai=[],this.ci=0,this.li=0,this.vi=!1,this.di=new Map,this.wi=new Map,this.bi=new Map,this.mi=t||new Map,this.gi=i}return t.prototype.clear=function(){this.ai=[],this.ci=0,this.li=0,this.vi=!1,this.di.clear(),this.wi.clear(),this.bi.clear()},t.prototype.first=function(){return this.size()>0?this.ai[this.ci]:null},t.prototype.last=function(){return this.size()>0?this.ai[this.li-1]:null},t.prototype.firstIndex=function(){return this.size()>0?this.Mi(this.ci):null},t.prototype.lastIndex=function(){return this.size()>0?this.Mi(this.li-1):null},t.prototype.size=function(){return this.li-this.ci},t.prototype.isEmpty=function(){return 0===this.size()},t.prototype.contains=function(t){return null!==this.pi(t,0)},t.prototype.valueAt=function(t){return this.search(t)},t.prototype.add=function(t,i,e){if(this.vi)return!1;var s={index:t,value:e,time:i},n=this.pi(t,0);return this.wi.clear(),this.bi.clear(),null===n?(this.ai.splice(this.yi(t),0,s),this.ci=0,this.li=this.ai.length,!0):(this.ai[n]=s,!1)},t.prototype.search=function(t,i,e){void 0===i&&(i=0);var s=this.pi(t,i,e);if(null===s)return null;var n=this.ki(s);return{index:this.Mi(s),time:n.time,value:n.value}},t.prototype.each=function(t){for(var i=this.ci;i<this.li&&!t(this.Mi(i),this.ki(i));++i);},t.prototype.range=function(i,e){var s=new t(this.mi,this.gi);return s.ai=this.ai,s.ci=this.yi(i),s.li=this.Ni(e),s.vi=!0,s},t.prototype.minMaxOnRangeCached=function(t,i,e){if(this.isEmpty())return null;for(var s=null,n=0,r=e;n<r.length;n++){var u=r[n];s=hi(s,this.Si(t,i,u))}return s},t.prototype.merge=function(t){return this.vi?null:0===t.length?null:this.isEmpty()||t[t.length-1].index<this.ai[0].index?this.xi(t):t[0].index>this.ai[this.ai.length-1].index?this.Ci(t):1===t.length&&t[0].index===this.ai[this.ai.length-1].index?(this.Di(t[0]),t[0]):this.Ei(t)},t.prototype.remove=function(t){if(this.vi)return null;var i=this.pi(t,1);if(null===i)return null;var e=this.ai.splice(i);return this.li=this.ai.length,this.di.clear(),this.wi.clear(),this.bi.clear(),e.length>0?e[0]:null},t.prototype.Mi=function(t){return this.ai[t].index},t.prototype.ki=function(t){return this.ai[t]},t.prototype.pi=function(t,i,e){var s=this.Oi(t);if(null===s&&0!==i)switch(i){case-1:return this.Ai(t,e);case 1:return this.Ti(t,e);default:throw new TypeError("Unknown search mode")}if(!e||null===s||0===i)return s;switch(i){case-1:return this.Li(s);case 1:return this.Bi(s);default:throw new TypeError("Unknown search mode")}},t.prototype.Bi=function(t){for(var i=d(this.gi);t<this.li&&i(this.ki(t).value);)t+=1;return t===this.li?null:t},t.prototype.Li=function(t){for(var i=d(this.gi);t>=this.ci&&i(this.ki(t).value);)t-=1;return t<this.ci?null:t},t.prototype.Ai=function(t,i){var e=this.yi(t);e>this.ci&&(e-=1);var s=e!==this.li&&this.Mi(e)<t?e:null;return i&&null!==s?this.Li(s):s},t.prototype.Ti=function(t,i){var e=this.Ni(t),s=e!==this.li&&t<this.Mi(e)?e:null;return i&&null!==s?this.Bi(s):s},t.prototype.Oi=function(t){var i=this.yi(t);return i===this.li||t<this.ai[i].index?null:i},t.prototype.yi=function(t){return yt(this.ai,t,(function(t,i){return t.index<i}),this.ci,this.li)},t.prototype.Ni=function(t){return mt(this.ai,t,(function(t,i){return i.index>t}),this.ci,this.li)},t.prototype.zi=function(t,i,e){var s=null,n=this.mi.get(e.name);if(void 0===n)throw new Error('Plot "'+e.name+'" is not registered');for(var r=t;r<i;r++){var u=n(this.ai[r].value);null==u||Number.isNaN(u)||(null===s?s={min:u,max:u}:(u<s.min&&(s.min=u),u>s.max&&(s.max=u)))}return s},t.prototype.Vi=function(t){var i=Math.floor(t.index/30);this.di.forEach((function(t){return t.delete(i)}))},t.prototype.xi=function(t){return c(!this.vi,"collection should not be readonly"),c(0!==t.length,"plotRows should not be empty"),this.wi.clear(),this.bi.clear(),this.di.clear(),this.ai=t.concat(this.ai),this.ci=0,this.li=this.ai.length,t[0]},t.prototype.Ci=function(t){return c(!this.vi,"collection should not be readonly"),c(0!==t.length,"plotRows should not be empty"),this.wi.clear(),this.bi.clear(),this.di.clear(),this.ai=this.ai.concat(t),this.ci=0,this.li=this.ai.length,t[0]},t.prototype.Di=function(t){c(!this.isEmpty(),"plot list should not be empty"),c(this.ai[this.li-1].index===t.index,"last row index should match new row index"),this.Vi(t),this.wi.delete(t.index),this.bi.delete(t.index),this.ai[this.li-1]=t},t.prototype.Ei=function(t){return c(0!==t.length,"plot rows should not be empty"),this.wi.clear(),this.bi.clear(),this.di.clear(),this.ai=function(t,i){for(var e=function(t,i){for(var e=t.length,s=i.length,n=e+s,r=0,u=0;r<e&&u<s;)t[r].index<i[u].index?r++:t[r].index>i[u].index?u++:(r++,u++,n--);return n}(t,i),s=new Array(e),n=0,r=0,u=t.length,o=i.length,h=0;n<u&&r<o;)t[n].index<i[r].index?(s[h]=t[n],n++):t[n].index>i[r].index?(s[h]=i[r],r++):(s[h]=i[r],n++,r++),h++;for(;n<u;)s[h]=t[n],n++,h++;for(;r<o;)s[h]=i[r],r++,h++;return s}(this.ai,t),this.ci=0,this.li=this.ai.length,t[0]},t.prototype.Si=function(t,i,e){if(this.isEmpty())return null;var s=null,n=d(this.firstIndex()),r=d(this.lastIndex()),u=t-e.offset,o=i-e.offset;u=Math.max(u,n),o=Math.min(o,r);var h=30*Math.ceil(u/30),a=Math.max(h,30*Math.floor(o/30)),l=this.yi(u),c=this.Ni(Math.min(o,h,i));s=hi(s,this.zi(l,c,e));var f=this.di.get(e.name);void 0===f&&(f=new Map,this.di.set(e.name,f));for(var v=Math.max(h+1,u);v<a;v+=30){var y=Math.floor(v/30),b=f.get(y);if(void 0===b){var m=this.yi(30*y),g=this.Ni(30*(y+1)-1);b=this.zi(m,g,e),f.set(y,b)}s=hi(s,b)}return l=this.yi(a),c=this.Ni(o),hi(s,this.zi(l,c,e))},t}();function hi(t,i){return null===t?i:null===i?t:{min:Math.min(t.min,i.min),max:Math.max(t.max,i.max)}}!function(t){t[t.Open=0]="Open",t[t.High=1]="High",t[t.Low=2]="Low",t[t.Close=3]="Close",t[t.Color=4]="Color"}(si||(si={}));var ai={open:function(t){return t[0]},high:function(t){return t[1]},low:function(t){return t[2]},close:function(t){return t[3]},hl2:function(t){return(t[1]+t[2])/2},hlc3:function(t){return(t[1]+t[2]+t[3])/3},ohlc4:function(t){return(t[0]+t[1]+t[2]+t[3])/4}},ui=["open","high","low","close","hl2","hlc3","ohlc4"];function li(t){return ai[t]}var ci,pi=function(){function t(){var t;this.Fi=new oi((t=new Map,ui.forEach((function(i,e){t.set(i,li(i))})),t))}return t.prototype.bars=function(){return this.Fi},t.prototype.size=function(){return this.Fi.size()},t.prototype.each=function(t){this.Fi.each(t)},t.prototype.clear=function(){this.Fi.clear()},t.prototype.isEmpty=function(){return this.Fi.isEmpty()},t.prototype.first=function(){return this.Fi.first()},t.prototype.last=function(){return this.Fi.last()},t.prototype.search=function(t,i){return this.bars().search(t,i)},t.prototype.valueAt=function(t){return this.search(t)},t}(),fi=function(t){function i(i,e,s){var n=t.call(this,i)||this;n.g=new pi,n.ji=new ti(n),n.Ii=new jt(n),n.Pi=!1,n.Z=null,n.Wi=null,n.Ri=new ei,n.qi=[],n.Ui=[],n.$=e,n.Hi=s,n.createPaneView();var r=new ii(n,{model:i});return n.R=[r],n.Yi=new Nt(r,n,i),n.Ki(),n.$i(),n.Xi=n.barFunction(),n.X=new Zt(n,i),n}return l(i,t),i.prototype.destroy=function(){},i.prototype.endOfData=function(){return this.Pi},i.prototype.priceLineColor=function(t){return this.$.priceLineColor||t},i.prototype.lastValueData=function(t,i,e){var s={noData:!0},n=this.priceScale();if(this.model().timeScale().isEmpty()||n.isEmpty()||this.data().isEmpty())return s;var r,u,o=this.model().timeScale().visibleBars(),h=this.firstValue();if(null===o||null===h)return s;if(i){var l=this.data().bars().last();if(null===l)return s;r=l,u=l.index}else{var a=this.data().bars().search(o.lastBar(),-1);if(null===a)return s;if(null===(r=this.data().bars().valueAt(a.index)))return s;u=a.index}var c=void 0!==t?r.value[t]:this.Xi(r.value),f=this.barColorer().barStyle(u,{value:r}),d=n.priceToCoordinate(c,h.value,!0);return{noData:!1,price:e?c:void 0,text:n.formatPrice(c,h.value),formattedPriceAbsolute:n.formatPriceAbsolute(c),formattedPricePercentage:n.formatPricePercentage(c,h.value),color:f.barColor,floatCoordinate:d,coordinate:Math.round(d),index:u}},i.prototype.data=function(){return this.g},i.prototype.createPaneView=function(){switch(this.Z=null,this.Hi){case"Bar":this.Z=new kt(this,this.model());break;case"Candlestick":this.Z=new Rt(this,this.model());break;case"Line":this.Z=new At(this,this.model());break;case"Area":this.Z=new xt(this,this.model());break;case"Histogram":this.Z=new _t(this,this.model());break;default:throw Error("Unknown chart style assigned: "+this.Hi)}},i.prototype.barColorer=function(){return null!==this.Wi?this.Wi:(this.Wi=new ri(this),this.Wi)},i.prototype.options=function(){return this.$},i.prototype.applyOptions=function(t){var i=this.$.overlay;v(this.$,t),this.$.overlay=i,i&&null!==this._priceScale&&void 0!==t.scaleMargins&&this._priceScale.applyOptions({scaleMargins:this.$.scaleMargins}),void 0!==t.priceFormat&&this.Ki(),this.model().updateSource(this)},i.prototype.setData=function(t){this.g.clear(),this.g.bars().merge(t),this._i(),null!==this.Z&&this.Z.update("data"),this.X.update("data");var i=this.model().paneForSource(this);this.model().recalculatePane(i),this.model().updateSource(this),this.model().updateCrosshair(),this.model().lightUpdate()},i.prototype.setMarkers=function(t){this.qi=t.map((function(t){return u({},t)})),this._i();var i=this.model().paneForSource(this);this.X.update("data"),this.model().recalculatePane(i),this.model().updateSource(this),this.model().updateCrosshair(),this.model().lightUpdate()},i.prototype.markers=function(){return this.qi},i.prototype.indexedMarkers=function(){return this.Ui},i.prototype.updateData=function(t){this.g.bars().merge(t),this._i(),null!==this.Z&&this.Z.update("data"),this.X.update("data");var i=this.model().paneForSource(this);this.model().recalculatePane(i),this.model().updateSource(this),this.model().updateCrosshair(),this.model().lightUpdate()},i.prototype.palette=function(){return this.Ri},i.prototype.seriesType=function(){return this.Hi},i.prototype.firstValue=function(){var t=this.firstBar();return null===t?null:{value:this.Xi(t.value),timePoint:t.time}},i.prototype.firstBar=function(){var t=this.model().timeScale().visibleBars();if(null===t)return null;var i=t.firstBar();return this.data().search(i,1)},i.prototype.bars=function(){return this.g.bars()},i.prototype.nearestIndex=function(t,i){var e=this.nearestData(t,i);return e?e.index:null},i.prototype.nearestData=function(t,i){return m(t)?this.data().search(t,i):null},i.prototype.dataAt=function(t){var i=this.data().valueAt(t);return null===i?null:"Bar"===this.Hi||"Candlestick"===this.Hi?{open:i.value[0],high:i.value[1],low:i.value[2],close:i.value[3]}:this.barFunction()(i.value)},i.prototype.paneViews=function(){var t=[];return this.priceScale()===this.model().mainPriceScale()&&t.push(this.Ii),t.push(d(this.Z)),t.push(this.ji),t.push(this.Yi),t.push(this.X),t},i.prototype.priceAxisViews=function(t,i){return this.R},i.prototype.autoscaleInfo=function(t,i){if(!m(t)||!m(i)||this.data().isEmpty())return null;var e,s="Line"===this.Hi||"Area"===this.Hi||"Histogram"===this.Hi?"close":null,n=null!==(e=null!==s?this.data().bars().minMaxOnRangeCached(t,i,[{name:s,offset:0}]):this.data().bars().minMaxOnRangeCached(t,i,[{name:"low",offset:0},{name:"high",offset:0}]))?new Z(e.min,e.max):null;if("Histogram"===this.seriesType()){var r=this.$.base,u=new Z(r,r);n=null!==n?n.merge(u):u}return{priceRange:n,margins:this.X.autoScaleMargins()}},i.prototype.minMove=function(){return this.$.priceFormat.minMove},i.prototype.formatter=function(){return this.Ji},i.prototype.barFunction=function(){return this.Xi},i.prototype.updateAllViews=function(){if(null!==this.Z){this.Z.update(),this.X.update();for(var t=this.R.length,i=0;i<t;i++)this.R[i].update();this.ji.update(),this.Ii.update()}},i.prototype.setPriceScale=function(t){this._priceScale!==t&&(this._priceScale=t)},i.prototype.priceScale=function(){return d(this._priceScale)},i.prototype.markerDataAtIndex=function(t){if("Line"!==this.Hi&&"Area"!==this.Hi||!this.$.crosshairMarkerVisible)return null;var i=this.g.valueAt(t);return null===i?null:{price:this.Xi(i.value),radius:this.Zi()}},i.prototype.title=function(){return this.$.title},i.prototype.Zi=function(){switch(this.Hi){case"Line":case"Area":return this.$.crosshairMarkerRadius}return 0},i.prototype.Ki=function(){switch(this.$.priceFormat.type){case"custom":this.Ji={format:this.$.priceFormat.formatter};break;case"volume":this.Ji=new pt(this.$.priceFormat.precision);break;case"percent":this.Ji=new J(this.$.priceFormat.precision);break;default:var t=Math.pow(10,this.$.priceFormat.precision);this.Ji=new K(t,this.$.priceFormat.minMove*t,!1,void 0)}null!==this._priceScale&&this._priceScale.updateFormatter()},i.prototype.$i=function(){this.Xi=li("close")},i.prototype._i=function(){var t=this.model().timeScale().points();this.Ui=this.qi.map((function(i,e){return{time:d(t.indexOf(i.time.timestamp,!0)),position:i.position,shape:i.shape,color:i.color,id:i.id,internalId:e}}))},i}(G);function di(t){return t.slice().sort((function(t,i){return d(t.zorder())-d(i.zorder())}))}!function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"}(ci||(ci={}));var vi=new J,yi=new K(100,1),mi=function(){function t(t,i,e){this.Qi=0,this.Gi=null,this.tn=new Q,this.in=null,this.nn=null,this.sn=new Q,this.hn={isValid:!1,visibleBars:null},this.rn=0,this.un=0,this.en=new Q,this.on=new Q,this.fn=[],this.an=null,this.cn=!1,this.ln=null,this.vn=null,this.dn=null,this.wn=null,this.Ji=yi,this.bn=new Q,this.$=t,this.mn=i,this.gn=e,this.Mn=new ct(this,100,this.pn.bind(this),this.yn.bind(this))}return t.prototype.options=function(){return this.$},t.prototype.applyOptions=function(t){if(v(this.$,t),this.updateFormatter(),void 0!==t.mode&&this.setMode({mode:t.mode}),this.bn.fire(),void 0!==t.scaleMargins){var i=f(t.scaleMargins.top),e=f(t.scaleMargins.bottom);if(i<0||i>1)throw new Error("Invalid top margin - expect value between 0 and 1, given="+i);if(e<0||e>1||i+e>1)throw new Error("Invalid bottom margin - expect value between 0 and 1, given="+e);if(i+e>1)throw new Error("Invalid margins - sum of margins must be less than 1, given="+(i+e));this.kn(),this.vn=null}},t.prototype.optionsChanged=function(){return this.bn},t.prototype.isAutoScale=function(){return this.$.autoScale},t.prototype.isLog=function(){return 1===this.$.mode},t.prototype.isPercentage=function(){return 2===this.$.mode},t.prototype.isIndexedTo100=function(){return 3===this.$.mode},t.prototype.mode=function(){return{autoScale:this.$.autoScale,isInverted:this.$.invertScale,mode:this.$.mode}},t.prototype.setMode=function(t){var i=this.mode(),e=null;void 0!==t.autoScale&&(this.$.autoScale=t.autoScale),void 0!==t.mode&&(this.$.mode=t.mode,2!==t.mode&&3!==t.mode||(this.$.autoScale=!0),this.hn.isValid=!1),1===i.mode&&t.mode!==i.mode&&(function(t){if(null===t)return!1;var i=at(t.minValue()),e=at(t.maxValue());return isFinite(i)&&isFinite(e)}(this.in)?null!==(e=function(t){if(null===t)return null;var i=at(t.minValue()),e=at(t.maxValue());return new Z(i,e)}(this.in))&&this.setPriceRange(e):this.$.autoScale=!0),1===t.mode&&t.mode!==i.mode&&null!==(e=lt(this.in))&&this.setPriceRange(e);var s=i.mode!==this.$.mode;s&&(2===i.mode||this.isPercentage())&&this.updateFormatter(),s&&(3===i.mode||this.isIndexedTo100())&&this.updateFormatter(),void 0!==t.isInverted&&i.isInverted!==t.isInverted&&(this.$.invertScale=t.isInverted,this.Nn()),this.on.fire(i,this.mode())},t.prototype.modeChanged=function(){return this.on},t.prototype.fontSize=function(){return this.mn.fontSize},t.prototype.height=function(){return this.Qi},t.prototype.setHeight=function(t){this.Qi!==t&&(this.Qi=t,this.kn(),this.vn=null)},t.prototype.internalHeight=function(){if(this.Gi)return this.Gi;var t=this.height()-this.Sn()-this.xn();return this.Gi=t,t},t.prototype.internalHeightChanged=function(){return this.tn},t.prototype.priceRange=function(){return this.Cn(),this.in},t.prototype.priceRangeChanged=function(){return this.sn},t.prototype.setPriceRange=function(t,i,e){var s=this.in;(i||null===s&&null!==t||null!==s&&!s.equals(t))&&(this.vn=null,this.in=t,e||this.sn.fire(s,t))},t.prototype.isEmpty=function(){return this.Cn(),0===this.Qi||!this.in||this.in.isEmpty()},t.prototype.invertedCoordinate=function(t){return this.isInverted()?t:this.height()-1-t},t.prototype.priceToCoordinate=function(t,i,e){return this.isPercentage()?t=nt(t,i):this.isIndexedTo100()&&(t=st(t,i)),this.yn(t,i,e)},t.prototype.pointsArrayToCoordinates=function(t,i,e){this.Cn();for(var s=this.xn(),n=d(this.priceRange()),r=n.minValue(),u=n.maxValue(),o=this.internalHeight()-1,h=this.isInverted(),a=o/(u-r),l=void 0===e?0:e.from,c=void 0===e?t.length:e.to,f=this.Dn(),v=l;v<c;v++){var y=t[v],b=y.price;if(!isNaN(b)){var m=b;null!==f&&(m=f(y.price,i));var g=s+a*(m-r),w=h?g:this.Qi-1-g;y.y=Math.round(w)}}},t.prototype.barPricesToCoordinates=function(t,i,e){this.Cn();for(var s=this.xn(),n=d(this.priceRange()),r=n.minValue(),u=n.maxValue(),o=this.internalHeight()-1,h=this.isInverted(),a=o/(u-r),l=void 0===e?0:e.from,c=void 0===e?t.length:e.to,f=this.Dn(),v=l;v<c;v++){var y=t[v],b=y.open,m=y.high,g=y.low,w=y.close;null!==f&&(b=f(y.open,i),m=f(y.high,i),g=f(y.low,i),w=f(y.close,i));var p=s+a*(b-r),S=h?p:this.Qi-1-p;y.openY=Math.round(S),p=s+a*(m-r),S=h?p:this.Qi-1-p,y.highY=Math.round(S),p=s+a*(g-r),S=h?p:this.Qi-1-p,y.lowY=Math.round(S),p=s+a*(w-r),S=h?p:this.Qi-1-p,y.closeY=Math.round(S)}},t.prototype.coordinateToPrice=function(t,i){var e=this.pn(t,i);return this.logicalToPrice(e,i)},t.prototype.logicalToPrice=function(t,i){var e=t;return this.isPercentage()?e=function(t,i){return i<0&&(t=-t),t/100*i+i}(e,i):this.isIndexedTo100()&&(e=function(t,i){return t-=100,i<0&&(t=-t),t/100*i+i}(e,i)),e},t.prototype.dataSources=function(){return this.fn},t.prototype.orderedSources=function(){if(this.an)return this.an;for(var t=[],i=0;i<this.fn.length;i++){var e=this.fn[i];null===e.zorder()&&e.setZorder(i+1),t.push(e)}return t=di(t),this.an=t,this.an},t.prototype.hasSeries=function(){return this.cn},t.prototype.addDataSource=function(t){-1===this.fn.indexOf(t)&&(t instanceof fi&&(this.cn=!0),this.fn.push(t),this.ln=null,this.updateFormatter(),this.invalidateSourcesCache())},t.prototype.removeDataSource=function(t){var i=this.fn.indexOf(t);if(-1===i)throw new Error("source is not attached to scale");this.fn.splice(i,1),t instanceof fi&&(this.cn=!1),this.mainSource()||this.setMode({autoScale:!0}),this.ln=null,this.updateFormatter(),this.invalidateSourcesCache()},t.prototype.mainSource=function(){if(null!==this.ln)return this.ln;for(var t=null,i=0;i<this.fn.length;i++){var e=this.fn[i];if(e instanceof fi){t=e;break}null===t&&e instanceof G&&(t=e)}return this.ln=t,this.ln},t.prototype.firstValue=function(){for(var t=null,i=0,e=this.fn;i<e.length;i++){var s=e[i];if(s instanceof G){var n=s.firstValue();if(null===n)continue;(null===t||n.timePoint<t.timePoint)&&(t=n)}}return null===t?null:t.value},t.prototype.isInverted=function(){return this.$.invertScale},t.prototype.marks=function(){return this.vn?this.vn:(this.Mn.rebuildTickMarks(),this.vn=this.Mn.marks(),this.en.fire(),this.vn)},t.prototype.onMarksChanged=function(){return this.en},t.prototype.startScale=function(t){this.isPercentage()||this.isIndexedTo100()||null===this.dn&&null===this.nn&&(this.isEmpty()||(this.dn=this.Qi-t,this.nn=d(this.priceRange()).clone()))},t.prototype.scaleTo=function(t){if(!this.isPercentage()&&!this.isIndexedTo100()&&null!==this.dn){this.setMode({autoScale:!1}),(t=this.Qi-t)<0&&(t=0);var i=(this.dn+.2*(this.Qi-1))/(t+.2*(this.Qi-1)),e=d(this.nn).clone();i=Math.max(i,.1),e.scaleAroundCenter(i),this.setPriceRange(e)}},t.prototype.endScale=function(){this.isPercentage()||this.isIndexedTo100()||(this.dn=null,this.nn=null)},t.prototype.startScroll=function(t){this.isAutoScale()||null===this.wn&&null===this.nn&&(this.isEmpty()||(this.wn=t,this.nn=d(this.priceRange()).clone()))},t.prototype.scrollTo=function(t){if(!this.isAutoScale()&&null!==this.wn){var i=d(this.priceRange()).length()/(this.height()-1),e=t-this.wn;this.isInverted()&&(e*=-1);var s=e*i,n=d(this.nn).clone();n.shift(s),this.setPriceRange(n,!0),this.vn=null}},t.prototype.endScroll=function(){this.isAutoScale()||null!==this.wn&&(this.wn=null,this.nn=null)},t.prototype.formatter=function(){return this.Ji||this.updateFormatter(),this.Ji},t.prototype.formatPrice=function(t,i){switch(this.$.mode){case 2:return this.formatter().format(nt(t,i));case 3:return this.formatter().format(st(t,i));default:return this.En(t)}},t.prototype.formatLogical=function(t){switch(this.$.mode){case 2:case 3:return this.formatter().format(t);default:return this.En(t)}},t.prototype.formatPriceAbsolute=function(t){return this.En(t,this.On())},t.prototype.formatPricePercentage=function(t,i){return t=nt(t,i),vi.format(t)},t.prototype.sourcesForAutoScale=function(){return this.fn.filter((function(t){return t instanceof G}))},t.prototype.recalculatePriceRange=function(t){this.hn={visibleBars:t,isValid:!1}},t.prototype.updateAllViews=function(){this.fn.forEach((function(t){return t.updateAllViews()}))},t.prototype.updateFormatter=function(){this.vn=null;var t=this.mainSource(),i=100;null!==t&&(i=Math.round(1/t.minMove())),this.Ji=yi,this.isPercentage()?(this.Ji=vi,i=100):this.isIndexedTo100()?(this.Ji=new K(100,1),i=100):null!==t&&(this.Ji=t.formatter()),this.Mn=new ct(this,i,this.pn.bind(this),this.yn.bind(this)),this.Mn.rebuildTickMarks()},t.prototype.invalidateSourcesCache=function(){this.an=null},t.prototype.Sn=function(){return this.isInverted()?this.$.scaleMargins.bottom*this.height()+this.un:this.$.scaleMargins.top*this.height()+this.rn},t.prototype.xn=function(){return this.isInverted()?this.$.scaleMargins.top*this.height()+this.rn:this.$.scaleMargins.bottom*this.height()+this.un},t.prototype.Cn=function(){this.hn.isValid||(this.hn.isValid=!0,this.An())},t.prototype.kn=function(){this.Gi=null,this.tn.fire()},t.prototype.yn=function(t,i,e){if(this.Cn(),this.isEmpty())return 0;t=this.isLog()&&t?ht(t):t;var s=d(this.priceRange()),n=this.xn()+(this.internalHeight()-1)*(t-s.minValue())/s.length(),r=this.invertedCoordinate(n);return e?r:Math.round(r)},t.prototype.pn=function(t,i){if(this.Cn(),this.isEmpty())return 0;var e=this.invertedCoordinate(t),s=d(this.priceRange()),n=s.minValue()+s.length()*((e-this.xn())/(this.internalHeight()-1));return this.isLog()?at(n):n},t.prototype.Nn=function(){this.vn=null,this.Mn.rebuildTickMarks()},t.prototype.On=function(){return d(this.mainSource()).formatter()},t.prototype.An=function(){var t=this.hn.visibleBars;if(null!==t){for(var i=null,e=0,s=0,n=0,r=this.sourcesForAutoScale();n<r.length;n++){var u=r[n],o=u.firstValue();if(null!==o){var h=u.autoscaleInfo(t.firstBar(),t.lastBar()),a=h&&h.priceRange;if(null!==a){switch(this.$.mode){case 1:a=lt(a);break;case 2:a=rt(a,o.value);break;case 3:a=ot(a,o.value)}i=null===i?a:i.merge(d(a)),null!==h&&null!==h.margins&&(e=Math.max(e,h.margins.above),s=Math.max(e,h.margins.below))}}}if(e===this.rn&&s===this.un||(this.rn=e,this.un=s,this.vn=null,this.kn()),null!==i){if(i.minValue()===i.maxValue()){var l=this.mainSource(),c=5*(null===l||this.isPercentage()||this.isIndexedTo100()?1:l.minMove());i=new Z(i.minValue()-c,i.maxValue()+c)}this.setPriceRange(i)}else null===this.in&&this.setPriceRange(new Z(-.5,.5));this.hn.isValid=!0}},t.prototype.Dn=function(){return this.isPercentage()?nt:this.isIndexedTo100()?st:this.isLog()?ht:null},t.prototype.En=function(t,i){return void 0===this.gn.priceFormatter?(void 0===i&&(i=this.formatter()),i.format(t)):this.gn.priceFormatter(t)},t}();function gi(t){return!y(t)&&!w(t)}function bi(t){return y(t)}var wi=/(\d+(?:\.\d+)?)(px|em|rem|pt)/g,Si=document.createElement("canvas").getContext("2d")||{},Ti=Si.backingStorePixelRatio||Si.webkitBackingStorePixelRatio||Si.mozBackingStorePixelRatio||Si.msBackingStorePixelRatio||Si.oBackingStorePixelRatio||Si.backingStorePixelRatio||1,xi=(window.devicePixelRatio||1)/Ti;function Mi(t){t.width!==Math.floor(parseInt(d(t.style.width))*xi)&&(t.style.width=t.width+"px",t.width*=xi,t.height*=xi);var i=t.getContext("2d");return null===i?null:new Li(i,xi)}var Ci,Li=function(){function t(t,i){this.canvas=t.canvas,this.Tn=t,this.Ln=i}return t.prototype.restore=function(){this.Tn.restore()},t.prototype.save=function(){this.Tn.save()},t.prototype.getTransform=function(){return this.Tn.getTransform()},t.prototype.resetTransform=function(){this.Tn.resetTransform()},t.prototype.rotate=function(t){this.Tn.rotate(t)},t.prototype.scale=function(t,i){this.Tn.scale(t,i)},t.prototype.setTransform=function(t,i,e,s,n,r){y(t)?this.Tn.setTransform(t,i,e,s,n,r):this.Tn.setTransform(t)},t.prototype.transform=function(t,i,e,s,n,r){this.Tn.transform(t,i,e,s,n,r)},t.prototype.translate=function(t,i){this.Tn.translate(t*this.Ln,i*this.Ln)},Object.defineProperty(t.prototype,"globalAlpha",{get:function(){return this.Tn.globalAlpha},set:function(t){this.Tn.globalAlpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalCompositeOperation",{get:function(){return this.Tn.globalCompositeOperation},set:function(t){this.Tn.globalCompositeOperation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageSmoothingEnabled",{get:function(){return this.Tn.imageSmoothingEnabled},set:function(t){this.Tn.imageSmoothingEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageSmoothingQuality",{get:function(){return this.Tn.imageSmoothingQuality},set:function(t){this.Tn.imageSmoothingQuality=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillStyle",{get:function(){return this.Tn.fillStyle},set:function(t){this.Tn.fillStyle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeStyle",{get:function(){return this.Tn.strokeStyle},set:function(t){this.Tn.strokeStyle=t},enumerable:!0,configurable:!0}),t.prototype.createLinearGradient=function(t,i,e,s){return this.Tn.createLinearGradient(t*this.Ln,i*this.Ln,e*this.Ln,s*this.Ln)},t.prototype.createPattern=function(t,i){return this.Tn.createPattern(t,i)},t.prototype.createRadialGradient=function(t,i,e,s,n,r){return this.Tn.createRadialGradient(t*this.Ln,i*this.Ln,e*this.Ln,s*this.Ln,n*this.Ln,r*this.Ln)},Object.defineProperty(t.prototype,"shadowBlur",{get:function(){return this.Tn.shadowBlur},set:function(t){this.Tn.shadowBlur=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowColor",{get:function(){return this.Tn.shadowColor},set:function(t){this.Tn.shadowColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowOffsetX",{get:function(){return this.Tn.shadowOffsetX},set:function(t){this.Tn.shadowOffsetX=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowOffsetY",{get:function(){return this.Tn.shadowOffsetY},set:function(t){this.Tn.shadowOffsetY=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filter",{get:function(){return this.Tn.filter},set:function(t){this.Tn.filter=t},enumerable:!0,configurable:!0}),t.prototype.clearRect=function(t,i,e,s){this.Tn.clearRect(t*this.Ln,i*this.Ln,e*this.Ln,s*this.Ln)},t.prototype.fillRect=function(t,i,e,s){this.Tn.fillRect(t*this.Ln,i*this.Ln,e*this.Ln,s*this.Ln)},t.prototype.strokeRect=function(t,i,e,s){this.Tn.strokeRect(t*this.Ln,i*this.Ln,e*this.Ln,s*this.Ln)},t.prototype.beginPath=function(){this.Tn.beginPath()},t.prototype.clip=function(t,i){"nonzero"===t||"evenodd"===t||void 0===t?this.Tn.clip(t):this.Tn.clip(t,i)},t.prototype.fill=function(t,i){"nonzero"===t||"evenodd"===t||void 0===t?this.Tn.fill(t):this.Tn.fill(t,i)},t.prototype.isPointInPath=function(t,i,e,s){return y(t)?this.Tn.isPointInPath(t*this.Ln,i*this.Ln,e):this.Tn.isPointInPath(t,i*this.Ln,e*this.Ln,s)},t.prototype.isPointInStroke=function(t,i,e){return y(t)?this.Tn.isPointInStroke(t*this.Ln,i*this.Ln):this.Tn.isPointInStroke(t,i*this.Ln,e*this.Ln)},t.prototype.stroke=function(t){void 0!==t?this.Tn.stroke(t):this.Tn.stroke()},t.prototype.drawFocusIfNeeded=function(t,i){void 0!==i?this.Tn.drawFocusIfNeeded(t,i):this.Tn.drawFocusIfNeeded(t)},t.prototype.scrollPathIntoView=function(t){void 0!==t?this.Tn.scrollPathIntoView(t):this.Tn.scrollPathIntoView()},t.prototype.fillText=function(t,i,e,s){var n=this;1!==this.Ln&&(this.font=this.font.replace(wi,(function(t,i,e){return i*n.Ln+e}))),void 0===s?this.Tn.fillText(t,i*this.Ln,e*this.Ln):this.Tn.fillText(t,i*this.Ln,e*this.Ln,s*this.Ln),-1!==this.Ln&&(this.font=this.font.replace(wi,(function(t,i,e){return i/n.Ln+e})))},t.prototype.measureText=function(t){return this.Tn.measureText(t)},t.prototype.strokeText=function(t,i,e,s){var n=this;1!==this.Ln&&(this.font=this.font.replace(wi,(function(t,i,e){return i*n.Ln+e}))),void 0===s?this.Tn.strokeText(t,i*this.Ln,e*this.Ln):this.Tn.strokeText(t,i*this.Ln,e*this.Ln,s*this.Ln),1!==this.Ln&&(this.font=this.font.replace(wi,(function(t,i,e){return i/n.Ln+e})))},t.prototype.drawImage=function(t,i,e,s,n,r,u,o,h){return t instanceof HTMLCanvasElement?this.Bn(t,i,e,s,n,r,u,o,h):this.zn(t,i,e,s,n,r,u,o,h)},t.prototype.createImageData=function(t,i){return y(t)?this.Tn.createImageData(t,i):this.Tn.createImageData(t)},t.prototype.getImageData=function(t,i,e,s){return this.Tn.getImageData(t,i,e,s)},t.prototype.putImageData=function(t,i,e,s,n,r,u){void 0===s?this.Tn.putImageData(t,i,e):this.Tn.putImageData(t,i,e,s,n,r,u)},Object.defineProperty(t.prototype,"lineCap",{get:function(){return this.Tn.lineCap},set:function(t){this.Tn.lineCap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineDashOffset",{get:function(){return this.Tn.lineDashOffset},set:function(t){this.Tn.lineDashOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this.Tn.lineJoin},set:function(t){this.Tn.lineJoin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this.Tn.lineWidth},set:function(t){this.Tn.lineWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this.Tn.miterLimit},set:function(t){this.Tn.miterLimit=t},enumerable:!0,configurable:!0}),t.prototype.getLineDash=function(){return this.Tn.getLineDash()},t.prototype.setLineDash=function(t){this.Tn.setLineDash(t)},Object.defineProperty(t.prototype,"direction",{get:function(){return this.Tn.direction},set:function(t){this.Tn.direction=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this.Tn.font},set:function(t){this.Tn.font=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textAlign",{get:function(){return this.Tn.textAlign},set:function(t){this.Tn.textAlign=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this.Tn.textBaseline},set:function(t){this.Tn.textBaseline=t},enumerable:!0,configurable:!0}),t.prototype.arc=function(t,i,e,s,n,r){this.Tn.arc(t*this.Ln,i*this.Ln,e*this.Ln,s,n,r)},t.prototype.arcTo=function(t,i,e,s,n){this.Tn.arcTo(t*this.Ln,i*this.Ln,e*this.Ln,s*this.Ln,n*this.Ln)},t.prototype.bezierCurveTo=function(t,i,e,s,n,r){this.Tn.bezierCurveTo(t*this.Ln,i*this.Ln,e*this.Ln,s*this.Ln,n*this.Ln,r*this.Ln)},t.prototype.closePath=function(){this.Tn.closePath()},t.prototype.ellipse=function(t,i,e,s,n,r,u,o){this.Tn.ellipse(t,i,e,s,n,r,u,o)},t.prototype.lineTo=function(t,i){this.Tn.lineTo(t*this.Ln,i*this.Ln)},t.prototype.moveTo=function(t,i){this.Tn.moveTo(t*this.Ln,i*this.Ln)},t.prototype.quadraticCurveTo=function(t,i,e,s){this.Tn.quadraticCurveTo(t*this.Ln,i*this.Ln,e*this.Ln,s*this.Ln)},t.prototype.rect=function(t,i,e,s){this.Tn.rect(t*this.Ln,i*this.Ln,e*this.Ln,s*this.Ln)},t.prototype.Vn=function(t,i,e,s,n,r,u,o,h){void 0===s?this.Tn.drawImage(t,i,e):void 0===r?this.Tn.drawImage(t,i,e,s,n):this.Tn.drawImage(t,i,e,s,n,r,u,o,h)},t.prototype.zn=function(t,i,e,s,n,r,u,o,h){this.Vn(t,i*this.Ln,e*this.Ln,void 0===s?s:s*this.Ln,void 0===n?n:n*this.Ln,void 0===r?r:r*this.Ln,void 0===u?u:u*this.Ln,void 0===o?o:o*this.Ln,void 0===h?h:h*this.Ln)},t.prototype.Bn=function(t,i,e,s,n,r,u,o,h){void 0!==r&&("width"in t&&(s=Math.min(t.width,Math.max(1,s))),"height"in t&&(n=Math.min(t.height,Math.max(1,n)))),this.Vn(t,i*this.Ln,e*this.Ln,void 0===s?s:s*this.Ln,void 0===n?n:n*this.Ln,void 0===r?r:r*this.Ln,void 0===u?u:u*this.Ln,void 0===o?o:o*this.Ln,void 0===h?h:h*this.Ln)},t}(),Pi="'Trebuchet MS', Roboto, Ubuntu, sans-serif";function ki(t,i,e){return void 0!==e?e+=" ":e="",void 0===i&&(i=Pi),""+e+t+"px "+i}!function(t){t[t.BorderSize=1]="BorderSize",t[t.TickLength=4]="TickLength",t[t.OffsetSize=1]="OffsetSize"}(Ci||(Ci={}));var Ei,Vi=function(){function t(t){this.Ht={borderSize:1,tickLength:4,offsetSize:1,fontSize:NaN,font:"",fontFamily:"",color:"",paddingBottom:0,paddingInner:0,paddingOuter:0,paddingTop:0,baselineOffset:0},this.l=t}return t.prototype.options=function(){var t=this.Ht,i=this.Jt(),e=this.Fn();return t.fontSize===i&&t.fontFamily===e||(t.fontSize=i,t.fontFamily=e,t.font=ki(i,e),t.paddingTop=Math.floor(i/3.5),t.paddingBottom=t.paddingTop,t.paddingInner=Math.max(Math.ceil(i/2-t.tickLength/2),0),t.paddingOuter=Math.ceil(i/2+t.tickLength/2),t.baselineOffset=Math.round(i/5)),t.color=this.jn(),this.Ht},t.prototype.jn=function(){return this.l.options().layout.textColor},t.prototype.Jt=function(){return this.l.options().layout.fontSize},t.prototype.Fn=function(){return this.l.options().layout.fontFamily},t}(),Ri=function(){function t(){this.g=null}return t.prototype.setData=function(t){this.g=t},t.prototype.draw=function(t){if(null!==this.g){if(t.lineWidth=1,this.g.vertLinesVisible){t.strokeStyle=this.g.vertLinesColor,s(t,this.g.vertLineStyle),t.beginPath();for(var i=0,e=this.g.timeMarks;i<e.length;i++){var n=e[i];t.moveTo(n.coord+1,0),t.lineTo(n.coord+1,this.g.h)}t.stroke()}if(this.g.horzLinesVisible){t.strokeStyle=this.g.horzLinesColor,s(t,this.g.horzLineStyle),t.beginPath();for(var r=0,u=this.g.priceMarks;r<u.length;r++){var o=u[r];t.moveTo(0,o.coord),t.lineTo(this.g.w,o.coord)}t.stroke()}}},t}(),Di=function(){function t(t){this.p=new Ri,this.o=!0,this.j=t}return t.prototype.update=function(){this.o=!0},t.prototype.renderer=function(t,i){if(this.o){var e=this.j.model().options().grid,s={h:t,w:i,horzLinesVisible:e.horzLines.visible,vertLinesVisible:e.vertLines.visible,horzLinesColor:e.horzLines.color,vertLinesColor:e.vertLines.color,horzLineStyle:e.horzLines.style,vertLineStyle:e.vertLines.style,priceMarks:this.j.defaultPriceScale().marks(),timeMarks:this.j.model().timeScale().marks()||[]};this.p.setData(s),this.o=!1}return this.p},t}(),_i=function(){function t(){this.In=new WeakMap,this.o=!0}return t.prototype.paneViews=function(t){var i=this.In.get(t);return void 0===i&&(i=[new Di(t)],this.In.set(t,i)),this.o&&(i.forEach((function(t){return t.update()})),this.o=!1),i},t.prototype.invalidate=function(){this.o=!0},t}();!function(t){t[t.None=0]="None",t[t.Cursor=1]="Cursor",t[t.Light=2]="Light",t[t.Full=3]="Full"}(Ei||(Ei={}));var Ai=function(){function t(t){this.Pn=new Map,this.Wn=!1,this.Rn=!1,this.qn=null,this.Un=t}return t.prototype.invalidatePane=function(t,i){var e=function(t,i){return void 0===t?i:{level:Math.max(t.level,i.level),autoScale:t.autoScale||i.autoScale}}(this.Pn.get(t),i);this.Pn.set(t,e)},t.prototype.invalidateAll=function(t){this.Un=Math.max(this.Un,t)},t.prototype.fullInvalidation=function(){return this.Un},t.prototype.invalidateForPane=function(t){var i=this.Pn.get(t);return void 0===i?{level:this.Un}:{level:Math.max(this.Un,i.level),autoScale:i.autoScale}},t.prototype.setFitContent=function(){this.Rn=!0,this.qn=null},t.prototype.getFitContent=function(){return this.Rn},t.prototype.setTargetTimeRange=function(t){this.qn=t,this.Rn=!1},t.prototype.getTargetTimeRange=function(){return this.qn},t.prototype.merge=function(t){var i=this;this.Wn=this.Wn||t.Wn,t.Rn&&this.setFitContent(),t.qn&&this.setTargetTimeRange(t.qn),this.Un=Math.max(this.Un,t.Un),t.Pn.forEach((function(t,e){i.invalidatePane(e,t)}))},t}(),zi=function(){function t(t){this.$=t}return t.prototype.align=function(t,i,e){var s=t;if(0===this.$.mode)return s;var n=e.defaultPriceScale(),r=n.firstValue();if(null===r)return s;var u=n.priceToCoordinate(t,r),o=e.dataSources().filter((function(t){return t instanceof fi})).reduce((function(t,s){if(e.isOverlay(s))return t;var n=s.priceScale(),r=s.bars();if(n.isEmpty()||!r.contains(i))return t;var u=r.valueAt(i);if(null===u)return t;var o=[u.value[3]],h=a(s.firstValue());return t.concat(o.map((function(t){return n.priceToCoordinate(t,h.value,!0)})))}),[]);if(0===o.length)return s;o.sort((function(t,i){return Math.abs(t-u)-Math.abs(i-u)}));var h=o[0];return n.coordinateToPrice(h,r)},t}(),Ii=1e3,Oi=function(){function t(t,i){this.fn=[],this.Hn=[],this.Qi=0,this.Kt=0,this.Yn=Ii,this.Kn=null,this.an=null,this.$n=new Q,this.Xn=t,this.V=i,this.model().mainPriceScaleOptionsChanged().subscribe(this.onPriceScaleOptionsChanged.bind(this),this),this._n=this.Jn()}return t.prototype.onPriceScaleOptionsChanged=function(){this._n.applyOptions(this.V.options().priceScale)},t.prototype.destroy=function(){this.model().mainPriceScaleOptionsChanged().unsubscribeAll(this),this.Xn.barSpacingChanged().unsubscribeAll(this),this._n.modeChanged().unsubscribeAll(this),this.fn.forEach((function(t){t.destroy&&t.destroy()})),this.$n.fire()},t.prototype.stretchFactor=function(){return this.Yn},t.prototype.setStretchFactor=function(t){this.Yn=t},t.prototype.model=function(){return this.V},t.prototype.width=function(){return this.Kt},t.prototype.height=function(){return this.Qi},t.prototype.setWidth=function(t){this.Kt=t,this.updateAllViews()},t.prototype.setHeight=function(t){var i=this;this.Qi=t,this._n.setHeight(t),this.fn.forEach((function(e){if(i.isOverlay(e)){var s=e.priceScale();null!==s&&s.setHeight(t)}})),this.updateAllViews()},t.prototype.dataSources=function(){return this.fn},t.prototype.isOverlay=function(t){var i=t.priceScale();return null===i||this._n!==i},t.prototype.addDataSource=function(t,i,e){var s=this.Zn().minZOrder-1;this.Qn(t,i,s)},t.prototype.removeDataSource=function(t){var i=this.fn.indexOf(t);c(-1!==i,"removeDataSource: invalid data source"),this.fn.splice(i,1),t===this.Kn&&(this.Kn=null);var e=this.Hn.indexOf(t);-1!==e&&this.Hn.splice(e,1);var s=t.priceScale();if(s&&s.dataSources().indexOf(t)>=0&&s.removeDataSource(t),s&&null===s.mainSource()){var n=s.dataSources().length;c(0===n,"Invalid priceScale state: empty mainSource but non-empty data sources="+n),s!==this._n&&s.modeChanged().unsubscribeAll(this)}t instanceof G&&this.Gn(),s&&t instanceof G&&(s.invalidateSourcesCache(),this.recalculatePriceScale(s)),this.an=null},t.prototype.priceScalePosition=function(){var t=this.V.options().priceScale.position;return"none"===t?"overlay":t},t.prototype.startScalePrice=function(t,i){t.startScale(i)},t.prototype.scalePriceTo=function(t,i){t.scaleTo(i),this.updateAllViews()},t.prototype.endScalePrice=function(t){t.endScale()},t.prototype.startScrollPrice=function(t,i){t.startScroll(i)},t.prototype.scrollPriceTo=function(t,i){t.scrollTo(i),this.updateAllViews()},t.prototype.endScrollPrice=function(t){t.endScroll()},t.prototype.setPriceAutoScale=function(t,i){t.setMode({autoScale:i}),this.Xn.isEmpty()?t.setPriceRange(null):this.recalculatePriceScale(t)},t.prototype.updateAllViews=function(){this.fn.forEach((function(t){t.updateAllViews()}))},t.prototype.defaultPriceScale=function(){var t=this.mainDataSource(),i=null!==t?t.priceScale():null;return null===i&&(i=this._n),i},t.prototype.mainDataSource=function(){return this.Kn},t.prototype.recalculatePriceScale=function(t){null!==t&&t.isAutoScale()&&this.ts(t)},t.prototype.resetPriceScale=function(t){var i=this.Xn.visibleBars();t.setMode({autoScale:!0}),null!==i&&t.recalculatePriceRange(i),this.updateAllViews()},t.prototype.momentaryAutoScale=function(){this.ts(this._n)},t.prototype.recalculate=function(){var t=this;this.recalculatePriceScale(this._n),this.fn.forEach((function(i){t.isOverlay(i)&&t.recalculatePriceScale(i.priceScale())})),this.updateAllViews(),this.V.updatePane(this)},t.prototype.isEmpty=function(){return null===this.Kn},t.prototype.containsSeries=function(){return this.fn.some((function(t){return t instanceof fi}))},t.prototype.orderedSources=function(){return null===this.an&&(this.an=di(this.fn)),this.an},t.prototype.onDestroyed=function(){return this.$n},t.prototype.ns=function(t,i){return"overlay"!==i?this._n:this.Jn()},t.prototype.ts=function(t){var i=t.sourcesForAutoScale();if(i&&i.length>0&&!this.Xn.isEmpty()){var e=this.Xn.visibleBars();null!==e&&t.recalculatePriceRange(e)}t.updateAllViews()},t.prototype.Zn=function(){var t=this.orderedSources();if(0===t.length)return{minZOrder:0,maxZOrder:0};for(var i=0,e=0,s=0;s<t.length;s++){var n=t[s].zorder();null!==n&&(n<i&&(i=n),n>e&&(e=n))}return{minZOrder:i,maxZOrder:e}},t.prototype.Qn=function(t,i,e){var s="overlay",n=null;if(!i){var r=this.model().options().priceScale.position;s="none"===r?"overlay":r}t instanceof G&&(n=this.ns(t,s)),this.fn.push(t),i&&this.Hn.push(t),null!==n&&(n.addDataSource(t),t.setPriceScale(n)),t.setZorder(e),this.Gn(),t instanceof G&&this.recalculatePriceScale(n),this.an=null},t.prototype.ss=function(t,i,e){i.mode!==e.mode&&this.ts(t)},t.prototype.Gn=function(){if(null===this.Kn||-1!==this.Hn.indexOf(this.Kn)){for(var t=0,i=this.fn;t<i.length;t++)if((n=i[t])instanceof G&&!this.isOverlay(n))return void this.hs(n);for(var e=0,s=this.Hn;e<s.length;e++){var n;if((n=s[e])instanceof G)return void this.hs(n)}}},t.prototype.hs=function(t){var i=d(t.priceScale());this.defaultPriceScale().modeChanged().unsubscribeAll(this),i.modeChanged().subscribe(this.ss.bind(this,i),this),this.Kn=t},t.prototype.Jn=function(){var t=new mi(b(this.V.options().priceScale),this.V.options().layout,this.V.options().localization);return t.setHeight(this.height()),t},t}(),Ni=function(t){return t.getUTCFullYear()},Fi=function(t){return H(function(t){return t.getUTCDate()}(t),2)},Bi=function(t){return H(function(t){return t.getUTCMonth()+1}(t),2)},ji=function(t){return H(Ni(t)%100,2)},$i=function(t){return H(Ni(t),4)},Ui={"dd MMM 'yy":function(t,i){return Fi(t)+" "+function(t,i){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"short"})}(t,i)+" '"+ji(t)},"yyyy-MM-dd":function(t,i){return $i(t)+"-"+Bi(t)+"-"+Fi(t)},"yy-MM-dd":function(t,i){return ji(t)+"-"+Bi(t)+"-"+Fi(t)},"yy/MM/dd":function(t,i){return ji(t)+"/"+Bi(t)+"/"+Fi(t)},"yyyy/MM/dd":function(t,i){return $i(t)+"/"+Bi(t)+"/"+Fi(t)},"dd-MM-yyyy":function(t,i){return Fi(t)+"-"+Bi(t)+"-"+$i(t)},"dd-MM-yy":function(t,i){return Fi(t)+"-"+Bi(t)+"-"+ji(t)},"dd/MM/yy":function(t,i){return Fi(t)+"/"+Bi(t)+"/"+ji(t)},"dd/MM/yyyy":function(t,i){return Fi(t)+"/"+Bi(t)+"/"+$i(t)},"MM/dd/yy":function(t,i){return Bi(t)+"/"+Fi(t)+"/"+ji(t)},"MM/dd/yyyy":function(t,i){return Bi(t)+"/"+Fi(t)+"/"+$i(t)}},Wi=function(){function t(t,i){void 0===t&&(t="yyyy-MM-dd"),void 0===i&&(i="default"),this.rs=Ui[t],this.us=i}return t.prototype.format=function(t){return this.rs(t,this.us)},t}(),Xi=function(){function t(t){this.es=t||"%h:%m:%s"}return t.prototype.format=function(t){return this.es.replace("%h",H(t.getUTCHours(),2)).replace("%m",H(t.getUTCMinutes(),2)).replace("%s",H(t.getUTCSeconds(),2))},t}(),Hi={dateFormat:"yyyy-MM-dd",timeFormat:"%h:%m:%s",dateTimeSeparator:" ",locale:"default"},Yi=function(){function t(t){void 0===t&&(t={});var i=u({},Hi,t);this.os=new Wi(i.dateFormat,i.locale),this.fs=new Xi(i.timeFormat),this.as=i.dateTimeSeparator}return t.prototype.format=function(t){return""+this.os.format(t)+this.as+this.fs.format(t)},t}(),Ki=function(){function t(t,i){c(t<=i,"The last bar in the bars range should be greater than or equal to the first bar"),this.cs=t,this.ls=i}return t.prototype.firstBar=function(){return this.cs},t.prototype.lastBar=function(){return this.ls},t.prototype.count=function(){return this.ls-this.cs+1},t.prototype.contains=function(t){return this.cs<=t&&t<=this.ls},t.prototype.equals=function(t){return this.cs===t.firstBar()&&this.ls===t.lastBar()},t}(),qi=function(){function t(t,i){void 0===i&&(i=50),this.jt=0,this.It=1,this.Pt=1,this.Rt=new Map,this.Wt=new Map,this.vs=t,this.qt=i}return t.prototype.format=function(t){var i=this.Rt.get(t.valueOf());if(void 0!==i)return i.string;if(this.jt===this.qt){var e=this.Wt.get(this.Pt);this.Wt.delete(this.Pt),this.Rt.delete(f(e)),this.Pt++,this.jt--}var s=this.vs(t);return this.Rt.set(t.valueOf(),{string:s,tick:this.It}),this.Wt.set(this.It,t.valueOf()),this.jt++,this.It++,s},t}();function Ji(t,i){return t.index-i.index}var Qi,Gi,Zi=function(){function t(){this.ds=1/0,this.ws=-1/0,this.bs=new Map,this.ms=[],this.gs=new Q,this.Rt=null,this.Ms=NaN}return t.prototype.reset=function(){this.bs.clear(),this.ms=[],this.ds=1/0,this.ws=-1/0,this.Rt=null,this.gs.fire()},t.prototype.merge=function(t){for(var i=this.ms,e={},s=0,n=t;s<n.length;s++){var r=n[s],u=r.index,o=r.span,h=this.bs.get(r.index);if(h){if(h.index===r.index&&h.span===r.span){h.time=r.time;continue}this.ps(h)}this.bs.set(u,r),this.ds>u&&(this.ds=u),this.ws<u&&(this.ws=u),void 0===(l=i[o])&&(l=[],i[o]=l),l.push(r),e[o]=!0}for(o=i.length;o--;){var l;void 0!==(l=i[o])&&(0===l.length&&delete i[o],e[o]&&l.sort(Ji))}this.Rt=null,this.gs.fire()},t.prototype.indexToTime=function(t){var i=this.bs.get(t);return void 0===i?null:i.time},t.prototype.nearestIndex=function(t){for(var i=this.ds,e=this.ws;e-i>2;){if(1e3*f(this.bs.get(i)).time.timestamp===t)return i;if(1e3*f(this.bs.get(e)).time.timestamp===t)return e;var s=Math.round((i+e)/2);1e3*f(this.bs.get(s)).time.timestamp>t?e=s:i=s}return i},t.prototype.build=function(t,i){var e=Math.ceil(i/t);if(this.Ms===e&&this.Rt)return this.Rt;this.Ms=e;for(var s=[],n=this.ms.length;n--;)if(this.ms[n]){var r=s;s=[];for(var u=r.length,o=0,h=f(this.ms[n]),a=h.length,l=1/0,c=-1/0,d=0;d<a;d++){for(var v=h[d],y=v.index;o<u;){var b=r[o],m=b.index;if(!(m<y)){l=m;break}o++,s.push(b),c=m,l=1/0}l-y>=e&&y-c>=e&&(s.push(v),c=y)}for(;o<u;o++)s.push(r[o])}return this.Rt=s,this.Rt},t.prototype.ps=function(t){var i=t.index;if(this.bs.get(i)===t){this.bs.delete(i),i<=this.ds&&this.ds++,i>=this.ws&&this.ws--,this.ws<this.ds&&(this.ds=1/0,this.ws=-1/0);var e=f(this.ms[t.span]),s=e.indexOf(t);-1!==s&&e.splice(s,1)}},t}(),te=function(){function t(){this.ai=[]}return t.prototype.clear=function(){this.ai=[]},t.prototype.size=function(){return this.ai.length},t.prototype.firstIndex=function(){return this.ys(0)},t.prototype.lastIndex=function(){return this.ys(this.ai.length-1)},t.prototype.merge=function(t,i){if(0!==i.length)if(0!==this.ai.length){var e=t;if(e<0){var s=Math.abs(e);if(i.length<s)return;this.ai=new Array(s).concat(this.ai);for(var n=0;n<i.length;++n)this.ai[t+n]=i[n]}else{for(var r=e;r<this.ai.length&&r-e<i.length;++r)this.ai[r]=i[r-e];var u=e+i.length;if(u>this.ai.length){s=u-this.ai.length;for(var o=r;o<r+s;++o)this.ai.push(i[o-e])}}}else this.ai=i},t.prototype.valueAt=function(t){var i=this.ks(t);return null!==i?this.ai[i]:null},t.prototype.indexOf=function(t,i){if(this.ai.length<1)return null;if(t>this.ai[this.ai.length-1].timestamp)return i?this.ai.length-1:null;for(var e=0;e<this.ai.length;++e){if(t===this.ai[e].timestamp)return e;if(t<this.ai[e].timestamp)return i?e:null}return null},t.prototype.closestIndexLeft=function(t){var i=this.ai;if(!i.length)return null;if(Number.isNaN(t.timestamp))return null;var e=i.length-1;if(t>=i[e])return e;var s=0,n=i[s];if(t<n)return null;if(t===n)return s;for(;e>s+1;){var r=s+e>>1,u=i[r];if(u.timestamp>t.timestamp)e=r;else{if(!(u.timestamp<t.timestamp))return u.timestamp===t.timestamp?r:null;s=r}}return s},t.prototype.ys=function(t){return 0<=t&&t<this.size()?t:null},t.prototype.ks=function(t){return 0<=t&&t<this.size()?t:null},t}();!function(t){t[t.DefaultAnimationDuration=400]="DefaultAnimationDuration",t[t.MaxBarSpacing=50]="MaxBarSpacing",t[t.MinBarSpacing=.5]="MinBarSpacing",t[t.MinVisibleBarsCount=5]="MinVisibleBarsCount"}(Qi||(Qi={})),function(t){t[t.Minute=20]="Minute",t[t.Hour=30]="Hour",t[t.Day=40]="Day",t[t.Week=50]="Week",t[t.Month=60]="Month",t[t.Year=70]="Year"}(Gi||(Gi={}));var ie=function(){function t(t,i,e){this.Kt=0,this.Ns=null,this.Ss=new te,this.xs=new Q,this.wn=null,this.dn=null,this.Cs=new Zi,this.Ds=new Map,this.Es=null,this.Os=!0,this.As=new Q,this.Ts=new Q,this.Ls=null,this.Bs=null,this.zs=null,this.Vs=[],this.$=i,this.gn=e,this.Fs=i.rightOffset,this.js=ee(i.barSpacing),this.V=t,this.Is()}return t.prototype.options=function(){return this.$},t.prototype.applyLocalizationOptions=function(t){v(this.gn,t),this.Ps(),this.Is()},t.prototype.applyOptions=function(t,i){v(this.$,t),this.$.fixLeftEdge?this.Ws():this.Ls=null,void 0!==t.rightOffset&&this.setRightOffset(t.rightOffset),void 0!==t.barSpacing&&this.setBarSpacing(t.barSpacing),this.Ps(),this.Is(),this.Ts.fire()},t.prototype.isEmpty=function(){return 0===this.Kt||0===this.Ss.size()},t.prototype.visibleBars=function(){return this.Os&&(this.Os=!1,this.Rs()),this.Es},t.prototype.tickMarks=function(){return this.Cs},t.prototype.points=function(){return this.Ss},t.prototype.width=function(){return this.Kt},t.prototype.setWidth=function(t){if(isFinite(t)&&!(t<=0)&&this.Kt!==t){if(this.$.lockVisibleTimeRangeOnResize&&this.Kt){var i=this.js*t/this.Kt;this.qs(i)}if(null!==this.Ls&&d(this.visibleBars()).firstBar()<=this.Ls){var e=this.Kt-t;this.Fs-=Math.round(e/this.js)+1}this.Kt=t,this.Os=!0,this.Us()}},t.prototype.indexToCoordinate=function(t,i){if(this.isEmpty()||!m(t))return 0;var e=this.baseIndex()+this.Fs-t,s=this.Kt-(e+.5)*this.js;return i?s:Math.round(s)},t.prototype.indexesToCoordinates=function(t,i){for(var e=this.baseIndex(),s=void 0===i?0:i.from,n=void 0===i?t.length:i.to,r=s;r<n;r++){var u=t[r].time,o=e+this.Fs-u,h=this.Kt-(o+.5)*this.js;t[r].x=Math.round(h)}},t.prototype.indexToUserTime=function(t){return this.Cs.indexToTime(t)},t.prototype.coordinateToIndex=function(t){return Math.ceil(this.Hs(t))},t.prototype.setRightOffset=function(t){this.Os=!0,this.Fs=t,this.Us(),this.V.recalculateAllPanes(),this.V.lightUpdate()},t.prototype.barSpacing=function(){return this.js},t.prototype.setBarSpacing=function(t){this.qs(t),this.Us()},t.prototype.barSpacingChanged=function(){return this.xs},t.prototype.rightOffset=function(){return this.Fs},t.prototype.marks=function(){if(this.isEmpty())return null;if(null!==this.zs)return this.zs;for(var t=this.js,i=5*(this.V.options().layout.fontSize+4),e=Math.round(i/t),s=d(this.visibleBars()),n=Math.max(s.firstBar(),s.firstBar()-e),r=Math.max(s.lastBar(),s.lastBar()-e),u=0,o=0,h=this.Cs.build(t,i);o<h.length;o++){var a=h[o];if(n<=a.index&&a.index<=r){var l=this.Cs.indexToTime(a.index);if(null!==l){if(u<this.Vs.length){var c=this.Vs[u];c.coord=this.indexToCoordinate(a.index),c.label=this.Ys(l,a.span),c.span=a.span,c.major=!1}else this.Vs.push({coord:this.indexToCoordinate(a.index),label:this.Ys(l,a.span),span:a.span,major:!1});u++}}}return this.Vs.length=u,this.zs=this.Vs,this.Vs},t.prototype.reset=function(){this.Os=!0,this.Ss=new te,this.wn=null,this.dn=null,this.Ks(),this.Cs.reset(),this.Ls=null},t.prototype.restoreDefault=function(){this.Os=!0,this.setBarSpacing(this.$.barSpacing),this.setRightOffset(this.$.rightOffset)},t.prototype.fixLeftEdge=function(){return this.$.fixLeftEdge},t.prototype.setBaseIndex=function(t){this.Os=!0,this.Ns=t,this.Us(),this.Ws()},t.prototype.zoom=function(t,i){var e=this.Hs(t),s=this.barSpacing(),n=s+i*(s/10);this.setBarSpacing(n),this.$.rightBarStaysOnScroll||this.setRightOffset(this.rightOffset()+(e-this.Hs(t)))},t.prototype.startScale=function(t){this.wn&&this.endScroll(),null===this.dn&&null===this.Bs&&(this.isEmpty()||(this.dn=t,this.$s()))},t.prototype.scaleTo=function(t){if(null!==this.Bs){var i=tt(this.Kt-t,0,this.Kt),e=tt(this.Kt-d(this.dn),0,this.Kt);0!==i&&0!==e&&this.setBarSpacing(this.Bs.barSpacing*i/e)}},t.prototype.endScale=function(){null!==this.dn&&(this.dn=null,this.Ks())},t.prototype.startScroll=function(t){null===this.wn&&null===this.Bs&&(this.isEmpty()||(this.wn=t,this.$s()))},t.prototype.scrollTo=function(t){if(this.Os=!0,null!==this.wn){var i=(this.wn-t)/this.barSpacing();this.Fs=d(this.Bs).rightOffset+i,this.Os=!0,this.Us()}},t.prototype.endScroll=function(){null!==this.wn&&(this.wn=null,this.Ks())},t.prototype.scrollToRealTime=function(){this.scrollToOffsetAnimated(this.$.rightOffset)},t.prototype.scrollToOffsetAnimated=function(t,i){var e=this;if(void 0===i&&(i=400),!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(i)||i<=0)throw new RangeError("animationDuration (optional) must be finite positive number");var s=this.Fs,n=(new Date).getTime(),r=function(){var u=((new Date).getTime()-n)/i,o=u>=1,h=o?t:s+(t-s)*u;e.setRightOffset(h),o||setTimeout(r,20)};r()},t.prototype.update=function(t,i,e){if(this.Os=!0,i.length>0){var s=this.Ss.size();this.Ss.merge(t,i),this.Fs<0&&this.Ss.size()===s+1&&(this.Fs-=1,this.Os=!0)}this.Cs.merge(e),this.Us()},t.prototype.visibleBarsChanged=function(){return this.As},t.prototype.optionsApplied=function(){return this.Ts},t.prototype.baseIndex=function(){return this.Ns||0},t.prototype.setVisibleRange=function(t){var i=t.count();this.qs(this.Kt/i),this.Fs=t.lastBar()-this.baseIndex(),this.Us(),this.Os=!0,this.V.recalculateAllPanes(),this.V.lightUpdate()},t.prototype.fitContent=function(){var t=this.Ss.firstIndex(),i=this.Ss.lastIndex();null!==t&&null!==i&&this.setVisibleRange(new Ki(t-1,i+1+this.$.rightOffset))},t.prototype.setTimePointsRange=function(t){var i=this.points(),e=i.firstIndex(),s=i.lastIndex();if(null!==e&&null!==s){var n=d(i.valueAt(e)).timestamp,r=d(i.valueAt(s)).timestamp,u=new Ki(d(i.indexOf(Math.max(n,t.from.timestamp),!0)),d(i.indexOf(Math.min(r,t.to.timestamp),!0)));this.setVisibleRange(u)}},t.prototype.formatDateTime=function(t){return void 0!==this.gn.timeFormatter?this.gn.timeFormatter(t.businessDay||t.timestamp):this.Xs.format(new Date(1e3*t.timestamp))},t.prototype._s=function(t){return(this.Kt+1-t)/this.js},t.prototype.Hs=function(t){var i=this._s(t),e=this.baseIndex()+this.Fs-i;return Math.round(1e6*e)/1e6},t.prototype.qs=function(t){t=ee(t);var i=this.js;i!==t&&(this.Os=!0,this.js=t,this.xs.fire(i,t),this.Js())},t.prototype.Rs=function(){if(this.isEmpty())this.Zs(null);else{var t=this.baseIndex(),i=Math.ceil(this.Kt/this.js)-1,e=Math.round(this.Fs+t),s=e-i;this.Zs(new Ki(s,e))}},t.prototype.Us=function(){var t=this.Qs();this.Fs>t&&(this.Fs=t,this.Os=!0);var i=this.Gs();null!==i&&this.Fs<i&&(this.Fs=i,this.Os=!0)},t.prototype.Gs=function(){var t=this.Ss.firstIndex(),i=this.Ns;if(null===t||null===i)return null;if(null!==this.Ls){var e=this.Kt/this.js;return this.Ls-i+e-1}return t-i-1+5},t.prototype.Qs=function(){return this.Kt/this.js-5},t.prototype.$s=function(){this.Bs={barSpacing:this.barSpacing(),rightOffset:this.rightOffset()}},t.prototype.Ks=function(){this.Bs=null},t.prototype.Ys=function(t,i){var e=this,s=this.Ds.get(i);return void 0===s&&(s=new qi((function(t){return e.th(t,i)})),this.Ds.set(i,s)),void 0===t.businessDay?s.format(new Date(1e3*t.timestamp)):s.format(new Date(Date.UTC(t.businessDay.year,t.businessDay.month-1,t.businessDay.day)))},t.prototype.th=function(t,i){var e={},s=this.$.timeVisible;return i<20&&s?(e.hour12=!1,e.hour="2-digit",e.minute="2-digit",this.$.secondsVisible&&(e.second="2-digit")):i<40&&s?(e.hour12=!1,e.hour="2-digit",e.minute="2-digit"):i<50?e.day="numeric":i<60?e.day="numeric":i<70?e.month="short":e.year="numeric",new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()).toLocaleString(this.gn.locale,e)},t.prototype.Zs=function(t){if(null!==t||null!==this.Es){var i=this.Es;this.Es=t,(null===this.Es||null!==i&&!this.Es.equals(i))&&this.As.fire(),this.Js()}},t.prototype.Js=function(){this.zs=null},t.prototype.Ps=function(){this.Js(),this.Ds.clear()},t.prototype.Is=function(){var t=this.gn.dateFormat;this.$.timeVisible?this.Xs=new Yi({dateFormat:t,timeFormat:this.$.secondsVisible?"%h:%m:%s":"%h:%m",dateTimeSeparator:"   ",locale:this.gn.locale}):this.Xs=new Wi(t,this.gn.locale)},t.prototype.Ws=function(){if(this.$.fixLeftEdge){var t=this.Ss.firstIndex();if(null!==t&&this.Ls!==t){this.Ls=t;var i=d(this.visibleBars()).firstBar()-t;if(i<0){var e=this.Fs-i-1;this.setRightOffset(e)}}}},t}();function ee(t){return t<.5?.5:t>50?50:t}var ne=function(){function t(t){this.ih=new Map,this.g=t}return t.prototype.draw=function(t){},t.prototype.drawBackground=function(t){if(this.g.visible){t.save();for(var i=0,e=0,s=this.g.lines;e<s.length;e++)if(0!==(h=s[e]).text.length){t.font=h.font;var n=this.nh(t,h.text);n>this.g.width?h.zoom=this.g.width/n:h.zoom=1,i+=h.lineHeight*h.zoom}var r=0;switch(this.g.vertAlign){case"top":r=0;break;case"center":r=Math.max((this.g.height-i)/2,0);break;case"bottom":r=Math.max(this.g.height-i,0)}t.fillStyle=this.g.color;for(var u=0,o=this.g.lines;u<o.length;u++){var h=o[u];t.save();var l=0;switch(this.g.horzAlign){case"left":t.textAlign="left",l=h.lineHeight/2;break;case"center":t.textAlign="center",l=this.g.width/2;break;case"right":t.textAlign="right",l=this.g.width-1-h.lineHeight/2}t.translate(l,r),t.textBaseline="top",t.font=h.font,t.scale(h.zoom,h.zoom),t.fillText(h.text,0,h.vertOffset),t.restore(),r+=h.lineHeight*h.zoom}t.restore()}},t.prototype.nh=function(t,i){var e=this.sh(t.font),s=e.get(i);return void 0===s&&(s=t.measureText(i).width,e.set(i,s)),s},t.prototype.sh=function(t){var i=this.ih.get(t);return void 0===i&&(i=new Map,this.ih.set(t,i)),i},t}(),re=function(){function t(t){this.o=!0,this.M={visible:!1,color:"",height:0,width:0,lines:[],vertAlign:"center",horzAlign:"center"},this.p=new ne(this.M),this.k=t}return t.prototype.update=function(){this.o=!0},t.prototype.renderer=function(t,i){return this.o&&(this.m(t,i),this.o=!1),this.p},t.prototype.m=function(t,i){var e=this.k.options(),s=this.M;s.visible=e.visible,s.visible&&(s.color=e.color,s.width=i,s.height=t,s.horzAlign=e.horzAlign,s.vertAlign=e.vertAlign,s.lines=[{text:e.text,font:ki(e.fontSize),lineHeight:1.2*e.fontSize,vertOffset:0,zoom:0}])},t}(),se=function(t){function i(i,e){var s=t.call(this)||this;return s.$=e,s.Z=new re(s),s}return l(i,t),i.prototype.paneViews=function(){return[this.Z]},i.prototype.options=function(){return this.$},i.prototype.updateAllViews=function(){this.Z.update()},i}(W),oe=function(){function t(t,i){this.hh=[],this.rh=[],this.Kt=0,this.uh=null,this.eh=null,this.oh=new Q,this.fh=new Q,this.ah=t,this.$=i,this.lh=new Vi(this),this.Xn=new ie(this,i.timeScale,this.$.localization),this.vh=new _i,this.v=new X(this,i.crosshair),this.dh=new zi(i.crosshair),this.wh=new se(this,i.watermark),this.createPane(),this.hh[0].setStretchFactor(2*Ii),this.hh[0].addDataSource(this.wh,!0,!1)}return t.prototype.updatePane=function(t){var i=this.bh(t,0);this.mh(i)},t.prototype.fullUpdate=function(){this.mh(new Ai(3))},t.prototype.lightUpdate=function(){this.mh(new Ai(2))},t.prototype.updateSource=function(t){var i=this.gh(t);this.mh(i)},t.prototype.hoveredSource=function(){return this.eh},t.prototype.setHoveredSource=function(t){var i=this.eh;this.eh=t,null!==i&&this.updateSource(i.source),null!==t&&this.updateSource(t.source)},t.prototype.options=function(){return this.$},t.prototype.applyOptions=function(t){v(this.$,t),void 0!==t.priceScale&&(this.mainPriceScale().applyOptions(t.priceScale),this.oh.fire()),void 0!==t.timeScale&&this.Xn.applyOptions(t.timeScale),void 0!==t.localization&&(this.Xn.applyLocalizationOptions(t.localization),this.mainPriceScale().updateFormatter()),this.fullUpdate()},t.prototype.updateAllPaneViews=function(){this.hh.forEach((function(t){return t.updateAllViews()})),this.updateCrosshair()},t.prototype.timeScale=function(){return this.Xn},t.prototype.panes=function(){return this.hh},t.prototype.gridSource=function(){return this.vh},t.prototype.watermarkSource=function(){return this.wh},t.prototype.crosshairSource=function(){return this.v},t.prototype.crosshairMoved=function(){return this.fh},t.prototype.width=function(){return this.Kt},t.prototype.setPaneHeight=function(t,i){t.setHeight(i),this.recalculateAllPanes(),this.lightUpdate()},t.prototype.setWidth=function(t){this.Kt=t,this.Xn.setWidth(this.Kt),this.hh.forEach((function(i){return i.setWidth(t)})),this.recalculateAllPanes()},t.prototype.createPane=function(t){var i=new Oi(this.Xn,this);void 0!==t?this.hh.splice(t,0,i):this.hh.push(i);var e=void 0===t?this.hh.length-1:t,s=new Ai(3);return s.invalidatePane(e,{level:0,autoScale:!0}),this.invalidate(s),i},t.prototype.startScalePrice=function(t,i,e){t.startScalePrice(i,e)},t.prototype.scalePriceTo=function(t,i,e){t.scalePriceTo(i,e),this.updateCrosshair(),this.mh(this.bh(t,2))},t.prototype.endScalePrice=function(t,i){t.endScalePrice(i),this.mh(this.bh(t,2))},t.prototype.startScrollPrice=function(t,i,e){i.isAutoScale()||t.startScrollPrice(i,e)},t.prototype.scrollPriceTo=function(t,i,e){i.isAutoScale()||(t.scrollPriceTo(i,e),this.updateCrosshair(),this.mh(this.bh(t,2)))},t.prototype.endScrollPrice=function(t,i){i.isAutoScale()||(t.endScrollPrice(i),this.mh(this.bh(t,2)))},t.prototype.setPriceAutoScale=function(t,i,e){t.setPriceAutoScale(i,e),this.mh(this.bh(t,2))},t.prototype.resetPriceScale=function(t,i){t.resetPriceScale(i),this.mh(this.bh(t,2))},t.prototype.startScaleTime=function(t){this.Xn.startScale(t)},t.prototype.zoomTime=function(t,i){var e=this.timeScale();if(!e.isEmpty()&&0!==i){var s=e.width();t=Math.max(1,Math.min(t,s)),e.zoom(t,i),this.updateCrosshair(),this.recalculateAllPanes(),this.lightUpdate()}},t.prototype.scrollChart=function(t){this.startScrollTime(0),this.scrollTimeTo(t),this.endScrollTime()},t.prototype.scaleTimeTo=function(t){this.Xn.scaleTo(t),this.recalculateAllPanes(),this.updateCrosshair(),this.lightUpdate()},t.prototype.endScaleTime=function(){this.Xn.endScale(),this.lightUpdate()},t.prototype.startScrollTime=function(t){this.uh=t,this.Xn.startScroll(t)},t.prototype.scrollTimeTo=function(t){var i=!1;return null!==this.uh&&Math.abs(t-this.uh)>20&&(this.uh=null,i=!0),this.Xn.scrollTo(t),this.recalculateAllPanes(),this.updateCrosshair(),this.lightUpdate(),i},t.prototype.endScrollTime=function(){this.Xn.endScroll(),this.lightUpdate(),this.uh=null},t.prototype.resetTimeScale=function(){this.Xn.restoreDefault(),this.recalculateAllPanes(),this.updateCrosshair(),this.lightUpdate()},t.prototype.invalidate=function(t){this.ah&&this.ah(t),this.vh.invalidate(),this.lightUpdate()},t.prototype.dataSources=function(){return this.hh.reduce((function(t,i){return t.concat(i.dataSources())}),[])},t.prototype.serieses=function(){return this.rh},t.prototype.setAndSaveCurrentPosition=function(t,i,e){this.v.saveOriginCoord(t,i);var s=NaN,n=this.Xn.coordinateToIndex(t),r=this.Xn.visibleBars();if(null!==r&&(n=Math.min(Math.max(r.firstBar(),n),r.lastBar())),null!==e.mainDataSource()){var u=e.defaultPriceScale(),o=u.firstValue();null!==o&&(s=u.coordinateToPrice(i,o)),s=this.dh.align(s,n,e)}this.v.setPosition(n,s,e),this.Mh(),this.fh.fire(this.v.appliedIndex(),{x:t,y:i})},t.prototype.clearCurrentPosition=function(){this.crosshairSource().clearPosition(),this.Mh(),this.fh.fire(null,null)},t.prototype.updateCrosshair=function(){var t=this.v.pane();if(null!==t){var i=this.v.originCoordX(),e=this.v.originCoordY();this.setAndSaveCurrentPosition(i,e,t)}},t.prototype.updateTimeScale=function(t,i,e,s){s&&this.Xn.reset(),this.Xn.update(t,i,e)},t.prototype.updateTimeScaleBaseIndex=function(t){var i=this.rh.reduce((function(t,i){var e=i.bars();if(e.isEmpty())return t;var s=d(e.lastIndex());return void 0===t?s:Math.max(s,t)}),void 0);if(void 0!==i){var e=this.Xn,s=e.baseIndex(),n=e.visibleBars();if(null!==n){var r=n.contains(s);if(void 0!==t&&t>0&&!r){var u=i-s;e.setRightOffset(e.rightOffset()-u)}}e.setBaseIndex(i)}this.updateCrosshair(),this.recalculateAllPanes(),this.lightUpdate()},t.prototype.recalculatePane=function(t){null!==t&&t.recalculate()},t.prototype.paneForSource=function(t){var i=this.hh.find((function(i){return i.orderedSources().includes(t)}));return void 0===i?null:i},t.prototype.recalculateAllPanes=function(){this.hh.forEach((function(t){return t.recalculate()})),this.updateAllPaneViews()},t.prototype.destroy=function(){this.hh.forEach((function(t){return t.destroy()})),this.hh.length=0,this.$.localization.priceFormatter=void 0,this.$.localization.timeFormatter=void 0},t.prototype.setPriceAutoScaleForAllMainSources=function(){this.hh.map((function(t){return t.mainDataSource()})).forEach((function(t){null!==t&&d(t.priceScale()).setMode({autoScale:!0})}))},t.prototype.rendererOptionsProvider=function(){return this.lh},t.prototype.priceAxisRendererOptions=function(){return this.lh.options()},t.prototype.mainPriceScaleOptionsChanged=function(){return this.oh},t.prototype.mainPriceScale=function(){return this.hh[0].defaultPriceScale()},t.prototype.createSeries=function(t,i){var e=this.hh[0],s=this.ph(i,t,e);return this.rh.push(s),1===this.rh.length?this.fullUpdate():this.lightUpdate(),s},t.prototype.removeSeries=function(t){var i=this.paneForSource(t),e=this.rh.indexOf(t);c(-1!==e,"Series not found"),this.rh.splice(e,1),d(i).removeDataSource(t),t.destroy&&t.destroy()},t.prototype.fitContent=function(){var t=new Ai(2);t.setFitContent(),this.mh(t)},t.prototype.setTargetTimeRange=function(t){var i=new Ai(2);i.setTargetTimeRange(t),this.mh(i)},t.prototype.bh=function(t,i){var e=new Ai(i);if(null!==t){var s=this.hh.indexOf(t);e.invalidatePane(s,{level:i})}return e},t.prototype.gh=function(t,i){return void 0===i&&(i=2),this.bh(this.paneForSource(t),i)},t.prototype.mh=function(t){this.ah&&this.ah(t),this.vh.invalidate()},t.prototype.Mh=function(){this.mh(new Ai(1))},t.prototype.ph=function(t,i,e){var s=new fi(this,t,i);return e.addDataSource(s,Boolean(t.overlay),!1),t.overlay&&s.applyOptions(t),s},t}(),he=function(){function t(t,i){this.w=t,this.h=i}return t.prototype.equals=function(t){return this.w===t.w&&this.h===t.h},t}();function ae(t,i){t.width=i.w,t.height=i.h;var e=Mi(t);e&&e.translate(.5,.5)}function le(t,i,e,s,n,r){t.save(),t.translate(-.5,-.5),t.globalCompositeOperation="copy",t.fillStyle=r,t.fillRect(i,e,s,n),t.restore()}function ue(t,i){var e=document.createElement("canvas");return t.appendChild(e),ae(e,i),function(t){t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.msUserSelect="none",t.style.MozUserSelect="none",t.style.webkitTapHighlightColor="transparent"}(e),e}var ce,pe=!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints||"ontouchstart"in window||Boolean(window.DocumentTouch&&document instanceof window.DocumentTouch),fe="onorientationchange"in window&&pe,de=/Android/i.test(navigator.userAgent),ve=/iPhone|iPad|iPod|AppleWebKit.+Mobile/i.test(navigator.userAgent),ye=de||ve;!function(t){t[t.ResetClick=500]="ResetClick",t[t.LongTap=240]="LongTap"}(ce||(ce={}));var me=function(){function t(t,i,e){this.yh=0,this.kh=null,this.Nh=null,this.Sh=!1,this.xh=null,this.Ch=!1,this.Dh=!1,this.Eh=null,this.Oh=null,this.Ah=null,this.Th=null,this.Lh=0,this.Bh=!1,this.zh=!1,this.Vh=!1,this.Fh=t,this.jh=i,this.$=e,this.Ih()}return t.prototype.destroy=function(){null!==this.Eh&&(this.Eh(),this.Eh=null),null!==this.Oh&&(this.Oh(),this.Oh=null),null!==this.Ah&&(this.Ah(),this.Ah=null),this.Ph(),this.Wh()},t.prototype.Rh=function(t){var i=this;this.Oh&&this.Oh();var e=this.qh.bind(this);this.Oh=function(){i.Fh.removeEventListener("mousemove",e)},this.Fh.addEventListener("mousemove",e),we(t)&&this.qh(t);var s=this.Uh(t);this.Hh(s,this.jh.mouseEnterEvent)},t.prototype.Wh=function(){null!==this.kh&&clearTimeout(this.kh),this.yh=0,this.kh=null},t.prototype.qh=function(t){if(!this.Vh||we(t)){var i=this.Uh(t);this.Hh(i,this.jh.mouseMoveEvent)}},t.prototype.Yh=function(t){if(!("button"in t&&0!==t.button)&&null===this.Th){var i=we(t);if(!this.zh||!i){this.Bh=!0;var e=this.Uh(t),s=a(this.xh),n=Math.abs(s.x-e.pageX),r=Math.abs(s.y-e.pageY),u=n+r>5;if(u||!i){if(u&&!this.Ch&&i){var o=.5*n,h=r>=o&&!this.$.treatVertTouchDragAsPageScroll,l=o>r&&!this.$.treatHorzTouchDragAsPageScroll;h||l||(this.zh=!0)}u&&(this.Ch=!0,this.Dh=!0,i&&this.Ph()),this.zh||(this.Hh(e,this.jh.pressedMouseMoveEvent),i&&Se(t))}}}},t.prototype.Kh=function(t){if(!("button"in t&&0!==t.button)){var i=this.Uh(t);this.Ph(),this.xh=null,this.Vh=!1,this.Ah&&(this.Ah(),this.Ah=null),we(t)&&this.$h(t),this.Hh(i,this.jh.mouseUpEvent),++this.yh,this.kh&&this.yh>1?(this.Hh(i,this.jh.mouseDoubleClickEvent),this.Wh()):this.Dh||this.Hh(i,this.jh.mouseClickEvent),we(t)&&(Se(t),this.$h(t),0===t.touches.length&&(this.Sh=!1))}},t.prototype.Ph=function(){null!==this.Nh&&(clearTimeout(this.Nh),this.Nh=null)},t.prototype.Xh=function(t){if(!("button"in t&&0!==t.button)){var i=this.Uh(t);this.Dh=!1,this.Ch=!1,this.zh=!1,we(t)&&this.Rh(t),this.xh={x:i.pageX,y:i.pageY},this.Ah&&(this.Ah(),this.Ah=null);var e=this.Yh.bind(this),s=this.Kh.bind(this),n=this.Fh.ownerDocument.documentElement;this.Ah=function(){n.removeEventListener("touchmove",e),n.removeEventListener("touchend",s),n.removeEventListener("mousemove",e),n.removeEventListener("mouseup",s)},n.addEventListener("touchmove",e,{passive:!1}),n.addEventListener("touchend",s,{passive:!1}),this.Ph(),we(t)&&1===t.touches.length?this.Nh=setTimeout(this._h.bind(this,t),240):(n.addEventListener("mousemove",e),n.addEventListener("mouseup",s)),this.Vh=!0,this.Hh(i,this.jh.mouseDownEvent),this.kh||(this.yh=0,this.kh=setTimeout(this.Wh.bind(this),500))}},t.prototype.Ih=function(){var t=this;this.Fh.addEventListener("mouseenter",this.Rh.bind(this)),this.Fh.addEventListener("touchcancel",this.Ph.bind(this));var i=this.Fh.ownerDocument,e=function(i){t.jh.mouseDownOutsideEvent&&(i.target&&t.Fh.contains(i.target)||t.jh.mouseDownOutsideEvent())};this.Eh=function(){i.removeEventListener("mousedown",e),i.removeEventListener("touchstart",e)},i.addEventListener("mousedown",e),i.addEventListener("touchstart",e,{passive:!0}),this.Fh.addEventListener("mouseleave",this.$h.bind(this)),this.Fh.addEventListener("touchstart",this.Xh.bind(this),{passive:!0}),fe||this.Fh.addEventListener("mousedown",this.Xh.bind(this)),this.Jh(),this.Fh.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype.Jh=function(){var t=this;void 0===this.jh.pinchStartEvent&&void 0===this.jh.pinchEvent&&void 0===this.jh.pinchEndEvent||(this.Fh.addEventListener("touchstart",(function(i){return t.Zh(i.touches)}),{passive:!0}),this.Fh.addEventListener("touchmove",(function(i){if(2===i.touches.length&&null!==t.Th&&void 0!==t.jh.pinchEvent){var e=be(i.touches[0],i.touches[1])/t.Lh;t.jh.pinchEvent(t.Th,e),Se(i)}}),{passive:!1}),this.Fh.addEventListener("touchend",(function(i){t.Zh(i.touches)})))},t.prototype.Zh=function(t){1===t.length&&(this.Bh=!1),2!==t.length||this.Bh||this.Sh?this.Qh():this.Gh(t)},t.prototype.Gh=function(t){var i=ge(this.Fh);this.Th={x:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,y:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this.Lh=be(t[0],t[1]),void 0!==this.jh.pinchStartEvent&&this.jh.pinchStartEvent(),this.Ph()},t.prototype.Qh=function(){null!==this.Th&&(this.Th=null,void 0!==this.jh.pinchEndEvent&&this.jh.pinchEndEvent())},t.prototype.$h=function(t){this.Oh&&this.Oh();var i=this.Uh(t);this.Hh(i,this.jh.mouseLeaveEvent)},t.prototype._h=function(t){var i=this.Uh(t);this.Hh(i,this.jh.longTapEvent),this.Dh=!0,this.Sh=!0},t.prototype.Hh=function(t,i){i&&i.call(this.jh,t)},t.prototype.Uh=function(t){var i;i="touches"in t&&t.touches.length?t.touches[0]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0]:t;var e=ge(this.Fh);return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-e.left,localY:i.clientY-e.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,type:t.type.startsWith("mouse")?"mouse":"touch",target:i.target,view:t.view}},t}();function ge(t){return t.getBoundingClientRect()||{left:0,top:0}}function be(t,i){var e=t.clientX-i.clientX,s=t.clientY-i.clientY;return Math.sqrt(e*e+s*s)}function we(t){return Boolean(t.touches)}function Se(t){t.cancelable&&t.preventDefault()}var Te,xe=1,Me=function(){function t(t,i,e,s){if(this.tr=0,this.ir=0,this.nr=0,this.sr=0,this.hr=0,this.rr=0,this.ur=0,this.er=t,this.or=t.paneWidgets()[i],this.ar=t.paneWidgets()[e],this.cr=document.createElement("tr"),this.cr.style.height=xe+"px",this.lr=document.createElement("td"),this.lr.style.padding="0",this.lr.setAttribute("colspan","3"),this.vr(),this.cr.appendChild(this.lr),s)this.dr=null,this.wr=null;else{this.dr=document.createElement("div"),this.dr.style.position="absolute",this.dr.style.zIndex="50",this.dr.style.height="5px",this.dr.style.width="100%",this.dr.style.backgroundColor="rgba(255, 255, 255, 0.02)",this.dr.style.cursor="ns-resize",this.lr.appendChild(this.dr);var n={mouseDownEvent:this.br.bind(this),pressedMouseMoveEvent:this.mr.bind(this),mouseUpEvent:this.gr.bind(this)};this.wr=new me(this.dr,n,{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0})}}return t.prototype.destroy=function(){null!==this.wr&&this.wr.destroy()},t.prototype.getElement=function(){return this.cr},t.prototype.getImage=function(){var t=document.createElement("canvas"),i=this.or.getSize().w,e=xe;ae(t,new he(i,e));var s=d(Mi(t));return s.fillStyle=this.er.options().timeScale.borderColor,s.fillRect(0,0,i,e),t},t.prototype.update=function(){this.vr()},t.prototype.vr=function(){this.lr.style.background=this.er.options().timeScale.borderColor},t.prototype.br=function(t){this.tr=t.pageY,this.ir=0,this.nr=this.or.getSize().h+this.ar.getSize().h,this.sr=this.or.stretchFactor()+this.ar.stretchFactor(),this.hr=30,this.rr=this.nr-this.hr,this.ur=this.sr/this.nr},t.prototype.mr=function(t){this.ir=t.pageY-this.tr;var i=this.or.getSize().h,e=tt(i+this.ir,this.hr,this.rr)*this.ur,s=this.sr-e;this.or.setStretchFactor(e),this.ar.setStretchFactor(s),this.er.adjustSize(),this.or.getSize().h!==i&&(this.tr=t.pageY)},t.prototype.gr=function(t){this.tr=0,this.ir=0,this.nr=0,this.sr=0,this.hr=0,this.rr=0,this.ur=0},t}(),Ce=200,Le=function(){function t(t,i,e,s){this.$t=new It(Ce),this.Jt=0,this.Mr="",this.pr="",this.yr=[],this.kr=new Map,this.Jt=t,this.Mr=i,this.pr=ki(t,e,s)}return t.prototype.destroy=function(){delete this.$t,this.yr=[],this.kr.clear()},t.prototype.paintTo=function(t,i,e,s,n){var r=this.getLabelImage(t,i);"left"!==n&&(e-=r.textWidth),s-=Math.floor(r.height/2),t.drawImage(r.canvas,e,s)},t.prototype.getLabelImage=function(t,i){var e;if(this.kr.has(i))e=f(this.kr.get(i));else{if(this.yr.length>=Ce){var s=f(this.yr.shift());this.kr.delete(s)}e={text:i,textWidth:0,width:0,height:0,canvas:document.createElement("canvas")};var n=Math.ceil(this.Jt/4.5),r=Math.round(this.Jt/10),u=Math.ceil(this.$t.measureText(t,i));e.textWidth=Math.round(Math.max(1,u)),e.width=Math.round(u+2*n),e.height=this.Jt+2*n,0!==u&&(this.yr.push(e.text),this.kr.set(e.text,e)),e.canvas.width=e.width,e.canvas.height=e.height,(t=d(Mi(e.canvas))).font=this.pr,t.fillStyle=this.Mr,t.fillText(i,0,e.height-n-r)}return e},t}();!function(t){t[t.Default=0]="Default",t[t.NsResize=1]="NsResize"}(Te||(Te={}));var Pe,ke,Ee=function(){function t(t,i,e,s){this.L=null,this.Nr=null,this.Sr=null,this.xr=!1,this.Cr=!0,this.Dr=new It(50),this.Er=new Le(11,"#000"),this.Mr=null,this.pr=null,this.Or=0,this.j=t,this.$=i,this.lh=e,this.Ar="left"===s,this.lr=document.createElement("div"),this.lr.style.height="100%",this.lr.style.overflow="hidden",this.lr.style.width="25px",this.lr.style.left="0",this.lr.style.position="relative",this.Tr=ue(this.lr,new he(16,16)),this.Tr.style.position="absolute",this.Tr.style.zIndex="1",this.Tr.style.left="0",this.Tr.style.top="0",this.Tn=d(Mi(this.Tr)),this.Lr=ue(this.lr,new he(16,16)),this.Lr.style.position="absolute",this.Lr.style.zIndex="2",this.Lr.style.left="0",this.Lr.style.top="0",this.Br=d(Mi(this.Lr));var n={mouseDownEvent:this.br.bind(this),pressedMouseMoveEvent:this.mr.bind(this),mouseDownOutsideEvent:this.zr.bind(this),mouseUpEvent:this.gr.bind(this),mouseDoubleClickEvent:this.Vr.bind(this),mouseEnterEvent:this.Fr.bind(this),mouseLeaveEvent:this.jr.bind(this)};this.wr=new me(this.Lr,n,{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0})}return t.prototype.destroy=function(){this.wr.destroy(),null!==this.L&&(this.L.onMarksChanged().unsubscribeAll(this),this.L.optionsChanged().unsubscribeAll(this)),this.L=null,null!==this.Sr&&(clearTimeout(this.Sr),this.Sr=null),this.Er.destroy()},t.prototype.getElement=function(){return this.lr},t.prototype.backgroundColor=function(){return this.$.backgroundColor},t.prototype.lineColor=function(){return this.j.chart().options().priceScale.borderColor},t.prototype.textColor=function(){return this.$.textColor},t.prototype.fontSize=function(){return this.$.fontSize},t.prototype.baseFont=function(){return ki(this.fontSize(),this.$.fontFamily)},t.prototype.rendererOptions=function(){var t=this.lh.options(),i=this.Mr!==t.color,e=this.pr!==t.font;return(i||e)&&(this.Ir(t),this.Mr=t.color),e&&(this.Dr.reset(),this.pr=t.font),t},t.prototype.optimalWidth=function(){if(!this.isVisible()||null===this.L)return 0;var t=34,i=this.rendererOptions(),e=this.Tn,s=this.L.marks();e.font=this.baseFont(),s.length>0&&(t=Math.max(this.Dr.measureText(e,s[0].label),this.Dr.measureText(e,s[s.length-1].label)));for(var n=this.Pr(),r=n.length;r--;){var u=this.Dr.measureText(e,n[r].text());u>t&&(t=u)}return Math.ceil(i.offsetSize+i.borderSize+i.tickLength+i.paddingInner+i.paddingOuter+t)},t.prototype.setSize=function(t){if(t.w<0||t.h<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));null!==this.Nr&&this.Nr.equals(t)||(this.Nr=t,ae(this.Tr,t),ae(this.Lr,t),this.lr.style.width=t.w+"px",this.lr.style.height=t.h+"px",this.lr.style.minWidth=t.w+"px")},t.prototype.getWidth=function(){return d(this.Nr).w},t.prototype.setPriceScale=function(t){this.L!==t&&(null!==this.L&&(this.L.onMarksChanged().unsubscribeAll(this),this.L.optionsChanged().unsubscribeAll(this)),this.L=t,t.onMarksChanged().subscribe(this.en.bind(this),this))},t.prototype.priceScale=function(){return this.L},t.prototype.isVisible=function(){return this.Cr},t.prototype.setVisible=function(t){t!==this.Cr&&(this.lr.style.display=t?"table-cell":"none",this.Cr=t)},t.prototype.setAutoScale=function(t){var i=this.j.state();this.j.chart().model().setPriceAutoScale(i,d(this.priceScale()),t)},t.prototype.reset=function(){var t=this.j.state();this.j.chart().model().resetPriceScale(t,d(this.priceScale()))},t.prototype.paint=function(t){this.Cr&&null!==this.Nr&&(this.Br.clearRect(-.5,-.5,this.Nr.w,this.Nr.h),1!==t&&(this.Wr(),this.Rr(this.Tn),this.Tt(this.Tn),this.qr(this.Tn),this.Ur(this.Tn)),this.Hr(this.Br))},t.prototype.getImage=function(){return this.Tr},t.prototype.isLeft=function(){return this.Ar},t.prototype.br=function(t){if(null!==this.L&&!this.L.isEmpty()&&this.j.chart().options().handleScale.axisPressedMouseMove){var i=this.j.chart().model(),e=this.j.state();this.xr=!0,i.startScalePrice(e,this.L,t.localY)}},t.prototype.mr=function(t){if(null!==this.L&&this.j.chart().options().handleScale.axisPressedMouseMove){var i=this.j.chart().model(),e=this.j.state(),s=this.L;i.scalePriceTo(e,s,t.localY)}},t.prototype.zr=function(){if(null!==this.L&&this.j.chart().options().handleScale.axisPressedMouseMove){var t=this.j.chart().model(),i=this.j.state(),e=this.L;this.xr&&(this.xr=!1,t.endScalePrice(i,e))}},t.prototype.gr=function(t){if(null!==this.L&&this.j.chart().options().handleScale.axisPressedMouseMove){var i=this.j.chart().model(),e=this.j.state();this.xr=!1,i.endScalePrice(e,this.L)}},t.prototype.Vr=function(t){this.reset()},t.prototype.Fr=function(t){null!==this.L&&(!this.j.chart().model().options().handleScale.axisPressedMouseMove||this.L.isPercentage()||this.L.isIndexedTo100()||this.Yr(1))},t.prototype.jr=function(t){this.Yr(0)},t.prototype.Pr=function(){var t=this,i=[],e=null===this.L?void 0:this.L;return function(s){for(var n=0;n<s.length;++n)for(var r=s[n].priceAxisViews(t.j.state(),e),u=0;u<r.length;u++)i.push(r[u])}(this.j.state().orderedSources()),i},t.prototype.Rr=function(t){null!==this.Nr&&le(t,0,0,this.Nr.w,this.Nr.h,this.backgroundColor())},t.prototype.Tt=function(t){if(null!==this.Nr&&null!==this.L&&this.L.options().borderVisible){t.save(),t.fillStyle=this.lineColor();var i,e=this.rendererOptions().borderSize;this.Ar?(t.translate(-.5,-.5),i=this.Nr.w-e-1):(t.translate(.5,-.5),i=0),t.fillRect(i,0,e,this.Nr.h),t.restore()}},t.prototype.qr=function(t){if(null!==this.Nr&&null!==this.L){t.save(),t.strokeStyle=this.lineColor();var i=this.L.marks();t.font=this.baseFont(),t.translate(-.5,-.5),t.fillStyle=this.lineColor();var e=this.rendererOptions(),s=this.L.options().borderVisible,n=this.Ar?this.Nr.w-e.offsetSize-e.borderSize-e.tickLength:e.borderSize+e.offsetSize,r=this.Ar?n-e.paddingInner:n+e.tickLength+e.paddingInner,u=this.Ar?"right":"left";if(s){t.beginPath();for(var o=0,h=i;o<h.length;o++){var l=h[o];t.rect(n,l.coord,e.tickLength,1)}t.fill()}t.fillStyle=this.textColor();for(var a=0,c=i;a<c.length;a++)l=c[a],this.Er.paintTo(t,l.label,r,l.coord,u);t.restore()}},t.prototype.Wr=function(){if(null!==this.Nr&&null!==this.L){var t=this.Nr.h/2,i=[],e=this.L.orderedSources().slice(),s=this.j.state(),n=this.rendererOptions();this.L===s.defaultPriceScale()&&this.j.state().orderedSources().forEach((function(t){s.isOverlay(t)&&e.push(t)}));var r=this.L.mainSource(),u=this.L;e.forEach((function(e){var n=e.priceAxisViews(s,u);n.forEach((function(t){t.setFixedCoordinate(null),t.isVisible()&&i.push(t)})),r===e&&n.length>0&&(t=n[0].floatCoordinate())}));var o=i.filter((function(i){return i.floatCoordinate()<=t})),h=i.filter((function(i){return i.floatCoordinate()>t}));if(o.sort((function(t,i){return i.floatCoordinate()-t.floatCoordinate()})),o.length&&h.length&&h.push(o[0]),h.sort((function(t,i){return t.floatCoordinate()-i.floatCoordinate()})),i.forEach((function(t){return t.setFixedCoordinate(t.coordinate())})),this.L.options().alignLabels){for(var l=1;l<o.length;l++){var a=o[l],c=(d=o[l-1]).height(n,!1);a.coordinate()>(v=d.getFixedCoordinate())-c&&a.setFixedCoordinate(v-c)}for(var f=1;f<h.length;f++){var d,v;a=h[f],c=(d=h[f-1]).height(n,!0),a.coordinate()<(v=d.getFixedCoordinate())+c&&a.setFixedCoordinate(v+c)}}}},t.prototype.Ur=function(t){var i=this;if(null!==this.Nr){var e=this.Nr,s=this.Pr(),n=this.rendererOptions(),r=this.Ar?"right":"left";s.forEach((function(s){if(s.isAxisLabelVisible()){var u=s.renderer();t.save(),u.draw(t,n,i.Dr,e.w,r),t.restore()}}))}},t.prototype.Hr=function(t){var i=this;if(null!==this.Nr&&null!==this.L){var e=this.Nr,s=this.j.chart().model(),n=[],r=this.j.state(),u=s.crosshairSource().priceAxisViews(r,this.L);u.length&&n.push(u);var o=this.rendererOptions(),h=this.Ar?"right":"left";n.forEach((function(s){s.forEach((function(s){t.save(),s.renderer().draw(t,o,i.Dr,e.w,h),t.restore()}))}))}},t.prototype.Yr=function(t){this.lr.style.cursor=1===t?"ns-resize":"default"},t.prototype.en=function(){var t=this,i=this.optimalWidth();if(this.Or<i){var e=this.j.chart();null===this.Sr&&(this.Sr=setTimeout((function(){e&&e.model().fullUpdate(),t.Sr=null}),100))}this.Or=i},t.prototype.Ir=function(t){this.Er.destroy(),this.Er=new Le(t.fontSize,t.color,t.fontFamily)},t}(),Ve=ye,Re=function(){function t(t,i){this.Nr=new he(0,0),this.Kr=null,this.$r=null,this.Xr=!1,this._r="none",this.Jr=new Q,this.Zr=0,this.Qr=!1,this.Gr=null,this.tu=!1,this.iu=null,this.nu=t,this.su=i,this.su.onDestroyed().subscribe(this.hu.bind(this),this,!0),this.ru=document.createElement("td"),this.ru.style.padding="0",this.ru.style.position="relative";var e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.position="relative",e.style.overflow="hidden",this.uu=document.createElement("td"),this.uu.style.padding="0",this.eu=document.createElement("td"),this.eu.style.padding="0",this.ru.appendChild(e),this.Tr=ue(e,new he(16,16)),this.Tr.style.position="absolute",this.Tr.style.zIndex="1",this.Tr.style.left="0",this.Tr.style.top="0",this.Tn=d(Mi(this.Tr)),this.Lr=ue(e,new he(16,16)),this.Lr.style.position="absolute",this.Lr.style.zIndex="2",this.Lr.style.left="0",this.Lr.style.top="0",this.Br=d(Mi(this.Lr)),this.cr=document.createElement("tr"),this.cr.appendChild(this.uu),this.cr.appendChild(this.ru),this.cr.appendChild(this.eu),this.ou(),t.model().mainPriceScaleOptionsChanged().subscribe(this.fu.bind(this),this),this.updatePriceAxisWidget();var s=this.chart().options().handleScroll;this.wr=new me(this.Lr,this,{treatVertTouchDragAsPageScroll:!s.vertTouchDrag,treatHorzTouchDragAsPageScroll:!s.horzTouchDrag})}return t.prototype.destroy=function(){null!==this.Kr&&this.Kr.destroy(),null!==this.su&&this.su.onDestroyed().unsubscribeAll(this),this.wr.destroy()},t.prototype.state=function(){return d(this.su)},t.prototype.stateOrNull=function(){return this.su},t.prototype.setState=function(i){null!==this.su&&this.su.onDestroyed().unsubscribeAll(this),this.su=i,null!==this.su&&this.su.onDestroyed().subscribe(t.prototype.hu.bind(this),this,!0),this.updatePriceAxisWidget()},t.prototype.chart=function(){return this.nu},t.prototype.getElement=function(){return this.cr},t.prototype.updatePriceAxisWidget=function(){if(null!==this.su&&null!==this.Kr&&0!==this.V().serieses().length){var t=this.su.defaultPriceScale();this.Kr.setPriceScale(d(t))}},t.prototype.stretchFactor=function(){return null!==this.su?this.su.stretchFactor():0},t.prototype.setStretchFactor=function(t){this.su&&this.su.setStretchFactor(t)},t.prototype.mouseEnterEvent=function(t){if(this.su){var i=t.localX,e=t.localY;fe||this.au(i,e)}},t.prototype.mouseDownEvent=function(t){if(this.Qr=!1,this.tu=null!==this.Gr,this.su){if(document.activeElement!==document.body&&document.activeElement!==document.documentElement)d(document.activeElement).blur();else{var i=document.getSelection();null!==i&&i.removeAllRanges()}var e=this.V();if(!this.su.defaultPriceScale().isEmpty()&&!e.timeScale().isEmpty()){if(null!==this.Gr){var s=e.crosshairSource();this.iu={x:s.appliedX(),y:s.appliedY()},this.Gr={x:t.localX,y:t.localY}}fe||this.au(t.localX,t.localY)}}},t.prototype.mouseMoveEvent=function(t){if(this.su){var i=t.localX,e=t.localY;if(this.cu()&&this.lu(),!fe){this.au(i,e);var s=this.hitTest(i,e);this.V().setHoveredSource(s&&{source:s.source,object:s.object}),null!==s&&void 0!==s.view.moveHandler&&s.view.moveHandler(i,e)}}},t.prototype.mouseClickEvent=function(t){if(null!==this.su){var i=t.localX,e=t.localY,s=this.hitTest(i,e);if(null!==s&&void 0!==s.view.clickHandler&&s.view.clickHandler(i,e),this.Jr.hasListeners()){var n=this.V().crosshairSource().appliedIndex();this.Jr.fire(n,{x:i,y:e})}this.vu()}},t.prototype.pressedMouseMoveEvent=function(t){if(null!==this.su){var i=this.V(),e=t.localX,s=t.localY;if(null!==this.Gr){this.tu=!1;var n=d(this.iu),r=n.x+(e-this.Gr.x),u=n.y+(s-this.Gr.y);this.au(r,u)}else this.cu()||this.au(e,s);if(!i.timeScale().isEmpty()){var o=this.nu.options().handleScroll;if(o.pressedMouseMove&&"touch"!==t.type||(o.horzTouchDrag||o.vertTouchDrag)&&"mouse"!==t.type){var h=this.su.defaultPriceScale();null!==this.$r||this.du()||(this.$r={x:t.clientX,y:t.clientY}),null===this.$r||this.$r.x===t.clientX&&this.$r.y===t.clientY||this.Xr||(h.isEmpty()||i.startScrollPrice(this.su,h,t.localY),i.startScrollTime(t.localX),this.Xr=!0),this.Xr&&(h.isEmpty()||i.scrollPriceTo(this.su,h,t.localY),i.scrollTimeTo(t.localX))}}}},t.prototype.mouseUpEvent=function(t){if(null!==this.su){this.Qr=!1;var i=this.V();if(this.Xr){var e=this.su.defaultPriceScale();i.endScrollPrice(this.su,e),i.endScrollTime(),this.$r=null,this.Xr=!1}}},t.prototype.longTapEvent=function(t){if(this.Qr=!0,null===this.Gr&&Ve){var i={x:t.localX,y:t.localY};this.wu(i,i)}},t.prototype.mouseLeaveEvent=function(t){null!==this.su&&(this.su.model().setHoveredSource(null),ye||this.lu())},t.prototype.clicked=function(){return this.Jr},t.prototype.pinchStartEvent=function(){this.Zr=1},t.prototype.pinchEvent=function(t,i){if(this.nu.options().handleScale.pinch){var e=5*(i-this.Zr);this.Zr=i,this.V().zoomTime(t.x,e)}},t.prototype.hitTest=function(t,i){var e=this.su;if(null===e)return null;for(var s=0,n=e.orderedSources();s<n.length;s++){var r=n[s],u=this.bu(r.paneViews(e),t,i);if(null!==u)return{source:r,view:u.view,object:u.object}}return null},t.prototype.setPriceAxisSize=function(t){d(this.Kr).setSize(new he(t,this.Nr.h))},t.prototype.getSize=function(){return this.Nr},t.prototype.setSize=function(t){if(t.w<0||t.h<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.Nr.equals(t)||(this.Nr=t,ae(this.Tr,t),ae(this.Lr,t),this.Tn=d(Mi(this.Tr)),this.ru.style.width=t.w+"px",this.ru.style.height=t.h+"px")},t.prototype.recalculatePriceScale=function(){var t=d(this.su);t.recalculatePriceScale(t.defaultPriceScale());for(var i=0,e=t.dataSources();i<e.length;i++){var s=e[i];if(t.isOverlay(s)){var n=s.priceScale();null!==n&&t.recalculatePriceScale(n),s.updateAllViews()}}},t.prototype.getImage=function(){return this.Tr},t.prototype.paint=function(t){0!==t&&null!==this.su&&(t>1&&this.recalculatePriceScale(),null!==this.Kr&&this.Kr.paint(t),this.Br.clearRect(-.5,-.5,this.Nr.w,this.Nr.h),1!==t&&(this.Rr(this.Tn,this.mu()),this.su&&(this.gu(this.Tn),this.Mu(this.Tn),this.pu(this.Tn))),this.yu(this.Br))},t.prototype.priceAxisWidget=function(){return this.Kr},t.prototype.mu=function(){return this.nu.options().layout.backgroundColor},t.prototype.hu=function(){null!==this.su&&this.su.onDestroyed().unsubscribeAll(this),this.su=null},t.prototype.Rr=function(t,i){le(t,0,0,this.Nr.w,this.Nr.h,i)},t.prototype.gu=function(t){for(var i=d(this.su),e=this.V().gridSource().paneViews(i),s=i.height(),n=i.width(),r=0,u=e;r<u.length;r++){var o=u[r];t.save();var h=o.renderer(s,n);null!==h&&h.draw(t,!1),t.restore()}},t.prototype.Mu=function(t){var i=this.V().watermarkSource();if(null!==i){var e=d(this.su);if(e.containsSeries())for(var s=i.paneViews(),n=e.height(),r=e.width(),u=0,o=s;u<o.length;u++){var h=o[u];t.save();var a=h.renderer(n,r);null!==a&&a.draw(t,!1),t.restore()}}},t.prototype.yu=function(t){this.ku(this.V().crosshairSource(),t)},t.prototype.pu=function(t){for(var i=d(this.su).orderedSources(),e=this.V().crosshairSource(),s=0,n=i;s<n.length;s++){var r=n[s];this.Nu(r,t)}for(var u=0,o=i;u<o.length;u++)(r=o[u])!==e&&this.ku(r,t)},t.prototype.ku=function(t,i){for(var e=d(this.su),s=t.paneViews(e),n=e.height(),r=e.width(),u=e.model().hoveredSource(),o=null!==u&&u.source===t,h=null!==u&&o&&void 0!==u.object?u.object.hitTestData:void 0,a=0,l=s;a<l.length;a++){var c=l[a].renderer(n,r);null!==c&&(i.save(),c.draw(i,o,h),i.restore())}},t.prototype.Nu=function(t,i){for(var e=d(this.su),s=t.paneViews(e),n=e.height(),r=e.width(),u=e.model().hoveredSource(),o=null!==u&&u.source===t,h=null!==u&&o&&void 0!==u.object?u.object.hitTestData:void 0,a=0,l=s;a<l.length;a++){var c=l[a].renderer(n,r);null!==c&&void 0!==c.drawBackground&&(i.save(),c.drawBackground(i,o,h),i.restore())}},t.prototype.bu=function(t,i,e){for(var s=0,n=t;s<n.length;s++){var r=n[s],u=r.renderer(this.Nr.h,this.Nr.w);if(null!==u&&u.hitTest){var o=u.hitTest(i,e);if(null!==o)return{view:r,object:o}}}return null},t.prototype.fu=function(){this.ou(),this.nu.adjustSize()},t.prototype.ou=function(){if(null!==this.su){var t=this.nu,i=this.su.defaultPriceScale().options().position;if(this._r!==i){if(null!==this.Kr&&(this.Kr.isLeft()?this.uu.removeChild(this.Kr.getElement()):this.eu.removeChild(this.Kr.getElement()),this.Kr.destroy(),this.Kr=null),"none"!==i){var e=t.model().rendererOptionsProvider();this.Kr=new Ee(this,t.options().layout,e,i),"left"===i&&this.uu.appendChild(this.Kr.getElement()),"right"===i&&this.eu.appendChild(this.Kr.getElement())}this._r=i}}},t.prototype.cu=function(){return Ve&&null===this.Gr},t.prototype.du=function(){return Ve&&this.Qr||null!==this.Gr},t.prototype.Su=function(t){return Math.max(0,Math.min(t,this.Nr.w-1))},t.prototype.xu=function(t){return Math.max(0,Math.min(t,this.Nr.h-1))},t.prototype.au=function(t,i){this.V().setAndSaveCurrentPosition(this.Su(t),this.xu(i),d(this.su))},t.prototype.lu=function(){this.V().clearCurrentPosition()},t.prototype.vu=function(){this.tu&&(this.Gr=null,this.lu())},t.prototype.wu=function(t,i){this.Gr=t,this.tu=!1,this.au(i.x,i.y);var e=this.V().crosshairSource();this.iu={x:e.appliedX(),y:e.appliedY()}},t.prototype.V=function(){return this.nu.model()},t}(),De=function(){function t(t,i,e,s){this.o=!0,this.Nr=new he(0,0),this.Ar="left"===t,this.lh=e.rendererOptionsProvider,this.$=i,this.Cu=s,this.lr=document.createElement("div"),this.lr.style.width="25px",this.lr.style.height="100%",this.lr.style.overflow="hidden",this.Tr=ue(this.lr,new he(16,16)),this.Tn=Mi(this.Tr)}return t.prototype.destroy=function(){},t.prototype.update=function(){this.o=!0},t.prototype.getElement=function(){return this.lr},t.prototype.setSize=function(t){if(t.w<0||t.h<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.Nr.equals(t)||(this.Nr=t,ae(this.Tr,t),this.lr.style.width=t.w+"px",this.lr.style.minWidth=t.w+"px",this.lr.style.height=t.h+"px",this.o=!0)},t.prototype.paint=function(t){t<3&&!this.o||0!==this.Nr.w&&0!==this.Nr.h&&(this.o=!1,this.Rr(),this.Tt())},t.prototype.getImage=function(){return this.Tr},t.prototype.getWidth=function(){return this.Nr.w},t.prototype.isLeft=function(){return this.Ar},t.prototype.Tt=function(){if(this.Cu()){var t=this.Nr.w;this.Tn.save(),this.Tn.fillStyle=this.$.timeScale.borderColor;var i,e=this.lh.options().borderSize;this.Ar?(this.Tn.translate(-.5,-.5),i=t-e-1):(this.Tn.translate(-.5,-.5),i=0),this.Tn.fillRect(i,0,2*e,1),this.Tn.restore()}},t.prototype.Rr=function(){le(this.Tn,0,0,this.Nr.w,this.Nr.h,this.$.layout.backgroundColor)},t}();function _e(t,i){return t.span>i.span?t:i}!function(t){t[t.BorderSize=1]="BorderSize",t[t.TickLength=3]="TickLength"}(Pe||(Pe={})),function(t){t[t.Default=0]="Default",t[t.EwResize=1]="EwResize"}(ke||(ke={}));var Ae,ze=function(){function t(t){this.Du=null,this.Eu=70,this.Ht=null,this.Ou=!1,this.Nr=new he(0,0),this._r="none",this.nu=t,this.$=t.options().layout,this.Au=document.createElement("tr"),this.Tu=document.createElement("td"),this.Tu.style.padding="0",this.Lu=document.createElement("td"),this.Lu.style.padding="0",this.lr=document.createElement("td"),this.lr.style.height="25px",this.lr.style.padding="0",this.Bu=document.createElement("div"),this.Bu.style.width="100%",this.Bu.style.height="100%",this.Bu.style.position="relative",this.Bu.style.overflow="hidden",this.lr.appendChild(this.Bu),this.Tr=ue(this.Bu,new he(16,16)),this.Tr.style.position="absolute",this.Tr.style.zIndex="1",this.Tr.style.left="0",this.Tr.style.top="0",this.zu=d(Mi(this.Tr)),this.Lr=ue(this.Bu,new he(16,16)),this.Lr.style.position="absolute",this.Lr.style.zIndex="2",this.Lr.style.left="0",this.Lr.style.top="0",this.Vu=d(Mi(this.Lr)),this.Au.appendChild(this.Tu),this.Au.appendChild(this.lr),this.Au.appendChild(this.Lu),this.Fu(),this.nu.model().mainPriceScaleOptionsChanged().subscribe(this.Fu.bind(this),this),this.wr=new me(this.Lr,this,{treatVertTouchDragAsPageScroll:!0,treatHorzTouchDragAsPageScroll:!1})}return t.prototype.destroy=function(){this.wr.destroy(),null!==this.Du&&this.Du.destroy()},t.prototype.getElement=function(){return this.Au},t.prototype.stub=function(){return this.Du},t.prototype.mouseDownEvent=function(t){if(!this.Ou){this.Ou=!0;var i=this.nu.model();!i.timeScale().isEmpty()&&this.nu.options().handleScale.axisPressedMouseMove&&i.startScaleTime(t.localX)}},t.prototype.mouseDownOutsideEvent=function(){var t=this.nu.model();!t.timeScale().isEmpty()&&this.Ou&&(this.Ou=!1,this.nu.options().handleScale.axisPressedMouseMove&&t.endScaleTime())},t.prototype.pressedMouseMoveEvent=function(t){var i=this.nu.model();!i.timeScale().isEmpty()&&this.nu.options().handleScale.axisPressedMouseMove&&i.scaleTimeTo(t.localX)},t.prototype.mouseUpEvent=function(t){this.Ou=!1;var i=this.nu.model();i.timeScale().isEmpty()&&!this.nu.options().handleScale.axisPressedMouseMove||i.endScaleTime()},t.prototype.mouseDoubleClickEvent=function(){this.nu.model().resetTimeScale()},t.prototype.mouseEnterEvent=function(t){this.nu.model().options().handleScale.axisPressedMouseMove&&this.Yr(1)},t.prototype.mouseLeaveEvent=function(t){this.Yr(0)},t.prototype.setSizes=function(t,i){this.Nr&&this.Nr.equals(t)||(this.Nr=t,ae(this.Tr,t),ae(this.Lr,t),Mi(this.Tr),Mi(this.Lr),this.lr.style.width=t.w+"px",this.lr.style.height=t.h+"px"),null!==this.Du&&this.Du.setSize(new he(i,t.h))},t.prototype.width=function(){return this.Nr.w},t.prototype.height=function(){return this.Nr.h},t.prototype.optimalHeight=function(){var t=this.ju();return Math.ceil(t.borderSize+t.tickLength+t.fontSize+t.paddingTop+t.paddingBottom)},t.prototype.update=function(){var t=this,i=this.nu.model().timeScale().marks();i&&(this.Eu=70,i.forEach((function(i){t.Eu=Math.min(i.span,t.Eu)})))},t.prototype.getImage=function(){return this.Tr},t.prototype.paint=function(t){if(0!==t){if(1!==t){var i=this.zu;this.Rr(i),this.Tt(i),this.qr(i),this.Ur(i),null!==this.Du&&this.Du.paint(t)}this.Hr(this.Vu)}},t.prototype.Rr=function(t){le(t,0,0,this.Nr.w,this.Nr.h,this.mu())},t.prototype.Tt=function(t){this.nu.options().timeScale.borderVisible&&(t.save(),t.fillStyle=this.Iu(),t.translate(-.5,-.5),t.fillRect(0,0,this.Nr.w,1),t.restore())},t.prototype.qr=function(t){var i=this.nu.model().timeScale().marks();if(i&&0!==i.length){var e=i.reduce(_e,i[0]).span;e>30&&e<40&&(e=30),t.save(),t.strokeStyle=this.Iu();var s=this.ju(),n=s.borderSize+s.tickLength+s.paddingTop+s.fontSize-s.baselineOffset;if(t.textAlign="center",t.translate(.5,-.5),t.fillStyle=this.Iu(),this.nu.model().timeScale().options().borderVisible){t.beginPath();for(var r=i.length;r--;)t.rect(i[r].coord,1,1,s.tickLength);t.fill()}t.fillStyle=this.jn(),t.font=this.Pu();for(var u=0,o=i;u<o.length;u++)(a=o[u]).span<e&&t.fillText(a.label,a.coord,n);t.font=this.Wu();for(var h=0,l=i;h<l.length;h++){var a;(a=l[h]).span>=e&&t.fillText(a.label,a.coord,n)}t.restore()}},t.prototype.Ur=function(t){t.save();var i=new Set,e=this.nu.model(),s=e.dataSources();i.add(e.crosshairSource());for(var n=this.ju(),r=0,u=s;r<u.length;r++){var o=u[r];if(!i.has(o))for(var h=0,l=o.timeAxisViews();h<l.length;h++)l[h].renderer().draw(t,n)}t.restore()},t.prototype.Hr=function(t){this.Vu.clearRect(-.5,-.5,this.Nr.w,this.Nr.h);var i=[],e=this.nu.model().crosshairSource().timeAxisViews();i.push(e);var s=this.ju();i.forEach((function(i){i.forEach((function(i){t.save(),i.renderer().draw(t,s),t.restore()}))}))},t.prototype.mu=function(){return this.$.backgroundColor},t.prototype.Iu=function(){return this.nu.options().timeScale.borderColor},t.prototype.jn=function(){return this.$.textColor},t.prototype.Jt=function(){return this.$.fontSize},t.prototype.Pu=function(){return ki(this.Jt(),this.$.fontFamily)},t.prototype.Wu=function(){return ki(this.Jt(),this.$.fontFamily,"bold")},t.prototype.ju=function(){null===this.Ht&&(this.Ht={borderSize:1,baselineOffset:NaN,paddingTop:NaN,paddingBottom:NaN,paddingHorizontal:NaN,tickLength:3,fontSize:NaN,font:"",widthCache:new It});var t=this.Ht,i=this.Pu();if(t.font!==i){var e=this.Jt();t.fontSize=e,t.font=i,t.paddingTop=Math.ceil(e/2.5),t.paddingBottom=t.paddingTop,t.paddingHorizontal=Math.ceil(e/2),t.baselineOffset=Math.round(this.Jt()/5),t.widthCache.reset()}return this.Ht},t.prototype.Yr=function(t){this.lr.style.cursor=1===t?"ew-resize":"default"},t.prototype.Fu=function(){var t=this.nu.model().mainPriceScale().options().position;if(t!==this._r){if(null!==this.Du&&(this.Du.isLeft()?this.Tu.removeChild(this.Du.getElement()):this.Lu.removeChild(this.Du.getElement()),this.Du.destroy(),this.Du=null),"none"!==t){var i={rendererOptionsProvider:this.nu.model().rendererOptionsProvider()},e=this.nu.model();this.Du=new De(t,this.nu.options(),i,(function(){return e.mainPriceScale().options().borderVisible&&e.timeScale().options().borderVisible})),("left"===t?this.Tu:this.Lu).appendChild(this.Du.getElement())}this._r=t}},t}(),Ie=function(){function t(t,i){var e=this;this.Ru=[],this.qu=[],this.Uu=0,this.Hu=new Q,this.Qi=0,this.Kt=0,this.Yu=0,this.Ku=null,this.$u=!1,this.Jr=new Q,this.fh=new Q,this.$=i,this.Au=document.createElement("div"),this.Au.classList.add("tv-lightweight-charts"),this.Au.style.overflow="hidden",this.Au.style.width="100%",this.Au.style.height="100%",this.Xu=document.createElement("table"),this.Xu.setAttribute("cellspacing","0"),this.Au.appendChild(this.Xu),this._u=this.Ju.bind(this),this.Au.addEventListener("wheel",this._u,{passive:!1}),this.V=new oe(this.ah.bind(this),this.$),this.model().crosshairMoved().subscribe(this.Zu.bind(this),this),this.Qu=new ze(this),this.Xu.appendChild(this.Qu.getElement());var s=this.$.width,n=this.$.height;if(0===s&&0===n){var r=t.getBoundingClientRect();s=r.width,n=r.height}s=Math.max(70,s),n=Math.max(50,n),this.resize(n,s),this.Gu(),t.appendChild(this.Au),this.te(),this.V.timeScale().optionsApplied().subscribe((function(){e.te(),e.adjustSize()}),this)}return t.prototype.model=function(){return this.V},t.prototype.options=function(){return this.$},t.prototype.paneWidgets=function(){return this.Ru},t.prototype.destroy=function(){this.Au.removeEventListener("wheel",this._u),0!==this.Uu&&window.cancelAnimationFrame(this.Uu),this.V.crosshairMoved().unsubscribeAll(this),this.V.timeScale().optionsApplied().unsubscribeAll(this),this.V.destroy();for(var t=0,i=this.Ru;t<i.length;t++){var e=i[t];this.Xu.removeChild(e.getElement()),e.clicked().unsubscribeAll(this),e.destroy()}this.Ru=[];for(var s=0,n=this.qu;s<n.length;s++){var r=n[s];this.ie(r)}this.qu=[],d(this.Qu).destroy(),null!==this.Au.parentElement&&this.Au.parentElement.removeChild(this.Au),this.fh.destroy(),this.Jr.destroy(),delete this.Au},t.prototype.resize=function(t,i,e){if(void 0===e&&(e=!1),this.Qi!==t||this.Kt!==i){this.Qi=t,this.Kt=i;var s=t+"px",n=i+"px";d(this.Au).style.height=s,d(this.Au).style.width=n,this.Xu.style.height=s,this.Xu.style.width=n,e?this.ne(new Ai(3)):this.V.fullUpdate()}},t.prototype.paint=function(t){void 0===t&&(t=new Ai(3));for(var i=0;i<this.Ru.length;i++)this.Ru[i].paint(t.invalidateForPane(i).level);this.Qu.paint(t.fullInvalidation())},t.prototype.adjustSize=function(){this.se(),this.V.fullUpdate()},t.prototype.applyOptions=function(t){this.V.applyOptions(t),this.te();var i=t.width||this.Kt,e=t.height||this.Qi;this.resize(e,i)},t.prototype.clicked=function(){return this.Jr},t.prototype.crosshairMoved=function(){return this.fh},t.prototype.takeScreenshot=function(){var t=this;null!==this.Ku&&(this.ne(this.Ku),this.Ku=null);var i=this.Ru[0],e=this.Kt,s=this.Qi,n=document.createElement("canvas");ae(n,new he(e,s));var r=d(Mi(n));r.translate(-.5,-.5);var u=0,o=0,h=function(){for(var i=0;i<t.Ru.length;i++){var e=t.Ru[i],s=d(e.priceAxisWidget()).getImage();r.drawImage(s,u,o),o+=e.getSize().h,i<t.Ru.length-1&&(o+=xe)}};"left"===this.$.priceScale.position&&(h(),u=d(i.priceAxisWidget()).getWidth()),o=0;for(var a=0;a<this.Ru.length;a++){var l=this.Ru[a],c=l.getImage();if(r.drawImage(c,u,o),o+=l.getSize().h,a<this.Ru.length-1){var f=this.qu[a].getImage();r.drawImage(f,u,o),o+=xe}}u+=i.getSize().w,"right"===this.$.priceScale.position&&(o=0,h());var v=function(){var i=d(t.Qu.stub()).getImage();r.drawImage(i,u,o)};return this.$.timeScale.visible&&(u=0,"left"===this.$.priceScale.position&&(v(),u=d(i.priceAxisWidget()).getWidth()),c=this.Qu.getImage(),r.drawImage(c,u,o),"right"===this.$.priceScale.position&&(u=i.getSize().w,v(),r.restore())),n},t.prototype.se=function(){for(var t=0,i=0,e=0,s=this.Ru;e<s.length;e++){var n=s[e];"none"!==this.$.priceScale.position&&(i=Math.max(i,d(n.priceAxisWidget()).optimalWidth())),t+=n.stretchFactor()}for(var r=this.Kt,u=this.Qi,o=Math.max(r-i,0),h=this.qu.length,a=xe*h,l=this.$.timeScale.visible?this.Qu.optimalHeight():0,c=a+l,f=u<c?0:u-c,v=f/t,y=0,b=0;b<this.Ru.length;++b){(n=this.Ru[b]).setState(this.V.panes()[b]);var m,g;g=b===this.Ru.length-1?f-y:Math.round(n.stretchFactor()*v),y+=m=Math.max(g,2),n.setSize(new he(o,m)),"none"!==this.$.priceScale.position&&n.setPriceAxisSize(i),n.state()&&this.V.setPaneHeight(n.state(),m)}this.Qu.setSizes(new he(o,l),i),this.V.setWidth(o),this.Yu!==i&&(this.Yu=i,this.Hu.fire(i))},t.prototype.Ju=function(t){var i=t.deltaX/100,e=-t.deltaY/100;if(0!==i&&this.$.handleScroll.mouseWheel||0!==e&&this.$.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:i*=120,e*=120;break;case t.DOM_DELTA_LINE:i*=32,e*=32}if(0!==e&&this.$.handleScale.mouseWheel){var s=Math.sign(e)*Math.min(1,Math.abs(e)),n=t.clientX-this.Au.getBoundingClientRect().left;this.model().zoomTime(n,s)}0!==i&&this.$.handleScroll.mouseWheel&&this.model().scrollChart(-80*i)}},t.prototype.ne=function(t){var i=t.fullInvalidation();if(3===i&&this.he(),3===i||2===i){for(var e=this.V.panes(),s=0;s<e.length;s++)t.invalidateForPane(s).autoScale&&e[s].momentaryAutoScale();t.getFitContent()&&this.V.timeScale().fitContent();var n=t.getTargetTimeRange();null!==n&&this.V.timeScale().setTimePointsRange(n),this.Qu.update()}this.paint(t)},t.prototype.ah=function(t){var i=this;null!==this.Ku?this.Ku.merge(t):this.Ku=t,this.$u||(this.$u=!0,this.Uu=window.requestAnimationFrame((function(){i.$u=!1,i.Uu=0,null!==i.Ku&&(i.ne(i.Ku),i.Ku=null)})))},t.prototype.he=function(){this.Gu()},t.prototype.ie=function(t){this.Xu.removeChild(t.getElement()),t.destroy()},t.prototype.Gu=function(){for(var t=this.V.panes(),i=t.length,e=this.Ru.length,s=i;s<e;s++){var n=f(this.Ru.pop());this.Xu.removeChild(n.getElement()),n.clicked().unsubscribeAll(this),n.destroy(),void 0!==(r=this.qu.pop())&&this.ie(r)}for(s=e;s<i;s++){if((n=new Re(this,t[s])).clicked().subscribe(this.ue.bind(this),this),this.Ru.push(n),s>1){var r=new Me(this,s-1,s,!0);this.qu.push(r),this.Xu.insertBefore(r.getElement(),this.Qu.getElement())}this.Xu.insertBefore(n.getElement(),this.Qu.getElement())}for(s=0;s<i;s++){var u=t[s];(n=this.Ru[s]).state()!==u?n.setState(u):n.updatePriceAxisWidget()}this.te(),this.se()},t.prototype.ee=function(t,i){var e,s=new Map;if(null!==t&&this.V.serieses().forEach((function(i){var e=i.dataAt(t);null!==e&&s.set(i,e)})),null!==t){var n=this.V.timeScale().indexToUserTime(t);null!==n&&(e=n)}var r=this.model().hoveredSource(),u=null!==r&&r instanceof fi?r:void 0,o=null!==r&&void 0!==r.object?r.object.externalId:void 0;return{time:e,point:i||void 0,hoveredSeries:u,seriesPrices:s,hoveredObject:o}},t.prototype.ue=function(t,i){var e=this;this.Jr.fire((function(){return e.ee(t,i)}))},t.prototype.Zu=function(t,i){var e=this;this.fh.fire((function(){return e.ee(t,i)}))},t.prototype.te=function(){var t=this.$.timeScale.visible?"":"none";this.Qu.getElement().style.display=t},t}();function Oe(t){void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor)}function Ne(t){if(!gi(t))throw new Error("time must be of type BusinessDay");var i=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{timestamp:Math.round(i.getTime()/1e3),businessDay:t}}function Fe(t){if(!bi(t))throw new Error("time must be of type isUTCTimestamp");return{timestamp:t}}function Be(t){return 0===t.length?null:gi(t[0].time)?Ne:Fe}function je(t){return bi(t)?Fe(t):gi(t)?Ne(t):Ne(Qe(t))}function $e(t,i){var e=t.value,s=null;return"color"in t&&void 0!==t.color&&(s=i.addColor(t.color)),[e,e,e,e,s]}function Ue(t,i){return[t.open,t.high,t.low,t.close,null]}!function(t){t[t.LastPriceAndPercentageValue=0]="LastPriceAndPercentageValue",t[t.LastValueAccordingToScale=1]="LastValueAccordingToScale"}(Ae||(Ae={}));var We={Candlestick:Ue,Bar:Ue,Area:$e,Histogram:$e,Line:$e};function Xe(t){return We[t]}function He(t){return 60*t*60*1e3}function Ye(t){return 60*t*1e3}var Ke=[{divisor:1,span:20},{divisor:(1,1e3),span:19},{divisor:Ye(1),span:20},{divisor:Ye(5),span:21},{divisor:Ye(30),span:22},{divisor:He(1),span:30},{divisor:He(3),span:31},{divisor:He(6),span:32},{divisor:He(12),span:33}];function qe(t,i){if(null!==i){var e=new Date(1e3*i.timestamp),s=new Date(1e3*t.timestamp);if(s.getUTCFullYear()!==e.getUTCFullYear())return 70;if(s.getUTCMonth()!==e.getUTCMonth())return 60;if(s.getUTCDate()!==e.getUTCDate())return 50;for(var n=Ke.length-1;n>=0;--n)if(Math.floor(e.getTime()/Ke[n].divisor)!==Math.floor(s.getTime()/Ke[n].divisor))return Ke[n].span}return 20}function Je(t,i){return t.timestamp<i.timestamp}function Qe(t){var i=new Date(t);if(isNaN(i.getTime()))throw new Error("Invalid date string="+t+", expected format=yyyy-mm-dd");return{day:i.getUTCDate(),month:i.getUTCMonth()+1,year:i.getUTCFullYear()}}function Ge(t){w(t.time)&&(t.time=Qe(t.time))}var Ze,tn=function(){function t(){this.oe=new Map,this.fe=new Map,this.ae=[]}return t.prototype.destroy=function(){this.oe.clear(),this.fe.clear(),this.ae=[]},t.prototype.setSeriesData=function(t,i){var e=this;t.palette().clear(),function(t){t.forEach(Ge)}(i),this.oe.forEach((function(i){return i.mapping.delete(t)}));var s=Be(i);null!==s&&i.forEach((function(i){var n=s(i.time),r=e.oe.get(n.timestamp)||{index:0,mapping:new Map,timePoint:n};r.mapping.set(t,i),e.oe.set(n.timestamp,r)}));var n=new Map;return this.oe.forEach((function(t,i){t.mapping.size>0&&n.set(i,t)})),this.ce(n)},t.prototype.removeSeries=function(t){return this.setSeriesData(t,[])},t.prototype.updateSeriesData=function(t,i){Ge(i);var e=t.data().bars();if(e.size()>0)if(void 0!==d(e.last()).time.businessDay){if(!gi(i.time))throw new Error("time must be of type BusinessDay")}else if(!bi(i.time))throw new Error("time must be of type isUTCTimestamp");var s=d(Be([i]))(i.time),n=this.oe.get(s.timestamp)||{index:0,mapping:new Map,timePoint:s},r=0===n.mapping.size;n.mapping.set(t,i);var u=!1;if(r){var o=this.oe.size;this.ae.length>0&&this.ae[this.ae.length-1].timestamp>s.timestamp?(o=mt(this.ae,s,Je),this.ae.splice(o,0,s),this.le(o),u=!0):this.ae.push(s),n.index=o,this.fe.set(n.index,s)}this.oe.set(s.timestamp,n);var a=new Map,h=function(i){var e=f(l.fe.get(i));f(l.oe.get(e.timestamp)).mapping.forEach((function(s,n){if(u||n===t){var r=Xe(n.seriesType()),o=a.get(n)||{update:[]},h={index:i,time:e,value:r(s,n.palette())};o.update.push(h),a.set(n,o)}}))},l=this;for(o=n.index;o<this.oe.size;++o)h(o);var c=r?this.ve(n.index):[],v=r?this.ae.slice(n.index):[];return{timeScaleUpdate:{seriesUpdates:a,changes:v,index:n.index,marks:c}}},t.prototype.ce=function(t){var i=this;this.oe=t,this.ae=Array.from(this.oe.values()).map((function(t){return t.timePoint})),this.ae.sort((function(t,i){return t.timestamp-i.timestamp}));var e=new Map;this.ae.forEach((function(t,s){var n=f(i.oe.get(t.timestamp));n.index=s,n.mapping.forEach((function(i,n){var r=Xe(n.seriesType()),u=e.get(n)||{update:[]},o={index:s,time:t,value:r(i,n.palette())};u.update.push(o),e.set(n,u)}))}));var s=null,n=this.ae.map((function(t,i){var e=qe(t,s);return s=t,{span:e,time:t,index:i}})),r={seriesUpdates:e,changes:this.ae.slice(),index:0,marks:n};return this.de(),{timeScaleUpdate:r}},t.prototype.le=function(t){for(var i=this.fe.size-1;i>=t;--i){var e=f(this.fe.get(i)),s=i+1;f(this.oe.get(e.timestamp)).index=s,this.fe.delete(i),this.fe.set(s,e)}},t.prototype.de=function(){var t=this;this.fe.clear(),this.oe.forEach((function(i,e){t.fe.set(i.index,i.timePoint)}))},t.prototype.ve=function(t){for(var i=[],e=this.fe.get(t-1)||null,s=t;s<this.fe.size;++s){var n=f(this.fe.get(s)),r=qe(n,e);e=n,i.push({span:r,time:n,index:s})}return i},t}(),en=function(){function t(t,i){this._series=t,this._dataUpdatesConsumer=i}return t.prototype.destroy=function(){delete this._series,delete this._dataUpdatesConsumer},t.prototype.priceFormatter=function(){return this._series.formatter()},t.prototype.series=function(){return this._series},t.prototype.priceToCoordinate=function(t){var i=this._series.firstValue();return null===i?null:this._series.priceScale().priceToCoordinate(t,i.value)},t.prototype.setData=function(t){this._dataUpdatesConsumer.applyNewData(this._series,t)},t.prototype.update=function(t){this._dataUpdatesConsumer.updateData(this._series,t)},t.prototype.setMarkers=function(t){var i=t.map((function(t){return u({},t,{time:je(t.time)})}));this._series.setMarkers(i)},t.prototype.applyOptions=function(t){this._series.applyOptions(t)},t.prototype.options=function(){return b(this._series.options())},t}(),nn=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return l(i,t),i.prototype.applyOptions=function(i){Oe(i),t.prototype.applyOptions.call(this,i)},i}(en),rn={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},sn={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},on={color:"#2196f3",lineStyle:0,lineWidth:3,crosshairMarkerVisible:!0,crosshairMarkerRadius:4},hn={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,crosshairMarkerVisible:!0,crosshairMarkerRadius:4},an={color:"#26a69a",base:0,lineWidth:2},ln={title:"",lastValueVisible:!0,priceLineVisible:!0,priceLineWidth:1,priceLineColor:"",priceLineStyle:1,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}},un=function(){function t(t){this.l=t}return t.prototype.destroy=function(){delete this.l},t.prototype.applyOptions=function(t){this.l.applyOptions({priceScale:t})},t.prototype.options=function(){return this.L().options()},t.prototype.L=function(){return this.l.mainPriceScale()},t}();!function(t){t[t.AnimationDurationMs=1e3]="AnimationDurationMs"}(Ze||(Ze={}));var cn=function(){function t(t){this.V=t}return t.prototype.destroy=function(){delete this.V},t.prototype.scrollPosition=function(){return this.Xn().rightOffset()},t.prototype.scrollToPosition=function(t,i){i?this.Xn().scrollToOffsetAnimated(t,1e3):this.Xn().setRightOffset(t)},t.prototype.scrollToRealTime=function(){this.Xn().scrollToRealTime()},t.prototype.getVisibleRange=function(){var t=this.Xn().visibleBars();if(null===t)return null;var i=this.V.timeScale().points(),e=d(i.firstIndex()),s=d(i.lastIndex());return{from:pn(d(i.valueAt(Math.max(e,t.firstBar())))),to:pn(d(i.valueAt(Math.min(s,t.lastBar()))))}},t.prototype.setVisibleRange=function(t){var i={from:je(t.from),to:je(t.to)};this.V.setTargetTimeRange(i)},t.prototype.resetTimeScale=function(){this.V.resetTimeScale()},t.prototype.fitContent=function(){this.V.fitContent()},t.prototype.applyOptions=function(t){this.Xn().applyOptions(t)},t.prototype.options=function(){return b(this.Xn().options())},t.prototype.Xn=function(){return this.V.timeScale()},t}();function pn(t){return t.businessDay||t.timestamp}function fn(t){if(void 0!==t&&"custom"!==t.type){var i=t;void 0!==i.minMove&&void 0===i.precision&&(i.precision=function(t){if(t>=1)return 0;for(var i=0;i<8;i++){var e=Math.round(t);if(Math.abs(e-t)<1e-8)return i;t*=10}return i}(i.minMove))}}var dn=function(){function t(t,i){var e=this;this.we=new tn,this.be=new Q,this.me=new Map,this.ge=new Map,this.Me=new Q,this.pe=new Q,this.er=new Ie(t,i),this.er.model().timeScale().visibleBarsChanged().subscribe(this.ye.bind(this)),this.er.clicked().subscribe((function(t){e.Me.hasListeners()&&e.Me.fire(e.ke(t()))}),this),this.er.crosshairMoved().subscribe((function(t){e.pe.hasListeners()&&e.pe.fire(e.ke(t()))}),this);var s=this.er.model();this.Ne=new un(s),this.Se=new cn(s)}return t.prototype.remove=function(){this.er.model().timeScale().visibleBarsChanged().unsubscribeAll(this),this.er.clicked().unsubscribeAll(this),this.er.crosshairMoved().unsubscribeAll(this),this.Ne.destroy(),this.Se.destroy(),this.er.destroy(),delete this.er,this.me.forEach((function(t,i){i.destroy()})),this.me.clear(),this.ge.clear(),this.be.destroy(),this.Me.destroy(),this.pe.destroy(),this.we.destroy(),delete this.we},t.prototype.resize=function(t,i,e){this.er.resize(t,i,e)},t.prototype.addAreaSeries=function(t){void 0===t&&(t={}),fn(t.priceFormat);var i=v(b(ln),hn,t),e=this.er.model().createSeries("Area",i),s=new en(e,this);return this.me.set(s,e),this.ge.set(e,s),s},t.prototype.addBarSeries=function(t){void 0===t&&(t={}),fn(t.priceFormat);var i=v(b(ln),sn,t),e=this.er.model().createSeries("Bar",i),s=new en(e,this);return this.me.set(s,e),this.ge.set(e,s),s},t.prototype.addCandlestickSeries=function(t){void 0===t&&(t={}),Oe(t),fn(t.priceFormat);var i=v(b(ln),rn,t),e=this.er.model().createSeries("Candlestick",i),s=new nn(e,this);return this.me.set(s,e),this.ge.set(e,s),s},t.prototype.addHistogramSeries=function(t){void 0===t&&(t={}),fn(t.priceFormat);var i=v(b(ln),an,t),e=this.er.model().createSeries("Histogram",i),s=new en(e,this);return this.me.set(s,e),this.ge.set(e,s),s},t.prototype.addLineSeries=function(t){void 0===t&&(t={}),fn(t.priceFormat);var i=v(b(ln),on,t),e=this.er.model().createSeries("Line",i),s=new en(e,this);return this.me.set(s,e),this.ge.set(e,s),s},t.prototype.removeSeries=function(t){var i=t,e=f(this.me.get(i)),s=this.we.removeSeries(e),n=this.er.model();n.removeSeries(e);var r=s.timeScaleUpdate;n.updateTimeScale(r.index,r.changes,r.marks,!0),r.seriesUpdates.forEach((function(t,i){i.setData(t.update)})),n.updateTimeScaleBaseIndex(0),this.me.delete(i),this.ge.delete(e)},t.prototype.applyNewData=function(t,i){var e=this.we.setSeriesData(t,i),s=this.er.model(),n=e.timeScaleUpdate;s.updateTimeScale(n.index,n.changes,n.marks,!0),n.seriesUpdates.forEach((function(t,i){i.setData(t.update)})),s.updateTimeScaleBaseIndex(0)},t.prototype.updateData=function(t,i){var e=this.we.updateSeriesData(t,i),s=this.er.model(),n=e.timeScaleUpdate;s.updateTimeScale(n.index,n.changes,n.marks,!1),n.seriesUpdates.forEach((function(t,i){i.updateData(t.update)})),s.updateTimeScaleBaseIndex(0)},t.prototype.subscribeClick=function(t){this.Me.subscribe(t)},t.prototype.unsubscribeClick=function(t){this.Me.unsubscribe(t)},t.prototype.subscribeCrosshairMove=function(t){this.pe.subscribe(t)},t.prototype.unsubscribeCrosshairMove=function(t){this.pe.unsubscribe(t)},t.prototype.subscribeVisibleTimeRangeChange=function(t){this.be.subscribe(t)},t.prototype.unsubscribeVisibleTimeRangeChange=function(t){this.be.unsubscribe(t)},t.prototype.priceScale=function(){return this.Ne},t.prototype.timeScale=function(){return this.Se},t.prototype.applyOptions=function(t){this.er.applyOptions(t)},t.prototype.options=function(){return this.er.options()},t.prototype.takeScreenshot=function(){return this.er.takeScreenshot()},t.prototype.ye=function(){this.be.hasListeners()&&this.be.fire(this.timeScale().getVisibleRange())},t.prototype.xe=function(t){return f(this.ge.get(t))},t.prototype.ke=function(t){var i=this,e=new Map;t.seriesPrices.forEach((function(t,s){e.set(i.xe(s),t)}));var s=void 0===t.hoveredSeries?void 0:this.xe(t.hoveredSeries);return{time:t.time&&(t.time.businessDay||t.time.timestamp),point:t.point,hoveredSeries:s,hoveredMarkerId:t.hoveredObject,seriesPrices:e}},t}(),vn={width:0,height:0,layout:{backgroundColor:"#FFFFFF",textColor:"#191919",fontSize:11,fontFamily:Pi},crosshair:{vertLine:{color:"#758696",width:1,style:2,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:2,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},priceScale:{autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,position:"right",borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,scaleMargins:{bottom:.1,top:.2}},timeScale:{rightOffset:0,barSpacing:6,fixLeftEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0},watermark:{color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,text:"",horzAlign:"center",vertAlign:"center"},localization:{locale:navigator.language,dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:!0,mouseWheel:!0,pinch:!0}};function yn(t,i){var e=d(w(t)?document.getElementById(t):t),s=void 0===i?b(vn):v(b(vn),i);return new dn(e,s)}}}]);